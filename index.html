<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="æ°´å¹¿å±±">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="æ°´å¹¿å±±">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Guangshan Shui">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>æ°´å¹¿å±±</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">æ°´å¹¿å±±</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/09/%E5%9F%BA%E4%BA%8Etensorflow%E7%9A%84%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA%E7%9A%84%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/%E5%9F%BA%E4%BA%8Etensorflow%E7%9A%84%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA%E7%9A%84%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">åŸºäºtensorflowçš„å¤šå±‚æ„ŸçŸ¥æœºçš„ä»£ç å®ç°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-04-09 21:23:09" itemprop="dateCreated datePublished" datetime="2021-04-09T21:23:09+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-04-10 09:15:30" itemprop="dateModified" datetime="2021-04-10T09:15:30+08:00">2021-04-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment"># author: Shuigs18</span></span><br><span class="line"><span class="comment"># date: 2021-04-07</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŸºäºtensorflowçš„å¤šå±‚æ„ŸçŸ¥æœºçš„å®ç°</span></span><br><span class="line"><span class="comment"># ä¸‰å±‚ï¼ˆè¾“å…¥ã€éšè—ã€è¾“å‡ºï¼‰MLP + K-fold + weight decay(L2æ­£åˆ™åŒ–) + dropout</span></span><br><span class="line"><span class="comment"># Relu(éšè—) + softmax(è¾“å‡º)</span></span><br><span class="line"><span class="comment"># æ•°æ®é›†ï¼šfashionâ€”mnist</span></span><br><span class="line"><span class="comment"># æ¢¯åº¦è®¡ç®—åˆ©ç”¨tensorflow</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> fashion_mnist</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¯»å–æ•°æ®å¹¶å¤„ç†ï¼ˆæµ‹è¯•é›†éªŒè¯é›†ï¼‰</span></span><br><span class="line"><span class="comment"># å®šä¹‰æ¨¡å‹å‚æ•°</span></span><br><span class="line"><span class="comment"># å®šä¹‰æ¿€æ´»å‡½æ•°Reluå’Œsoftmax</span></span><br><span class="line"><span class="comment"># å®šä¹‰ç½‘ç»œï¼ˆdropoutå®ç°ï¼‰</span></span><br><span class="line"><span class="comment"># å®šä¹‰æŸå¤±å‡½æ•°ï¼ˆåŠ L2æ­£åˆ™é¡¹ weight decayå®ç°ï¼‰</span></span><br><span class="line"><span class="comment"># K-fold å‡½æ•° </span></span><br><span class="line"><span class="comment"># å…ˆ k-fold ç¡®å®šè®­ç»ƒé›†å’ŒéªŒè¯é›†</span></span><br><span class="line"><span class="comment"># ç„¶ååœ¨å°†è®­ç»ƒé›†ç”ŸæˆSGDè®­ç»ƒçš„è¿­ä»£å™¨</span></span><br><span class="line"><span class="comment"># trainå‡½æ•° (è¾“å…¥åŒ…å«è®­ç»ƒé›†è¿­ä»£å™¨å’ŒéªŒè¯é›†)</span></span><br><span class="line"><span class="comment">#   å°æ‰¹é‡æ¢¯åº¦ä¸‹é™</span></span><br><span class="line"><span class="comment"># è¿”å› fold 0,1,2,3,4,5 è®­ç»ƒé›†éªŒè¯é›†çš„è¯¯å·®</span></span><br><span class="line"><span class="comment"># predictå‡½æ•° ç”Ÿæˆç»“æœ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®å¤„ç†</span></span><br><span class="line">(X_train, Y_train), (X_test, Y_test) = fashion_mnist.load_data()</span><br><span class="line">batch_size = <span class="number">256</span></span><br><span class="line">X_train = tf.cast(X_train, tf.float32)</span><br><span class="line">X_test = tf.cast(X_test, tf.float32)</span><br><span class="line">X_train = X_train / <span class="number">255.0</span>   <span class="comment"># é¢œè‰²çš„æ·±æµ…æ²¡æœ‰å…³ç³»</span></span><br><span class="line">X_test = X_test / <span class="number">255.0</span></span><br><span class="line"><span class="comment"># åˆ’åˆ†æ‰¹æ¬¡ </span></span><br><span class="line"><span class="comment"># train_iter = tf.data.Dataset.from_tensor_slices((x_train, y_train)).batch(batch_size)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰æ¨¡å‹å‚æ•°ï¼ˆä¸€å±‚éšè—å±‚ï¼‰</span></span><br><span class="line">dim_inputs, dim_hiddens, dim_outputs = <span class="number">784</span>, <span class="number">256</span>, <span class="number">10</span></span><br><span class="line">W1 = tf.Variable(tf.random.normal(shape=(dim_inputs, dim_hiddens), mean=<span class="number">0.0</span>, stddev=<span class="number">0.01</span>, dtype=tf.float32))</span><br><span class="line">b1 = tf.Variable(tf.zeros(dim_hiddens, dtype=tf.float32))</span><br><span class="line">W2 = tf.Variable(tf.random.normal(shape=(dim_hiddens, dim_outputs), mean=<span class="number">0.0</span>, stddev=<span class="number">0.01</span>, dtype=tf.float32))</span><br><span class="line">b2 = tf.Variable(tf.random.normal([dim_outputs], mean=<span class="number">0.0</span>, stddev=<span class="number">0.01</span>, dtype=tf.float32))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰æ¿€æ´»å‡½æ•° ReLu softmax</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ReLu</span>(<span class="params">X</span>):</span></span><br><span class="line">    <span class="keyword">return</span> tf.math.maximum(X, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">softmax</span>(<span class="params">X</span>):</span></span><br><span class="line">    <span class="keyword">return</span> tf.exp(X) / tf.reduce_sum(tf.math.exp(X), axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dropout(H, drop_prob)</span></span><br><span class="line"><span class="comment"># ç½‘ç»œnet()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dropout</span>(<span class="params">H, drop_prob</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt;= drop_prob &lt;= <span class="number">1</span> </span><br><span class="line">    keep_prob = <span class="number">1</span>- drop_prob</span><br><span class="line">    <span class="keyword">if</span> keep_prob == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> tf.zeros_like(H)</span><br><span class="line">    mask = tf.random.uniform(shape=H.shape, minval=<span class="number">0</span>, maxval=<span class="number">1</span>) &lt; keep_prob</span><br><span class="line">    <span class="keyword">return</span> tf.cast(mask, dtype=tf.float32) * tf.cast(H, dtype=tf.float32) / keep_prob</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ•´ä¸ªç½‘ç»œ</span></span><br><span class="line">drop_prob1 = <span class="number">0.2</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">net</span>(<span class="params">X, training=<span class="literal">False</span></span>):</span></span><br><span class="line">    X = tf.reshape(X, shape=(-<span class="number">1</span>, dim_inputs))</span><br><span class="line">    H1 = ReLu(tf.matmul(X, W1) + b1)</span><br><span class="line">    <span class="keyword">if</span> training:</span><br><span class="line">        H1 = drop_out(H, drop_prob1)</span><br><span class="line">    <span class="keyword">return</span> softmax(tf.matmul(H1, W2) + b2)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰æŸå¤±å‡½æ•° äº¤å‰ç†µ L2æ­£åˆ™é¡¹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loss_cross_entropy</span>(<span class="params">y_true, y_pred</span>):</span></span><br><span class="line">    <span class="keyword">return</span> tf.losses.sparse_categorical_crossentropy(y_true, y_pred)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L2_penalty</span>(<span class="params">W</span>):</span></span><br><span class="line">    <span class="keyword">return</span> tf.reduce_sum(W ** <span class="number">2</span>) / <span class="number">2.0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰get_K_fold_dataå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_K_fold_data</span>(<span class="params">k, i, X, Y</span>):</span></span><br><span class="line">    fold_size = X.shape[<span class="number">0</span>] // k</span><br><span class="line">    X_train, Y_train = <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        idx = <span class="built_in">slice</span>(j * fold_size, (j + <span class="number">1</span>) * fold_size)</span><br><span class="line">        X_part, Y_part = X[idx, :], Y[idx]</span><br><span class="line">        <span class="keyword">if</span> j == i:</span><br><span class="line">            X_valid, Y_valid = X_part, Y_part</span><br><span class="line">        <span class="keyword">elif</span> X_train <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            X_train, Y_train = X_part, Y_part</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            X_train = tf.concat([X_train, X_part], axis=<span class="number">0</span>)</span><br><span class="line">            Y_train = tf.concat([Y_train, Y_part], axis=<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> X_train, Y_train, X_valid, Y_valid</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰è®­ç»ƒå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">train</span>(<span class="params">net, train_iter, X_valid, Y_valid, loss, num_epochs, batch_size, params=<span class="literal">None</span>, learning_rate=<span class="literal">None</span></span>):</span> </span><br><span class="line">    train_loss_sum, valid_loss_sum = <span class="number">0.0</span>, <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">        train_loss, valid_loss, n = <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> X_train, Y_train <span class="keyword">in</span> train_iter:</span><br><span class="line">            <span class="keyword">with</span> tf.GradientTape() <span class="keyword">as</span> tape:  </span><br><span class="line">                Y_pred = net(X_train)</span><br><span class="line">                l = loss(Y_train, Y_pred)</span><br><span class="line">            <span class="comment"># è®¡ç®—æ¢¯åº¦</span></span><br><span class="line">            grads = tape.gradient(l, params)</span><br><span class="line">            <span class="comment"># åˆ›å»ºä¸€ä¸ªä¼˜åŒ–å™¨</span></span><br><span class="line">            opt = tf.keras.optimizers.SGD(learning_rate = learning_rate)</span><br><span class="line">            <span class="comment"># æ¢¯åº¦ä¸‹é™æ›´æ–°å‚æ•°ï¼ˆæ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼‰</span></span><br><span class="line">            opt.apply_gradients(<span class="built_in">zip</span>([grad / batch_size <span class="keyword">for</span> grad <span class="keyword">in</span> grads], params))</span><br><span class="line">            <span class="comment"># æ›´æ–°è®­ç»ƒé›†æŸå¤±å€¼</span></span><br><span class="line">            train_loss += l.numpy().<span class="built_in">sum</span>()</span><br><span class="line">            n += Y_train.shape[<span class="number">0</span>]</span><br><span class="line">        valid_loss += (loss(Y_valid, net(X_valid)).numpy().<span class="built_in">sum</span>() / Y_valid.shape[<span class="number">0</span>])</span><br><span class="line">        train_loss /= n</span><br><span class="line">        train_loss_sum += train_loss</span><br><span class="line">        valid_loss_sum += valid_loss</span><br><span class="line">    train_loss_sum /= num_epochs</span><br><span class="line">    valid_loss_sum /= num_epochs</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> params, train_loss_sum, valid_loss_sum</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">k_fold</span>(<span class="params">k, net, X_train, Y_train, num_epochs, </span></span></span><br><span class="line"><span class="function"><span class="params">           batch_size, loss_cross_entropy, params=<span class="literal">None</span>, learning_rate=<span class="literal">None</span></span>):</span></span><br><span class="line">    start_time = time.time() </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        data = get_K_fold_data(k, i, X_train, Y_train)</span><br><span class="line">        train_iter = tf.data.Dataset.from_tensor_slices((data[<span class="number">0</span>], data[<span class="number">1</span>])).batch(batch_size)</span><br><span class="line">        X_valid = data[<span class="number">2</span>]</span><br><span class="line">        Y_valid = data[<span class="number">3</span>]</span><br><span class="line">        params, train_loss, valid_loss =  train(net, train_iter, X_valid, Y_valid, loss_cross_entropy, num_epochs, batch_size, params, learning_rate)</span><br><span class="line">        print(<span class="string">&quot;fold %d: train loss %f, valid loss %f&quot;</span> % (i, train_loss, valid_loss))</span><br><span class="line">    end_time = time.time()</span><br><span class="line">    print(<span class="string">&#x27;æ€»ç”¨æ—¶ï¼š%f&#x27;</span> % (start_time - end_time))</span><br><span class="line">    <span class="keyword">return</span> params</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¢„æµ‹å‡½æ•° predict()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">net, params, X_test</span>):</span></span><br><span class="line">    Y_pred = net(X_test)</span><br><span class="line">    result = tf.argmax(Y_pred, axis=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">params = [W1, b1, W2, b2]</span><br><span class="line">num_epochs = <span class="number">10</span></span><br><span class="line">params = k_fold(<span class="number">5</span>, net, X_train, Y_train, num_epochs, batch_size, loss_cross_entropy, params, learning_rate=<span class="number">0.1</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">fold 0: train loss 0.169400, valid loss 0.169741</span></span><br><span class="line"><span class="string">fold 1: train loss 0.156253, valid loss 0.167162</span></span><br><span class="line"><span class="string">fold 2: train loss 0.147749, valid loss 0.159257</span></span><br><span class="line"><span class="string">fold 3: train loss 0.139382, valid loss 0.157192</span></span><br><span class="line"><span class="string">fold 4: train loss 0.130207, valid loss 0.149647</span></span><br><span class="line"><span class="string">æ€»ç”¨æ—¶ï¼š-114.377255</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">result = predict(net, params, X_test)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;tf.Tensor: shape=(100,), dtype=int64, numpy=</span></span><br><span class="line"><span class="string">array([9, 2, 1, 1, 6, 1, 4, 6, 5, 7, 4, 5, 5, 3, 4, 1, 2, 2, 8, 0, 2, 5,</span></span><br><span class="line"><span class="string">       7, 5, 1, 4, 6, 0, 9, 6, 8, 8, 3, 3, 8, 0, 7, 5, 7, 9, 0, 1, 6, 7,</span></span><br><span class="line"><span class="string">       6, 7, 2, 1, 2, 6, 4, 2, 5, 8, 2, 2, 8, 4, 8, 0, 7, 7, 8, 5, 1, 1,</span></span><br><span class="line"><span class="string">       3, 3, 7, 8, 7, 0, 2, 6, 2, 3, 1, 2, 8, 4, 1, 8, 5, 9, 5, 0, 3, 2,</span></span><br><span class="line"><span class="string">       0, 2, 5, 3, 6, 7, 1, 8, 0, 1, 2, 2])&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/21/Ensemble/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/21/Ensemble/" class="post-title-link" itemprop="url">Ensemble</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-03-21 14:53:52 / ä¿®æ”¹æ—¶é—´ï¼š15:05:09" itemprop="dateCreated datePublished" datetime="2021-03-21T14:53:52+08:00">2021-03-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li><p>boosting</p>
</li>
<li><p>bagging</p>
</li>
<li><p>stacking</p>
</li>
</ul>
<h1 id="1-boosting"><a href="#1-boosting" class="headerlink" title="1. boosting"></a>1. boosting</h1><ul>
<li><strong>ä»£è¡¨ç®—æ³•ï¼šAdaBoost</strong></li>
</ul>
<p><strong>åªèƒ½åˆ†ç±»ï¼Ÿ</strong></p>
<p>å¼±åˆ†ç±»å™¨ï¼šæ¯”è¾ƒç²—ç³™çš„åˆ†ç±»è§„åˆ™</p>
<p>å¼ºåˆ†ç±»å™¨ï¼šç²¾ç¡®çš„åˆ†ç±»è§„åˆ™</p>
<p>æå‡æ–¹æ³•å°±æ˜¯ç»„åˆå¼±åˆ†ç±»å™¨ï¼Œæ„æˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨</p>
<p>å¤§å¤šæ•°çš„æå‡æ–¹æ³•éƒ½æ˜¯æ”¹å˜è®­ç»ƒæ•°æ®çš„æ¦‚ç‡åˆ†å¸ƒï¼ˆè®­ç»ƒæ•°æ®çš„æƒå€¼åˆ†å¸ƒï¼‰ï¼Œé’ˆå¯¹<strong>ä¸åŒçš„è®­ç»ƒæ•°æ®åˆ†å¸ƒ</strong>è°ƒç”¨å¼±å­¦ä¹ ç®—æ³•å­¦ä¹ </p>
<p>å¯¹äºæå‡æ–¹æ³•æ¥è¯´æœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦å›ç­”ï¼š</p>
<ol>
<li><p>æ¯ä¸€è½®å¦‚ä½•æ”¹å˜è®­ç»ƒæ•°æ®çš„æƒå€¼æˆ–æ¦‚ç‡åˆ†å¸ƒ </p>
</li>
<li><p>å¦‚ä½•å°†å¼±åˆ†ç±»å™¨ç»„åˆæˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨</p>
</li>
</ol>
<h2 id="1-1-AdaBoost"><a href="#1-1-AdaBoost" class="headerlink" title="1.1 AdaBoost"></a>1.1 AdaBoost</h2><p><strong>AdaBoostçš„åšæ³•ï¼š</strong></p>
<p>é’ˆå¯¹é—®é¢˜1ï¼Œæé«˜è¢«å‰ä¸€è½®å¼±åˆ†ç±»å™¨é”™è¯¯åˆ†ç±»çš„æ ·æœ¬çš„æƒå€¼ï¼Œé™ä½åˆ†ç±»æ­£ç¡®çš„æ ·æœ¬çš„æƒå€¼</p>
<p>é’ˆå¯¹é—®é¢˜2ï¼Œç»„åˆé‡‡ç”¨<strong>åŠ æƒå¤šæ•°è¡¨å†³</strong>çš„æ–¹æ³•</p>
<p><strong>ç®—æ³•8.1 (AdaBoost)</strong></p>
<p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† $T$ ï¼›å¼±å­¦ä¹ ç®—æ³•</p>
<p>è¾“å‡ºï¼šæœ€ç»ˆçš„åˆ†ç±»å™¨ $G(x)$</p>
<ol>
<li><p>åˆå§‹åŒ–è®­ç»ƒæ•°æ®æƒå€¼åˆ†å¸ƒ<br>$$<br>D_1 = (w_{11}, \cdots, w_{1i}, \cdots, w_{1N}),\quad w_{1i} = \frac{1}{N}, \quad i = 1,2,â€¦,N<br>$$</p>
</li>
<li><p>å¯¹ $m = 1,2,â€¦, M$</p>
<p>a. ä½¿ç”¨å…·æœ‰æƒå€¼åˆ†å¸ƒçš„ $D_m$ çš„è®­ç»ƒæ•°æ®é›†å­¦ä¹ å¾—åˆ°åŸºæœ¬åˆ†ç±»å™¨(å­¦ä¹ çš„ä¾æ®å°±æ˜¯åˆ†ç±»è¯¯å·®ç‡æœ€å°ï¼Œåˆ†ç±»é”™è¯¯çš„æƒé‡å’Œ)<br>$$<br>G_m(x) : \mathcal{X} \rightarrow \lbrace c_1,c_2,\cdots, c_k \rbrace<br>$$<br>b.è®¡ç®— $G_m(x)$ åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šçš„åˆ†ç±»è¯¯å·®ç‡<br>$$<br>e_{m}=\sum_{i=1}^{N} P\left(G_{m}\left(x_{i}\right) \neq y_{i}\right)=\sum_{i=1}^{N} w_{mi} I\left(G_{m}\left(x_{i}\right) \neq y_{i}\right)<br>$$<br>c. è®¡ç®— $G_m(x)$ çš„ç³»æ•°<br>$$<br>\alpha_m = \frac{1}{2} \log(\frac{1-e_m}{e_m})<br>$$<br>è¿™é‡Œçš„å¯¹æ•°æ˜¯è‡ªç„¶å¯¹æ•°</p>
<p>d. æ›´æ–°è®­ç»ƒæ•°æ®é›†çš„æƒå€¼åˆ†å¸ƒ<br>$$<br>D_{m+1} = (w_{m+1,1}, â€¦, w_{m+1, i}, â€¦, w_{m+1, N}) \\<br>w_{m+1, i} = \frac{w_{mi}}{Z_m} \exp(-\alpha_m I\left(G_{m}\left(x_{i}\right) = y_{i}\right)), \quad i =1,2,â€¦,N<br>$$<br>è¿™é‡Œï¼Œ $Z_m$è§„èŒƒå› å­<br>$$<br>Z_m = \sum_{i = 1}^{N}w_{mi}\exp(-\alpha_m I\left(G_{m}\left(x_{i}\right) = y_{i}\right))<br>$$<br>$I\left(G_{m}\left(x_{i}\right) = y_{i}\right)$ï¼Œå½“åˆ†ç±»æ­£ç¡®çš„æ—¶å€™å–1ï¼Œåˆ†ç±»é”™è¯¯å–0ã€‚äºŒåˆ†ç±»æ—¶å¯ä»¥ $y_iG_m(x_i)$ ä»£æ›¿</p>
<p><strong>å®ƒä½¿ $D_{m+1}$ ç§°ä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒ</strong></p>
</li>
<li><p>æ„å»ºåŸºæœ¬åˆ†ç±»å™¨çš„çº¿æ€§ç»„åˆ<br>$$<br>f(x) = \sum_{m=1}^{M}\alpha_mG_m(x)<br>$$<br>æœ€ç»ˆå¾—åˆ°åˆ†ç±»å™¨<br>$$<br>G(x) = \text{sign}(f(x))<br>$$</p>
</li>
</ol>
<blockquote>
<p>æ³¨ï¼š $e_m$ å¤§çš„ï¼Œ$\alpha_m$ å°ï¼Œè¿™ä¸ªæ—¶å€™è§‚å¯Ÿæƒå€¼çš„æ›´æ–°å…¬å¼ï¼Œå¯¹äºåˆ†å­æ¥è¯´ï¼Œæ­£ç¡®ç‡é«˜çš„ï¼Œåˆ†å­å°ï¼Œæ­£ç¡®ç‡ä½çš„ï¼Œåˆ†å­å¤§ï¼Œ è¿™æ ·å°±è¾¾åˆ°äº†æé«˜è¢«å‰ä¸€è½®å¼±åˆ†ç±»å™¨é”™è¯¯åˆ†ç±»çš„æ ·æœ¬çš„æƒå€¼ï¼Œé™ä½åˆ†ç±»æ­£ç¡®çš„æ ·æœ¬çš„æƒå€¼çš„ç›®çš„</p>
</blockquote>
<h3 id="Qï¼šAdaboostç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ"><a href="#Qï¼šAdaboostç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ" class="headerlink" title="Qï¼šAdaboostç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ"></a>Qï¼šAdaboostç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ</h3><p>æœ‰äº›ä»£ç å°†ç»ˆæ­¢æ¡ä»¶è®¾ç½®ä¸ºä¸€ä¸ªè¶…å‚æ•°ï¼Œå³å¼±åˆ†ç±»å™¨çš„ä¸ªæ•°ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/41047671/answer/127832345">çŸ¥ä¹: ä¿æ‰¬çš„å›ç­”</a></p>
<p>Adabooståœ¨å®éªŒä¸­è¡¨ç°å‡ºæ›´åŠ ä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼ˆç›¸å¯¹äºåˆ«çš„boostingæ–¹æ³•ï¼‰çš„ç°è±¡ï¼Œå°¤å…¶æ˜¯åœ¨å®éªŒä¸­å‘ç°ï¼Œè¿­ä»£ä¸­ç»éªŒè¯¯å·®éƒ½å·²ç»ä¸å˜åŒ–äº†çš„æƒ…å†µä¸‹ï¼Œæµ‹è¯•è¯¯å·®å±…ç„¶è¿˜èƒ½ä¸‹é™ä¸€æ®µæ—¶é—´ã€‚</p>
<p>å¯¹äºäºŒåˆ†ç±»é—®é¢˜ï¼ŒAdaBoostçš„è®­ç»ƒè¯¯å·®ä»¥æŒ‡æ•°é€Ÿç‡ä¸‹é™å°±å¾ˆå…·æœ‰å¸å¼•åŠ›</p>
<h2 id="1-2-AdaBoostç®—æ³•è§£é‡Š"><a href="#1-2-AdaBoostç®—æ³•è§£é‡Š" class="headerlink" title="1.2 AdaBoostç®—æ³•è§£é‡Š"></a>1.2 AdaBoostç®—æ³•è§£é‡Š</h2><p><strong>AdaBoost = åŠ æ³•æ¨¡å‹ + æŸå¤±å‡½æ•°(æŒ‡æ•°å‡½æ•°) + å­¦ä¹ ç®—æ³•(å‰å‘åˆ†æ­¥ç®—æ³•)</strong></p>
<ul>
<li>åŠ æ³•æ¨¡å‹</li>
</ul>
<p>$$<br>f(x) = \sum_{m=1}^{M} \beta_m b(x;\gamma_m)<br>$$</p>
<ul>
<li>æŸå¤±å‡½æ•°</li>
</ul>
<p><br>$$<br>L(y,f(x)) = \exp(-yf(x))\\<br>(\alpha_m, G_m(x)) = \arg \min_{\alpha,G}\sum_{i = 1}^{N}\exp[-y_i(f_{m-1}(x_i) +\alpha G(x_i))]<br>$$</p>
<h2 id="1-3-Adaboostä»£ç å®ç°"><a href="#1-3-Adaboostä»£ç å®ç°" class="headerlink" title="1.3 Adaboostä»£ç å®ç°"></a>1.3 Adaboostä»£ç å®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å†³çš„é—®é¢˜ï¼šäºŒåˆ†ç±»ï¼ŒY_label = &#123;-1, 1&#125; è¿™é‡Œç®€åŒ–ç‰¹å¾X Xi = &#123;0,1&#125; (äºŒå€¼åŒ–å¤„ç†)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç®—æ³•å®ç°æ€è·¯</span></span><br><span class="line"><span class="comment">## è®¡ç®—åˆ†ç±»é”™è¯¯ç‡ï¼Œè¾“å…¥åº”è¯¥æ˜¯ï¼šæ•°æ®é›†å’Œè®­ç»ƒå¥½çš„æ¨¡å¼±åˆ†ç±»å™¨å‚æ•°ï¼Œè¿”å›é¢„æµ‹ç»“æœå’Œåˆ†ç±»è¯¯å·®ç‡</span></span><br><span class="line"><span class="comment">## å•å±‚æå‡æ ‘ï¼š è¾“å…¥ï¼šæ•°æ®ï¼Œæƒå€¼åˆ†å¸ƒ è¾“å‡ºï¼šåˆ›å»ºçš„å•å±‚æå‡æ ‘</span></span><br><span class="line"><span class="comment">## ç”Ÿæˆæå‡æ ‘ï¼šè¾“å…¥ï¼šæ•°æ®ï¼Œ è¾“å‡ºï¼šæå‡æ ‘</span></span><br><span class="line"><span class="comment">## é¢„æµ‹ç»“æœ</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_e_Gx</span>(<span class="params">X_trainArr, Y_trainArr, n, div, D</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    è®¡ç®—åˆ†ç±»è¯¯å·®ç‡</span></span><br><span class="line"><span class="string">    nï¼Œè¦æ“ä½œçš„ç‰¹å¾</span></span><br><span class="line"><span class="string">    divï¼Œåˆ’åˆ†çš„ç‚¹</span></span><br><span class="line"><span class="string">    D, æƒå€¼åˆ†å¸ƒ</span></span><br><span class="line"><span class="string">    return é¢„æµ‹ç»“æœ, åˆ†ç±»è¯¯å·®ç‡</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–è¯¯å·®ç‡</span></span><br><span class="line">    e = <span class="number">0</span> </span><br><span class="line">    <span class="comment"># å•ç‹¬æå–X, Y</span></span><br><span class="line">    X_n = X_trainArr[:, n]</span><br><span class="line">    Y_n = Y_trainArr</span><br><span class="line">    predict = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X_n)):</span><br><span class="line">        <span class="keyword">if</span> X_n[i] &lt; div:</span><br><span class="line">            predict[i] = -<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> predict[i] != Y_train[i]: e += D[i]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            predict[i] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> predict[i] != Y_train[i]: e += D[i]</span><br><span class="line">                </span><br><span class="line">    <span class="keyword">return</span> np.array(predict), e</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creatSingleTree</span>(<span class="params">X_trainArr, Y_trainArr, D</span>):</span></span><br><span class="line">    <span class="comment"># è¯¥å‡½æ•°å¯ä»¥ç”¨å…¶ä»–å¼±åˆ†ç±»å™¨ä»£æ›¿</span></span><br><span class="line">    <span class="comment"># è·å¾—æ ·æœ¬æ•°ç›®åŠç‰¹å¾æ•°é‡</span></span><br><span class="line">    m, n = np.shape(X_trainArr)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å•å±‚æ ‘å­—å…¸ï¼Œç”¨äºå­˜æ”¾å½“å‰æå‡æ ‘çš„å‚æ•°ï¼ŒåŒ…æ‹¬ï¼šåˆ†å‰²ç‚¹ï¼Œé¢„æµ‹ç»“æœï¼Œè¯¯å·®ç‡(ç”±é¢„æµ‹ç»“æœè®¡ç®—)ï¼Œ</span></span><br><span class="line">    <span class="comment"># è¯¥å•å±‚æ ‘æ‰€å¤„ç†çš„ç‰¹å¾ </span></span><br><span class="line">    singleBoostTree = &#123;&#125; </span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–è¯¯å·®ç‡ï¼Œæœ€å¤§ä¸º100%</span></span><br><span class="line">    singleBoostTree[<span class="string">&#x27;e&#x27;</span>] = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># éå†æ¯ä¸€ä¸ªç‰¹å¾ï¼Œå¯»æ‰¾ç”¨äºåˆ’åˆ†çš„æœ€åˆé€‚çš„ç‰¹å¾</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="comment"># ç”±äºç‰¹å¾è¿›è¡Œäº†äºŒå€¼åŒ–å¤„ç†ï¼Œåªèƒ½ä¸º0ã€1ï¼Œå› æ­¤åˆ‡åˆ†ç‚¹ä¸º -0.5ï¼Œ 0.5ï¼Œ1.5</span></span><br><span class="line">        <span class="keyword">for</span> div <span class="keyword">in</span> [-<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">1.5</span>]:</span><br><span class="line">            Gx, e = calc_e_Gx(X_trainArr, Y_trainArr, i, div, D)</span><br><span class="line">            <span class="keyword">if</span> e &lt; singleBoostTree[<span class="string">&#x27;e&#x27;</span>]:</span><br><span class="line">                singleBoostTree[<span class="string">&#x27;e&#x27;</span>] = e</span><br><span class="line">                singleBoostTree[<span class="string">&#x27;div&#x27;</span>] = div</span><br><span class="line">                singleBoostTree[<span class="string">&#x27;Gx&#x27;</span>] = Gx</span><br><span class="line">                singleBoostTree[<span class="string">&#x27;feature&#x27;</span>] = i</span><br><span class="line">    <span class="keyword">return</span> singleBoostTree</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creatBoostingTree</span>(<span class="params">X_trainArr, Y_trainArr, treeNum = <span class="number">50</span></span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    treeNum: å¼±åˆ†ç±»å™¨çš„æ•°ç›®ä½œä¸ºä¸€ä¸ªè¶…å‚æ•°ï¼Œå¯ä»¥é€šè¿‡äº¤å‰éªŒè¯æŒ‘é€‰ä¸€ä¸ªæœ€å¥½çš„</span></span><br><span class="line"><span class="string">    return: æå‡æ ‘</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    m, n = np.shape(X_trainArr)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–æƒå€¼åˆ†å¸ƒ</span></span><br><span class="line">    D = np.array([<span class="number">1</span> / m] * m)</span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–æ ‘åˆ—è¡¨</span></span><br><span class="line">    iterationNum = <span class="number">0</span></span><br><span class="line">    tree = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(treeNum):</span><br><span class="line">        <span class="comment"># åˆ›å»ºå½“å±‚çš„æå‡æ ‘</span></span><br><span class="line">        iterationNum += <span class="number">1</span></span><br><span class="line">        curTree = singleBoostTree(X_trainArr, Y_trainArr, D)</span><br><span class="line">        <span class="comment"># è®¡ç®—alpha</span></span><br><span class="line">        alpha = <span class="number">1</span> / <span class="number">2</span> * np.log((<span class="number">1</span> - curTree[<span class="string">&#x27;e&#x27;</span>]) / curTree[<span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">        Gx = curTree[<span class="string">&#x27;Gx&#x27;</span>]</span><br><span class="line">        D = np.multiply(D, np.exp( -alpha * np.multiply(Y_trainArr, Gx))) / \</span><br><span class="line">            <span class="built_in">sum</span>(np.multiply(D, np.exp( -alpha * np.multiply(Y_trainArr, Gx))))</span><br><span class="line">        curTree[<span class="string">&#x27;alpha&#x27;</span>] = alpha</span><br><span class="line">        tree.append(curTree)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å½“å‰è®­ç»ƒé›†é¢„æµ‹ç»“æœ</span></span><br><span class="line">        finalpredict += alpha * Gx</span><br><span class="line">        <span class="comment"># å½“å‰é¢„æµ‹è¯¯å·®æ•°ç›®</span></span><br><span class="line">        error_count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Y_trainArr)):</span><br><span class="line">            <span class="keyword">if</span> np.sign(finalpredict)[i] != Y_trainArr[i]:</span><br><span class="line">                error_count +=  <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        error_rate = error_count / <span class="built_in">len</span>(Y_trainArr)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¦‚æœè¯¯å·®å·²ç»ä¸º0äº†ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœæ­¢äº†ä¸ç”¨å†è®¡ç®—äº†</span></span><br><span class="line">        <span class="keyword">if</span> error_rate == <span class="number">0</span>: <span class="keyword">return</span> tree</span><br><span class="line">    print(<span class="string">&#x27;Numbers of iteration: &#123;&#125;, \n error rate: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(iterationNum, error_rate))</span><br><span class="line">    <span class="keyword">return</span> tree</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Gx_predict</span>(<span class="params">x, div, feature</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x[feature] &lt; div:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model_predict</span>(<span class="params">X_testArr, tree</span>):</span></span><br><span class="line">    prediction = []</span><br><span class="line">    <span class="comment"># æ¯ä¸€å±‚çš„tree æœ‰divï¼Œalphaï¼Œfeature</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X_testArr)):</span><br><span class="line">        result = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> curTree <span class="keyword">in</span> tree:</span><br><span class="line">            div = curTree[<span class="string">&#x27;div&#x27;</span>]</span><br><span class="line">            alpha = curTree[<span class="string">&#x27;alpha&#x27;</span>]</span><br><span class="line">            feature = curTree[<span class="string">&#x27;feature&#x27;</span>]</span><br><span class="line">            result += alpha * Gx_predict(X_testArr[i], div, feature)</span><br><span class="line">        prediction.append(result)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> prediction</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model_score</span>(<span class="params">X_testArr, Y_testArr, tree</span>):</span></span><br><span class="line">    prediction = model_predict(X_testArr, tree)</span><br><span class="line">    error_count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Y_testArr)):</span><br><span class="line">        <span class="keyword">if</span> prediction[i] != Y_testArr[i]:</span><br><span class="line">            error_count += <span class="number">1</span></span><br><span class="line">    score = <span class="number">1</span> - (error_count / <span class="built_in">len</span>(Y_testArr))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> score</span><br></pre></td></tr></table></figure>
<h2 id="1-3-boosting-tree"><a href="#1-3-boosting-tree" class="headerlink" title="1.3 boosting tree"></a>1.3 boosting tree</h2><p>ä»¥<strong>å†³ç­–æ ‘</strong>ä¸ºåŸºå‡½æ•°çš„æå‡æ–¹æ³•ç§°ä¸º<strong>æå‡æ ‘</strong>ã€‚å¯ä»¥æ˜¯äºŒå‰åˆ†ç±»æ ‘ï¼Œæˆ–äºŒå‰å›å½’æ ‘ã€‚</p>
<ul>
<li><strong>æ¨¡å‹</strong></li>
</ul>
<p>$$<br>f_M(x) = \sum_{m = 1}^M T(x;\Theta_m)<br>$$</p>
<p>å…¶ä¸­ï¼Œ $T(x;\Theta_m)$ è¡¨ç¤ºå†³ç­–æ ‘ï¼Œ $\Theta_m$ ä¸ºå†³ç­–æ ‘çš„å‚æ•°ï¼Œ $M$ ä¸ºæ ‘çš„ä¸ªæ•°</p>
<ul>
<li><strong>å‚æ•°ç¡®å®š</strong>(ç»éªŒé£é™©æå°åŒ–)</li>
</ul>
<p>$$<br>\hat{\Theta_m}=\arg \min_{\Theta_m} \sum_{i=1}^{N} L\left(y_{i}, f_{m-1}\left(x_{i}\right)+T\left(x_{i}; \Theta_{m}\right)\right)<br>$$</p>
<ul>
<li><strong>æŸå¤±å‡½æ•°</strong><ul>
<li>å¹³æ–¹è¯¯å·®æŸå¤±å‡½æ•°çš„å›å½’é—®é¢˜</li>
<li>æŒ‡æ•°æŸå¤±å‡½æ•°çš„åˆ†ç±»é—®é¢˜</li>
<li>ä¸€èˆ¬æŸå¤±å‡½æ•°çš„å†³ç­–é—®é¢˜</li>
</ul>
</li>
</ul>
<p>å½“åˆ†ç±»é—®é¢˜æ˜¯äºŒåˆ†ç±»ï¼ŒAdaBoostç®—æ³•çš„å¼±åˆ†ç±»å™¨é™åˆ¶ä¸ºäºŒåˆ†ç±»å³å¯ï¼Œå°±æ˜¯boosting tree</p>
<ul>
<li><p>å›å½’é—®é¢˜çš„æå‡æ ‘<br>$$<br>T(x;\Theta)=\sum_{j=1}^{J}c_j I(x \in R_j)<br>$$<br>å…¶ä¸­ï¼Œå‚æ•° $\Theta = \lbrace (R_1, c_1), (R_2, c_2),â€¦,(R_J, c_J) \rbrace$ è¡¨ç¤ºæ ‘çš„åŒºåŸŸåˆ’åˆ†å’Œå„åŒºåŸŸä¸Šçš„å¸¸æ•°ï¼Œ $J$ æ˜¯å›å½’æ ‘çš„å¤æ‚åº¦å³å¶ç»“ç‚¹çš„ä¸ªæ•°ã€‚</p>
<ul>
<li>é‡‡ç”¨<strong>å¹³æ–¹è¯¯å·®æŸå¤±å‡½æ•°</strong><br>$$<br>\begin{align*}<br>L(y,f_{m-1}(x) + T(x; \Theta_m)) &amp;= [y - f_{m-1}(x) - T(x;\Theta_m)]^2\\<br>&amp;=[r-T(x;\Theta_m)]^2<br>\end{align*}<br>$$<br>æ‰€ä»¥ä»æŸå¤±å‡½æ•°å¯ä»¥çœ‹å‡ºï¼Œå½“å‰å±‚æ ‘çš„ç¡®å®šï¼Œæ˜¯é€šè¿‡æ‹Ÿåˆä¸Šä¸€å±‚æ¨¡å‹çš„æ®‹å·®ã€‚æ‰€ä»¥ç®—æ³•å¯ä»¥é€šè¿‡å°†è¯¥å±‚çš„è®­ç»ƒæ•°æ®ç»™æ”¹ä¸ºæ®‹å·®å³å¯é€’å½’å¾—åˆ°æ¯ä¸€å±‚çš„tree</li>
</ul>
</li>
<li><p><strong>å‚æ•°æ›´æ–°(æ¢¯åº¦ä¸‹é™)</strong></p>
</li>
</ul>
<p>$$<br>-[\frac{\partial L(y, f(x_i))}{\partial f(x_i)}]<em>{f(x)=f</em>{m-1}(x)}<br>$$</p>
<h1 id="2-Bagging-Beriman-1996a"><a href="#2-Bagging-Beriman-1996a" class="headerlink" title="2. Bagging[Beriman, 1996a]"></a>2. Bagging[Beriman, 1996a]</h1><p>é‡‡ç”¨è‡ªä¸»æŠ½æ ·æ³•(<strong>bootstrap sampling</strong>)</p>
<ul>
<li>ç¡®å®šæ ·æœ¬é›†ä¸ªæ•° $m$ </li>
<li>åˆæ”¾å›çš„æŠ½å– $m$ ä¸ªæ ·æœ¬</li>
<li>é‡‡æ ·å‡º $T$ ä¸ªå« $m$ æ ·æœ¬çš„é‡‡æ ·é›†</li>
<li>ç„¶ååŸºäºæ¯ä¸ªæ ·æœ¬é›†è®­ç»ƒä¸€ä¸ªåŸºå­¦ä¹ å™¨</li>
<li>é¢„æµ‹å¯ä»¥ä½¿ç”¨ç®€å•æŠ•ç¥¨æ³•</li>
</ul>
<p>å¯ä»¥è®°å½•ä¸€ä¸‹ä½¿ç”¨çš„æ•°æ®ï¼Œæœªè¢«ä½¿ç”¨çš„æ•°æ®å¯ä»¥ç”¨æ¥å¯¹æ³›åŒ–æ€§èƒ½è¿›è¡Œâ€œåŒ…å¤–ä¼°è®¡â€</p>
<p>ä»£ç éš¾åº¦ä¸å¤§</p>
<p>ä½¿ç”¨random.sample()æˆ–è€…np.random.choice()å°±å¯ä»¥å®ç°é‡æŠ½æ ·</p>
<p>random.sample()é»˜è®¤ä¸é‡å¤æŠ½æ ·ï¼Œå¯ä»¥æŠ½å–å¤šç»´æ•°æ®</p>
<p>np.random.choice() é»˜è®¤é‡å¤æŠ½æ · replace=True, ä¸å¯ä»¥æŠ½å–å¤šç»´æ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°äº§ç”Ÿä¸‹æ ‡ã€‚</p>
<h1 id="3-Random-Forest-RF"><a href="#3-Random-Forest-RF" class="headerlink" title="3. Random Forest(RF)"></a>3. Random Forest(RF)</h1><p>Bagging çš„å˜ä½“ï¼ŒRFåœ¨åŸºå­¦ä¹ å™¨æ„å»ºBaggingé›†æˆçš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥åœ¨å†³ç­–æ ‘çš„è®­ç»ƒè¿‡ç¨‹ä¸­å¼•å…¥äº†éšæœºå±æ€§é€‰æ‹©ã€‚å…·ä½“æ¥è¯´ï¼Œ ä¼ ç»Ÿå†³ç­–æ ‘åœ¨é€‰æ‹©åˆ’åˆ†å±æ€§æ—¶æ˜¯åœ¨å½“å‰ç»“ç‚¹çš„å±æ€§é›†åˆ(å‡å®šæœ‰dä¸ªå±æ€§)ä¸­é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜å±æ€§ï¼› è€Œåœ¨RFä¸­ï¼Œ å¯¹åŸºå†³ç­–æ ‘çš„æ¯ä¸ªç»“ç‚¹ï¼Œ å…ˆä»è¯¥ç»“ç‚¹çš„å±æ€§é›†åˆä¸­éšæœºé€‰æ‹©ä¸€ä¸ªåŒ…å«kä¸ªå±æ€§çš„å­é›†ï¼Œ ç„¶åå†ä»è¿™ä¸ªå­é›†ä¸­é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜å±æ€§ç”¨äºåˆ’åˆ†ã€‚è‹¥ä»¤$k=d$,åˆ™åŸºå†³ç­–æ ‘çš„æ„å»ºä¸ä¼ ç»Ÿå†³ç­–æ ‘ç›¸åŒï¼›è‹¥ä»¤$k = 1$,åˆ™æ˜¯éšæœºé€‰æ‹©ä¸€ä¸ªå±æ€§ç”¨äºåˆ’åˆ†ï¼› ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ æ¨èå€¼$k = log_2d$</p>
<p><strong>ç®—æ³•ï¼š</strong></p>
<p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ® $T$ ï¼ŒåŸºå†³ç­–æ ‘(CART)ï¼Œé‡æŠ½æ ·å‚æ•° $m$ï¼Œå±æ€§é›†åˆå‚æ•° $k$</p>
<p>è¾“å‡ºï¼šæœ€ç»ˆåˆ†ç±»å™¨</p>
<p>for 1,2,â€¦T</p>
<p>â€‹        é‡æŠ½æ ·æ•°æ®(mä¸ª)ï¼Œè®°å½•æœªè¢«æŠ½å–çš„æ•°æ®</p>
<p>â€‹        éšæœºæŠ½å–kä¸ªå±æ€§</p>
<p>â€‹        æ ¹æ®é‡æŠ½æ ·çš„æ•°æ®å’Œç¡®å®šçš„å±æ€§ï¼Œå­¦ä¹ åŸºåˆ†ç±»å™¨ (å¦‚ï¼šCART)</p>
<p>end for</p>
<p>è¾“å‡ºï¼šæœ€ç»ˆåˆ†ç±»å™¨</p>
<h1 id="4-Stacking"><a href="#4-Stacking" class="headerlink" title="4. Stacking"></a>4. Stacking</h1><ul>
<li><strong>ä»‹ç»</strong></li>
</ul>
<p><strong>å‡è®¾æ˜¯äº”æŠ˜çš„stackingï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªtrainæ•°æ®é›†å’Œä¸€ä¸ªtestæ•°æ®é›†ï¼Œé‚£ä¹ˆä¸€ä¸ªåŸºæœ¬çš„stackingæ¡†æ¶ä¼šè¿›è¡Œå¦‚ä¸‹å‡ ä¸ªæ“ä½œï¼š</strong></p>
<p>1ã€é€‰æ‹©åŸºæ¨¡å‹ã€‚æˆ‘ä»¬å¯ä»¥æœ‰xgboostï¼ŒlightGBMï¼ŒRandomForestï¼ŒSVMï¼ŒANNï¼ŒKNNï¼ŒLRç­‰ç­‰ä½ èƒ½æƒ³åˆ°çš„å„ç§åŸºæœ¬ç®—æ³•æ¨¡å‹ã€‚</p>
<p>2ã€æŠŠè®­ç»ƒé›†åˆ†ä¸ºä¸äº¤å‰çš„äº”ä»½ã€‚æˆ‘ä»¬æ ‡è®°ä¸ºtrain1åˆ°train5ã€‚</p>
<p>3ã€ä»train1å¼€å§‹ä½œä¸ºé¢„æµ‹é›†ï¼Œä½¿ç”¨train2åˆ°train5å»ºæ¨¡(model1)ï¼Œç„¶åé¢„æµ‹train1ï¼Œå¹¶ä¿ç•™ç»“æœï¼›ç„¶åï¼Œä»¥train2ä½œä¸ºé¢„æµ‹é›†ï¼Œä½¿ç”¨train1ï¼Œtrain3åˆ°train5å»ºæ¨¡ï¼Œé¢„æµ‹train2ï¼Œå¹¶ä¿ç•™ç»“æœ(model2)ï¼›å¦‚æ­¤è¿›è¡Œä¸‹å»â€¦â€¦.ç›´åˆ°æŠŠtrain1åˆ°train5å„é¢„æµ‹ä¸€éï¼›</p>
<p>4ã€æŠŠé¢„æµ‹çš„ç»“æœæŒ‰ç…§train1åˆ°trian5çš„ä½ç½®å¯¹åº”å¡«è¡¥ä¸Šï¼Œå¾—åˆ°å¯¹trainæ•´ä¸ªæ•°æ®é›†åœ¨ç¬¬ä¸€ä¸ªåŸºæ¨¡å‹çš„ä¸€ä¸ªstackingè½¬æ¢ã€‚</p>
<p>5ã€åœ¨ä¸Šè¿°å»ºç«‹çš„äº”ä¸ªæ¨¡å‹è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªæ¨¡å‹åˆ†åˆ«å¯¹testæ•°æ®é›†è¿›è¡Œé¢„æµ‹ï¼Œå¹¶æœ€ç»ˆä¿ç•™è¿™äº”åˆ—ç»“æœï¼Œç„¶åå¯¹è¿™äº”åˆ—å–å¹³å‡ï¼Œä½œä¸ºç¬¬ä¸€ä¸ªåŸºæ¨¡å‹å¯¹testæ•°æ®çš„ä¸€ä¸ªstackingè½¬æ¢ã€‚</p>
<p>6ã€ç„¶åè¿›å…¥ç¬¬äºŒå±‚ï¼Œå°†æ–°ç‰¹å¾ä½œä¸ºç¬¬äºŒå±‚çš„train dataï¼Œç¬¬ä¸€å±‚çš„é¢„æµ‹ç»“æœä½œä¸ºtest data</p>
<p><strong>7ã€ä¸€èˆ¬ä½¿ç”¨LR(é€»è¾‘å›å½’)ä½œä¸ºç¬¬äºŒå±‚çš„æ¨¡å‹è¿›è¡Œå»ºæ¨¡é¢„æµ‹ã€‚</strong></p>
<p>ä½†ä½¿ç”¨stackingä¼šæ¯”è¾ƒè€—æ—¶ï¼Œæ‰€ä»¥çœŸæ­£æ¯”èµ›çš„æ—¶å€™å¯ä»¥æ”¹ä¸º3æŠ˜æˆ–4æŠ˜</p>
<ul>
<li><strong>Stackingçš„è¾“å‡ºå±‚ä¸ºä»€ä¹ˆç”¨é€»è¾‘å›å½’ï¼Ÿ</strong></li>
</ul>
<p>stackingçš„æœ‰æ•ˆæ€§ä¸»è¦æ¥è‡ªäºç‰¹å¾æŠ½å–ã€‚<strong>è€Œè¡¨ç¤ºå­¦ä¹ ä¸­ï¼Œå¦‚å½±éšå½¢çš„é—®é¢˜å°±æ˜¯è¿‡æ‹Ÿåˆï¼Œè¯•å›æƒ³æ·±åº¦å­¦ä¹ ä¸­çš„è¿‡æ‹Ÿåˆé—®é¢˜ã€‚</strong></p>
<p>åœ¨[5]ä¸­ï¼Œå‘¨å¿—åæ•™æˆä¹Ÿé‡ç”³äº†stackingåœ¨ä½¿ç”¨ä¸­çš„è¿‡æ‹Ÿåˆé—®é¢˜ã€‚å› ä¸ºç¬¬äºŒå±‚çš„ç‰¹å¾æ¥è‡ªäºå¯¹äºç¬¬ä¸€å±‚æ•°æ®çš„å­¦ä¹ ï¼Œé‚£ä¹ˆç¬¬äºŒå±‚æ•°æ®ä¸­çš„ç‰¹å¾ä¸­ä¸è¯¥åŒ…æ‹¬åŸå§‹ç‰¹å¾ï¼Œ<strong>ä»¥é™ä½è¿‡æ‹Ÿåˆçš„é£é™©</strong>ã€‚ä¸¾ä¾‹ï¼š</p>
<ul>
<li>ç¬¬äºŒå±‚æ•°æ®ç‰¹å¾ï¼šä»…åŒ…å«å­¦ä¹ åˆ°çš„ç‰¹å¾</li>
<li>ç¬¬äºŒå±‚æ•°æ®ç‰¹å¾ï¼šåŒ…å«å­¦ä¹ åˆ°çš„ç‰¹å¾ + åŸå§‹ç‰¹å¾</li>
</ul>
<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œstackingä¸­ä¸€èˆ¬éƒ½ç”¨äº¤å‰éªŒè¯æ¥é¿å…è¿‡æ‹Ÿåˆï¼Œè¶³å¯è§è¿™ä¸ªé—®é¢˜çš„ä¸¥é‡æ€§ã€‚</p>
<p>ä¸ºäº†é™ä½è¿‡æ‹Ÿåˆçš„é—®é¢˜ï¼Œç¬¬äºŒå±‚åˆ†ç±»å™¨åº”è¯¥æ˜¯è¾ƒä¸ºç®€å•çš„åˆ†ç±»å™¨ï¼Œå¹¿ä¹‰çº¿æ€§å¦‚é€»è¾‘å›å½’æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚<strong>åœ¨ç‰¹å¾æå–çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨äº†å¤æ‚çš„éçº¿æ€§å˜æ¢ï¼Œå› æ­¤åœ¨è¾“å‡ºå±‚ä¸éœ€è¦å¤æ‚çš„åˆ†ç±»å™¨</strong>ã€‚è¿™ä¸€ç‚¹å¯ä»¥å¯¹æ¯”ç¥ç»ç½‘ç»œçš„æ¿€æ´»å‡½æ•°æˆ–è€…è¾“å‡ºå±‚ï¼Œéƒ½æ˜¯å¾ˆç®€å•çš„å‡½æ•°ï¼Œä¸€ç‚¹åŸå› å°±æ˜¯ä¸éœ€è¦å¤æ‚å‡½æ•°å¹¶èƒ½æ§åˆ¶å¤æ‚åº¦ã€‚</p>
<p>å› æ­¤ï¼Œstackingçš„è¾“å‡ºå±‚ä¸éœ€è¦è¿‡åˆ†å¤æ‚çš„å‡½æ•°ï¼Œç”¨é€»è¾‘å›å½’è¿˜æœ‰é¢å¤–çš„å¥½å¤„ï¼š</p>
<ul>
<li>é…åˆL1æ­£åˆ™åŒ–è¿˜å¯ä»¥è¿›ä¸€æ­¥é˜²æ­¢è¿‡æ‹Ÿåˆ</li>
<li>é…åˆL1æ­£åˆ™åŒ–è¿˜å¯ä»¥é€‰æ‹©æœ‰æ•ˆç‰¹å¾ï¼Œä»ç¬¬ä¸€å±‚çš„å­¦ä¹ å™¨ä¸­åˆ é™¤ä¸å¿…è¦çš„åˆ†ç±»å™¨ï¼ŒèŠ‚çœè¿ç®—å¼€é”€ã€‚</li>
<li>é€»è¾‘å›å½’çš„è¾“å‡ºç»“æœè¿˜å¯è¢«ç†è§£ä¸ºæ¦‚ç‡</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>[1]. <a target="_blank" rel="noopener" href="https://github.com/Dod-o/Statistical-Learning-Method_Code/blob/master/AdaBoost/AdaBoost.py">https://github.com/Dod-o/</a></p>
<p>[2]. ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ â€“ æèˆª</p>
<p>[3]. ã€Šæœºå™¨å­¦ä¹ ã€‹ â€“ å‘¨å¿—å</p>
<p>[4]. <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1005304">ã€SPAå¤§èµ›ã€‘è…¾è®¯å¹¿å‘Šç‚¹å‡»å¤§èµ›ï¼šå¯¹stackingçš„ä¸€äº›åŸºæœ¬ä»‹ç»</a></p>
<p>[5]. Zhou, Z.H., 2012. <em>Ensemble methods: foundations and algorithms</em>. CRC press.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/18/DecisionTree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/18/DecisionTree/" class="post-title-link" itemprop="url">DecisionTree</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-03-18 15:51:09" itemprop="dateCreated datePublished" datetime="2021-03-18T15:51:09+08:00">2021-03-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-03-19 10:50:25" itemprop="dateModified" datetime="2021-03-19T10:50:25+08:00">2021-03-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>åŸºæœ¬çš„åˆ†ç±»ä¸å›å½’æ–¹æ³•ã€‚æœ¬æ–‡ä¸»è¦æ˜¯å…³äºåˆ†ç±»çš„å†³ç­–æ ‘ã€‚</p>
<p>é€šå¸¸åŒ…æ‹¬ä¸‰ä¸ªæ­¥éª¤ï¼šç‰¹å¾é€‰æ‹©ã€å†³ç­–æ ‘çš„ç”Ÿæˆå’Œå†³ç­–æ ‘çš„ä¿®å‰ª</p>
<h1 id="1-æ¨¡å‹ä¸å­¦ä¹ "><a href="#1-æ¨¡å‹ä¸å­¦ä¹ " class="headerlink" title="1. æ¨¡å‹ä¸å­¦ä¹ "></a>1. æ¨¡å‹ä¸å­¦ä¹ </h1><ul>
<li><strong>æ¨¡å‹</strong></li>
</ul>
<p>å¯ä»¥å°†å†³ç­–æ¨¡å‹çœ‹ä½œæ˜¯ä¸€ä¸ªif-thenç»“æ„ï¼Œå…·æœ‰çš„é‡è¦æ€§è´¨æ˜¯äº’æ–¥ä¸”å®Œå¤‡</p>
<ul>
<li><strong>å­¦ä¹ </strong></li>
</ul>
<p><strong>ç›®æ ‡</strong>æ˜¯æ ¹æ®ç»™å®šçš„è®­ç»ƒæ•°æ®é›†æ„å»ºä¸€ä¸ªå†³ç­–æ ‘æ¨¡å‹ï¼Œ ä½¿å®ƒèƒ½å¤Ÿå¯¹å®ä¾‹è¿›è¡Œæ­£ç¡®çš„åˆ†ç±»ã€‚é€šå¸¸ä½¿ç”¨æŸå¤±å‡½æ•°(æ­£åˆ™åŒ–çš„æå¤§ä¼¼ç„¶å‡½æ•°)è¡¨ç¤ºè¿™ä¸€ç›®æ ‡ã€‚</p>
<p>å†³ç­–æ ‘å­¦ä¹ çš„ç®—æ³•é€šå¸¸æ˜¯ä¸€ä¸ªé€’å½’åœ°é€‰æ‹©æœ€ä¼˜ç‰¹å¾ï¼Œ å¹¶æ ¹æ®è¯¥ç‰¹å¾å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œåˆ†å‰²ï¼Œ ä½¿å¾—å¯¹å„ä¸ªå­æ•°æ®é›†æœ‰ä¸€ä¸ªæœ€å¥½çš„åˆ†ç±»çš„è¿‡ç¨‹ã€‚</p>
<p>å¦‚æœç‰¹å¾æ•°é‡å¾ˆå¤šï¼Œ ä¹Ÿå¯ä»¥åœ¨å†³ç­–æ ‘å­¦ä¹ å¼€å§‹çš„æ—¶å€™ï¼Œå¯¹ç‰¹å¾è¿›è¡Œé€‰æ‹©ï¼Œåªç•™ä¸‹<br>å¯¹è®­ç»ƒæ•°æ®æœ‰è¶³å¤Ÿåˆ†ç±»èƒ½åŠ›çš„ç‰¹å¾</p>
<p>ä¸€èˆ¬è€Œè¨€<strong>å†³ç­–æ ‘å­¦ä¹ ç®—æ³•</strong>åŒ…å«</p>
<ul>
<li>ç‰¹å¾é€‰æ‹©</li>
<li>å†³ç­–æ ‘çš„ç”Ÿæˆ</li>
<li>å†³ç­–æ ‘çš„å‰ªæè¿‡ç¨‹</li>
</ul>
<p>å¸¸ç”¨çš„ç®—æ³•æœ‰ID3ã€C4.5ã€CART</p>
<h1 id="2-ç‰¹å¾é€‰æ‹©"><a href="#2-ç‰¹å¾é€‰æ‹©" class="headerlink" title="2. ç‰¹å¾é€‰æ‹©"></a>2. ç‰¹å¾é€‰æ‹©</h1><p>ç‰¹å¾é€‰æ‹©åœ¨äºé€‰å–å¯¹è®­ç»ƒæ•°æ®å…·æœ‰åˆ†ç±»èƒ½åŠ›çš„ç‰¹å¾ã€‚ å¦‚æœåˆ©ç”¨ä¸€ä¸ªç‰¹å¾è¿›è¡Œåˆ†ç±»çš„ç»“æœä¸éšæœºåˆ†ç±»çš„ç»“æœæ²¡æœ‰å¾ˆå¤§å·®åˆ«ï¼Œ åˆ™ç§°è¿™ä¸ªç‰¹å¾æ˜¯æ²¡æœ‰åˆ†ç±»èƒ½åŠ›çš„</p>
<p>é€šå¸¸é€‰æ‹©çš„å‡†åˆ™æ˜¯<strong>ä¿¡æ¯å¢ç›Š</strong>æˆ–<strong>ä¿¡æ¯å¢ç›Šæ¯”</strong>ã€‚</p>
<h2 id="2-1-ä¿¡æ¯å¢ç›Š"><a href="#2-1-ä¿¡æ¯å¢ç›Š" class="headerlink" title="2.1 ä¿¡æ¯å¢ç›Š"></a>2.1 ä¿¡æ¯å¢ç›Š</h2><ul>
<li><strong>ç†µ</strong></li>
</ul>
<p>éšæœºå˜é‡Xçš„ç†µå®šä¹‰ä¸º<br>$$<br>H(X) = H(p) = -\sum_{i=1}^{n} p_{i} \log p_{i}<br>$$<br>ç†µè¶Šå¤§ï¼Œéšæœºå˜é‡çš„ä¸ç¡®å®šæ€§å°±è¶Šå¤§ã€‚</p>
<ul>
<li><strong>æ¡ä»¶ç†µ</strong></li>
</ul>
<p>å·²çŸ¥éšæœºå˜é‡Xçš„æ¡ä»¶ä¸‹éšæœºå˜é‡Yçš„ä¸ç¡®å®šæ€§<br>$$<br>H(Y \mid X)=\sum_{i=1}^{n} p_{i} H(Y \mid X=x_{i})<br>$$<br>å…¶ä¸­ $p_i = P(X=x_i)$ .</p>
<p>å½“ç†µå’Œæ¡ä»¶ç†µä¸­çš„æ¦‚ç‡ç”±æ•°æ®ä¼°è®¡(ç‰¹åˆ«æ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡)å¾—åˆ°æ—¶ï¼Œ æ‰€å¯¹åº”çš„ç†µä¸æ¡ä»¶ç†µåˆ†åˆ«ç§°ä¸ºç»éªŒç†µï¼ˆempirical entropy)å’Œç»éªŒæ¡ä»¶ç†µã€‚</p>
<ul>
<li><strong>ä¿¡æ¯å¢ç›Š</strong></li>
</ul>
<p>è¡¨ç¤ºå¾—çŸ¥ç‰¹å¾ $X$ çš„ä¿¡æ¯è€Œä½¿å¾—ç±» $Y$ çš„ä¿¡æ¯çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ã€‚</p>
<p>ç‰¹å¾Aå¯¹è®­ç»ƒæ•°æ®é›†Dçš„ä¿¡æ¯å¢ç›Š $g(D,A)$ï¼Œå®šä¹‰ä¸ºé›†åˆ $D$ çš„ç»éªŒç†µ $H(D)$ ä¸ç‰¹å¾ $A$ ç»™å®šæ¡ä»¶ä¸‹ $D$ çš„ç»éªŒæ¡ä»¶ç†µ $H(D|A)$ä¹‹å·®<br>$$<br>g(D,A) = H(D) - H(D|A)<br>$$<br>ä¸€èˆ¬åœ°ï¼Œ ç†µH(y)ä¸æ¡ä»¶ç†µH(y|X)ä¹‹å·®ç§°ä¸ºäº’ä¿¡æ¯ï¼ˆmutual information)ã€‚ å†³ç­–æ ‘å­¦ä¹ ä¸­çš„ä¿¡æ¯å¢ç›Šç­‰ä»·äºè®­ç»ƒæ•°æ®é›†ä¸­ç±»ä¸ç‰¹å¾çš„äº’ä¿¡æ¯</p>
<p>æ ¹æ®ä¿¡æ¯å¢ç›Šå‡†åˆ™çš„ç‰¹å¾é€‰æ‹©æ–¹æ³•æ˜¯:  å¯¹è®­ç»ƒæ•°æ®é›†ï¼ˆæˆ–å­é›†ï¼‰Dï¼Œ è®¡ç®—å…¶æ¯ä¸ªç‰¹<br>å¾çš„ä¿¡æ¯å¢ç›Šï¼Œå¹¶æ¯”è¾ƒå®ƒä»¬çš„å¤§å°ï¼Œé€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ã€‚</p>
<p>è®¾è®­ç»ƒæ•°æ®é›†ä¸º $D,|D|$ è¡¨ç¤ºå…¶æ ·æœ¬å®¹é‡ï¼Œå³æ ·æœ¬ä¸ªæ•°ã€‚è®¾æœ‰ $K$ ä¸ªç±» $C_{k}, k=$ $1,2, \cdots, K,|C_{k}|$ ä¸ºå±äºç±» $C_{k}$ çš„æ ·æœ¬ä¸ªæ•°, $\sum_{k=1}^{K}\left|C_{k}\right|=|D|$ è®¾ç‰¹å¾ $A$ æœ‰ $n$ ä¸ªä¸åŒçš„å–å€¼ $\lbrace a_{1}, a_{2}, \cdots, a_{n} \rbrace$ æ ¹æ®ç‰¹å¾ $A$ çš„å–å€¼å°† $D$ åˆ’åˆ†ä¸º $n$ ä¸ªå­é›† $D_{1}, D_{2}, \cdots, D_{n}$ ï¼Œ$|D_{i}|$ ä¸º $D_{i}$ çš„æ ·æœ¬ä¸ªæ•°ï¼Œ $\sum_{i=1}^{n}\left|D_{i}\right|=|D|$ è®°å­é›† $D_{i}$ ä¸­å±äºç±» $C_{k}$ çš„æ ·æœ¬çš„é›†åˆä¸º $D_{i k}$ ï¼Œå³ $D_{ik}=D_{i} \cap C_{k},|D_{ik}|$ ä¸º $D_{ik}$ çš„æ ·æœ¬ä¸ªæ•°ã€‚äºæ˜¯ä¿¡æ¯å¢ç›Šçš„ç®—æ³•å¦‚ä¸‹ã€‚</p>
<p><strong>ç®—æ³•5.1ï¼ˆä¿¡æ¯å¢ç›Šçš„ç®—æ³•ï¼‰</strong><br>è¾“å…¥: è®­ç»ƒæ•°æ®é›† $D$ å’Œç‰¹å¾ $A$ï¼›</p>
<p>è¾“å‡ºï¼šç‰¹å¾ $A$ å¯¹è®­ç»ƒæ•°æ®é›† $D$ çš„ä¿¡æ¯å¢ç›Š $g(D, A)$ ã€‚<br>(1) è®¡ç®—æ•°æ®é›† $D$ çš„ç»éªŒç†µ $H(D)$<br>$$<br>H(D)=-\sum_{k=1}^{K} \frac{\left|C_{k}\right|}{|D|} \log_{2} \frac{|C_{k}|}{|D|}<br>$$<br>(2) è®¡ç®—ç‰¹å¾ $A$ å¯¹æ•°æ®é›† $D$ çš„ç»éªŒæ¡ä»¶å«¡ $H(D \mid A)$<br>$$<br>H(D \mid A)=\sum_{i=1}^{n} \frac{\left|D_{i}\right|}{|D|} H\left(D_{i}\right)=-\sum_{i=1}^{n} \frac{\left|D_{i}\right|}{|D|} \sum_{k=1}^{K} \frac{\left|D_{i k}\right|}{\left|D_{i}\right|} \log_{2} \frac{\left|D_{ik}\right|}{\left|D_{i}\right|}<br>$$<br>(3) è®¡ç®—ä¿¡æ¯å¢ç›Š<br>$$<br>g(D, A)=H(D)-H(D \mid A)<br>$$</p>
<h2 id="2-2-ä¿¡æ¯å¢ç›Šæ¯”"><a href="#2-2-ä¿¡æ¯å¢ç›Šæ¯”" class="headerlink" title="2.2 ä¿¡æ¯å¢ç›Šæ¯”"></a>2.2 ä¿¡æ¯å¢ç›Šæ¯”</h2><ul>
<li>å®šä¹‰(ä¿¡æ¯å¢ç›Šä¸ç†µä¹‹æ¯”)<br>$$<br>g_{R}(D, A)=\frac{g(D, A)}{H_{A}(D)}<br>$$</li>
</ul>
<p>å…¶ä¸­ï¼Œ$H_{A}(D)=-\sum_{i=1}^{n} \frac{|D_{i}|}{|D|} \log <em>{2} \frac{|D</em>{i}|}{|D|}, n$ æ˜¯ç‰¹å¾ $A$ å–å€¼çš„ä¸ªæ•°ã€‚</p>
<h1 id="3-å†³ç­–æ ‘çš„ç”Ÿæˆ"><a href="#3-å†³ç­–æ ‘çš„ç”Ÿæˆ" class="headerlink" title="3. å†³ç­–æ ‘çš„ç”Ÿæˆ"></a>3. å†³ç­–æ ‘çš„ç”Ÿæˆ</h1><h2 id="3-1-ID3ç®—æ³•"><a href="#3-1-ID3ç®—æ³•" class="headerlink" title="3.1 ID3ç®—æ³•"></a>3.1 ID3ç®—æ³•</h2><p>å…·ä½“æ–¹æ³•æ˜¯ï¼š ä»æ ¹ç»“ç‚¹ï¼ˆroot node)å¼€å§‹ï¼Œ å¯¹ç»“ç‚¹è®¡ç®—æ‰€æœ‰å¯èƒ½çš„ç‰¹å¾çš„ä¿¡æ¯å¢ç›Šï¼Œ é€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ä½œä¸ºç»“ç‚¹çš„ç‰¹å¾ï¼Œ ç”±è¯¥ç‰¹å¾çš„ä¸åŒå–å€¼å»ºç«‹å­ç»“ç‚¹ï¼›å†å¯¹å­ç»“ç‚¹é€’å½’åœ°è°ƒç”¨ä»¥ä¸Šæ–¹æ³•ï¼Œ æ„å»ºå†³ç­–æ ‘ï¼› ç›´åˆ°æ‰€æœ‰ç‰¹å¾çš„ä¿¡æ¯å¢ç›Šå‡å¾ˆå°æˆ–æ²¡æœ‰ç‰¹å¾å¯ä»¥é€‰æ‹©ä¸ºæ­¢ã€‚æœ€åå¾—åˆ°ä¸€é¢—å†³ç­–æ ‘ã€‚ID3ç®—æ³•ç›¸å½“äºç”¨æå¤§ä¼¼ç„¶æ³•è¿›è¡Œæ¦‚ç‡æ¨¡å‹çš„é€‰æ‹©ã€‚</p>
<p><strong>ç®—æ³•3.1 ï¼ˆID3ç®—æ³•ï¼‰</strong></p>
<p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† $D$ ,ç‰¹å¾é›† $A$ é˜ˆå€¼ $\varepsilon$</p>
<p>è¾“å‡ºï¼šå†³ç­–æ ‘ $T$ ã€‚</p>
<p>ï¼ˆ1ï¼‰è‹¥ $D$ ä¸­æ‰€æœ‰å®ä¾‹å±äºåŒä¸€ç±» $C_{k},$ åˆ™ $T$ ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°†ç±» $C_{k}$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› $T$;</p>
<p>ï¼ˆ2ï¼‰è‹¥ $A=\varnothing$ ï¼Œåˆ™ $T$ ä¸ºï¼Œshå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°† $D$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_{k}$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› $T$;</p>
<p>ï¼ˆ3ï¼‰å¦åˆ™ï¼Œè®¡ç®— $A$ ä¸­å„ç‰¹å¾å¯¹ $D$ çš„fanjiaä¿¡æ¯å¢ç›Šï¼Œé€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ $A_{g}$ ï¼›</p>
<p>ï¼ˆ4ï¼‰å¦‚æœ $A_{g}$ çš„ä¿¡æ¯å¢ç›Šå°äºé˜ˆå€¼ $\varepsilon$ ï¼Œåˆ™è®¾ç½® $T$ ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°† $D$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_{k}$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› $T$;</p>
<p>ï¼ˆ5ï¼‰å¦åˆ™ï¼Œå¯¹ $A_{g}$ çš„æ¯ä¸€å¯èƒ½å€¼ $a_{i},$ ä¾ $A_{g}=a_{i}$ å°† $D$ åˆ†å‰²ä¸ºè‹¥å¹²éç©ºå­é›† $D_{i},$ å°†$D_{i}$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±»ä½œä¸ºæ ‡è®°ï¼Œæ„å»ºå­ç»“ç‚¹ï¼Œç”±ç»“ç‚¹åŠå…¶å­ç»“ç‚¹æ„æˆæ ‘ $T$ ï¼Œè¿”å› $T$;</p>
<p>ï¼ˆ6ï¼‰å¯¹ç¬¬ $i$ ä¸ªå­ç»“ç‚¹ï¼Œä»¥ $D_{i}$ ä¸ºè®­ç»ƒé›†ï¼Œä»¥ $A-\lbrace A_{g}\rbrace$ ä¸ºç‰¹å¾é›†ï¼Œé€’å½’åœ°è°ƒç”¨æ­¥ (1)$\sim$ æ­¥ $(5),$ å¾—åˆ°å­æ ‘ $T_{i},$ è¿”å› $T_{i}$</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šåªæœ‰æ ‘ç”Ÿæˆï¼Œæ²¡æœ‰æ ‘å‰ªæï¼Œå®¹æ˜“è¿‡æ‹Ÿåˆ</p>
<h2 id="3-2-C4-5ç®—æ³•"><a href="#3-2-C4-5ç®—æ³•" class="headerlink" title="3.2 C4.5ç®—æ³•"></a>3.2 C4.5ç®—æ³•</h2><p>ä¸ID3ç›¸æ¯”ï¼Œåœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ç”¨<strong>ä¿¡æ¯å¢ç›Šæ¯”</strong>æ¥é€‰æ‹©ç‰¹å¾ã€‚</p>
<p><strong>ç®—æ³• 3.2 ï¼ˆC4.5çš„ç”Ÿæˆç®—æ³•ï¼‰</strong></p>
<p>è¾“å…¥: è®­ç»ƒæ•°æ®é›† $D$, ç‰¹å¾é›† $A$ é˜ˆå€¼ $\varepsilon ;$</p>
<p>è¾“å‡º: å†³ç­–æ ‘ $T_{\circ}$</p>
<p>ï¼ˆ1ï¼‰å¦‚æœ $D$ ä¸­æ‰€æœ‰å®ä¾‹å±äºåŒä¸€ç±» $C_{k},$ åˆ™ç½® $T$ ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°† $C_{k}$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»ï¼Œè¿”å› $T$;</p>
<p>ï¼ˆ2ï¼‰å¦‚æœ $A=\varnothing,$ åˆ™ç½® $T$ ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°† $D$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_{k}$ ä½œä¸ºè¯¥ç»“çš„ç±»ï¼Œè¿”å› $T$;</p>
<p>ï¼ˆ3ï¼‰å¦åˆ™ï¼Œè®¡ç®— $A$ ä¸­å„ç‰¹å¾å¯¹ $D$ çš„ä¿¡æ¯å¢ç›Šæ¯”ï¼Œé€‰æ‹©ä¿¡æ¯å¢ç›Šæ¯”æœ€å¤§çš„ç‰¹å¾ $A_{g} ;$</p>
<p>ï¼ˆ4ï¼‰å¦‚æœ $A_{g}$ çš„ä¿¡æ¯å¢ç›Šæ¯”å°äºé˜ˆå€¼ $\varepsilon$ ï¼Œåˆ™ç½® $T$ ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°† $D$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_{k}$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»ï¼Œè¿”å› $T$;</p>
<p>ï¼ˆ5ï¼‰å¦åˆ™ï¼Œå¯¹ $A_{g}$ çš„æ¯ä¸€å¯èƒ½å€¼ $a_{i},$ ä¾ $A_{g}=a_{i}$ å°† $D$ åˆ†å‰²ä¸ºå­é›†è‹¥å¹²éç©º $D_{i}$ ï¼Œå°† $D_{i}$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±»ä½œä¸ºæ ‡è®°ï¼Œæ„å»ºå­ç»“ç‚¹ï¼Œç”±ç»“ç‚¹åŠå…¶å­ç»“ç‚¹æ„æˆæ ‘ $T$ ï¼Œè¿”å› $T$;</p>
<p>ï¼ˆ6ï¼‰å¯¹ç»“ç‚¹ $i$,ä»¥ $D_{i}$ ä¸ºè®­ç»ƒé›†ï¼Œä»¥ $A-\left{A_{g}\right}$ ä¸ºç‰¹å¾é›†ï¼Œé€’å½’åœ°è°ƒç”¨æ­¥(1)$\sim$æ­¥ $(5),$ å¾—åˆ°å­æ ‘ $T_{i},$ è¿”å› $T_{i}$ ã€‚</p>
<h1 id="4-å†³ç­–æ ‘çš„å‰ªæ"><a href="#4-å†³ç­–æ ‘çš„å‰ªæ" class="headerlink" title="4. å†³ç­–æ ‘çš„å‰ªæ"></a>4. å†³ç­–æ ‘çš„å‰ªæ</h1><p>ä»¥ä¸Šä¸¤ç§ç®—æ³•å‡æœªè€ƒè™‘æ ‘çš„å¤æ‚åº¦ï¼Œè¿™æ ·äº§ç”Ÿçš„å†³ç­–æ ‘å®¹æ˜“å‡ºç°è¿‡æ‹Ÿåˆçš„é—®é¢˜ã€‚å› æ­¤éœ€è¦å°†ç”Ÿæˆçš„æ ‘è¿›è¡Œç®€åŒ–ã€‚</p>
<p>å†³ç­–æ ‘çš„å‰ªæå¾€å¾€é€šè¿‡æå°åŒ–å†³ç­–æ ‘æ•´ä½“çš„æŸå¤±å‡½æ•°æˆ–ä»£ä»·å‡½æ•°æ¥å®ç°ã€‚è®¾æ ‘ $T$ çš„å¶èŠ‚ç‚¹ä¸ªæ•°ä¸º $|T|$ ï¼Œ$t$ æ˜¯æ ‘ $T$ çš„å¶èŠ‚ç‚¹ï¼Œè¯¥å¶èŠ‚ç‚¹æœ‰ $N_t$ ä¸ªæ ·æœ¬ç‚¹ï¼Œå…¶ä¸­ $k$ ç±»æ ·æœ¬ç‚¹æœ‰ $N_{tk}$ ä¸ªï¼Œ $H_t(T)$ ä¸ºå¶èŠ‚ç‚¹ $t$ ä¸Šçš„ç»éªŒç†µã€‚ $\alpha$ ä¸ºå‚æ•°ã€‚åˆ™å†³ç­–æ ‘çš„æŸå¤±å‡½æ•°å¯ä»¥å®šä¹‰ä¸º<br>$$<br>\begin{array}{c}<br>C_{\alpha}(T)=\sum_{t=1}^{|T|} N_{t} H_{t}(T)+\alpha|T| \\<br>H_{t}(T)=-\sum_{k} \frac{N_{tk}}{N_{t}} \log \frac{N_{tk}}{N_{t}}<br>\end{array}<br>$$<br>å°†ç¬¬ä¸€é¡¹è®°åš $C(T)$ï¼Œè¿™æ—¶æœ‰<br>$$<br>C_{\alpha}(T) = C(T)+ \alpha|T|<br>$$<br>ç¬¬ä¸€é¡¹è¡¨ç¤ºå¯¹è®­ç»ƒæ•°æ®çš„é¢„æµ‹è¯¯å·®ï¼Œç¬¬äºŒé¡¹è¡¨ç¤ºæ¨¡å‹çš„å¤æ‚åº¦ã€‚$\alpha \geq 0$ æ§åˆ¶ä¸¤è€…ä¹‹é—´çš„å½±å“ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œå†³ç­–æ ‘çš„ç”Ÿæˆå­¦ä¹ å±€éƒ¨çš„æ¨¡å‹ï¼Œè€Œå†³ç­–æ ‘å‰ªæå­¦ä¹ æ•´ä½“çš„æ¨¡å‹ã€‚</p>
<p><strong>ç®—æ³• 4.1 ï¼ˆæ ‘çš„å‰ªæç®—æ³•ï¼‰</strong></p>
<p>è¾“å…¥ï¼šç”Ÿæˆç®—æ³•äº§ç”Ÿçš„æ•´ä¸ªæ ‘ $T$ ï¼Œå‚æ•° $\alpha$</p>
<p>è¾“å‡ºï¼šä¿®å‰ªåçš„å­æ ‘ $T_{\alpha}$</p>
<p>ï¼ˆ1ï¼‰è®¡ç®—æ¯ä¸ªç»“ç‚¹çš„ç»éªŒç†µ</p>
<p>ï¼ˆ2ï¼‰é€’å½’çš„ä»æ ‘çš„å¶ç»“ç‚¹å‘ä¸Šå›ç¼©ã€‚</p>
<p>è®¾ä¸€ç»„å¶ç»“ç‚¹å›ç¼©åˆ°å…¶çˆ¶ç»“ç‚¹ä¹‹å‰ä¸ä¹‹åçš„æ•´ä½“æ ‘åˆ†åˆ«ä¸º $T_B$ ä¸ $T_A$ ,å…¶å¯¹åº”çš„æŸå¤±å‡½æ•°å€¼åˆ†åˆ«æ˜¯ $C_{\alpha}(T_B)$ ä¸ $C_{\alpha}(T_A)$ ï¼Œ å¦‚æœ<br>$$<br>C_{\alpha}(T_A) \leq C_{\alpha}(T_B)<br>$$<br>åˆ™è¿›è¡Œå‰ªæï¼Œå³å°†çˆ¶ç»“ç‚¹å˜ä¸ºæ–°çš„å¶ç»“ç‚¹ã€‚</p>
<p>ï¼ˆ3ï¼‰è¿”å›2ï¼Œç›´è‡³ä¸èƒ½ç»§ç»­ä¸ºæ­¢ï¼Œå¾—åˆ°æŸå¤±å‡½æ•°æœ€å°çš„å­æ ‘ $T$</p>
<h1 id="5-CART-classification-and-regresstion-tree-ç®—æ³•-â€“1984"><a href="#5-CART-classification-and-regresstion-tree-ç®—æ³•-â€“1984" class="headerlink" title="5. CART (classification and regresstion tree)ç®—æ³• â€“1984"></a>5. CART (classification and regresstion tree)ç®—æ³• â€“1984</h1><p><strong>CART</strong>ç”±<u>ç‰¹å¾é€‰æ‹©ã€æ ‘çš„ç”ŸæˆåŠå‰ªæ</u>ç»„æˆçš„<strong>äºŒå‰æ ‘</strong>ã€‚æ—¢å¯ä»¥ç”¨äº<strong>åˆ†ç±»</strong>ä¹Ÿå¯ä»¥ç”¨äº<strong>å›å½’</strong>ã€‚å·¦åˆ†æ”¯æ˜¯â€œæ˜¯â€çš„åˆ†æ”¯ï¼Œå³åˆ†æ”¯æ˜¯â€œå¦â€çš„åˆ†æ”¯ã€‚</p>
<p><strong>CART</strong>æ˜¯åœ¨ç»™å®šè¾“å…¥éšæœºå˜é‡ $X$ æ¡ä»¶ä¸‹è¾“å‡ºéšæœºå˜é‡ $Y$ çš„<strong>æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ</strong>çš„å­¦ä¹ æ–¹æ³•ã€‚</p>
<h2 id="5-1-CARTçš„ç”Ÿæˆ"><a href="#5-1-CARTçš„ç”Ÿæˆ" class="headerlink" title="5.1 CARTçš„ç”Ÿæˆ"></a>5.1 CARTçš„ç”Ÿæˆ</h2><p>å›å½’æ ‘ï¼šå¹³æ–¹è¯¯å·®æœ€å°åŒ–å‡†åˆ™</p>
<p>åˆ†ç±»æ ‘ï¼šåŸºå°¼æŒ‡æ•°(Gini index) æœ€å°åŒ–å‡†åˆ™</p>
<ol>
<li><strong>å›å½’æ ‘çš„ç”Ÿæˆ</strong></li>
</ol>
<p>æ¯ä¸ªè¾“å…¥ç©ºé—´ $R_m$ çš„æ ‡ç­¾å€¼ä¸ºï¼Œæ‰€æœ‰è¾“å…¥ç©ºé—´ä¸­å®ä¾‹çš„æ ‡ç­¾çš„å‡å€¼<br>$$<br>\hat{c} = ave(y_i|x_i \in R_m)<br>$$</p>
<p>ç®—æ³• 5.1 (æœ€å°äºŒä¹˜å›å½’æ ‘ç”Ÿæˆç®—æ³•ï¼‰<br>è¾“å…¥: è®­ç»ƒæ•°æ®é›† $D$;</p>
<p>è¾“å‡º: å›å½’æ ‘ $f(x)$ </p>
<p>åœ¨è®­ç»ƒæ•°æ®é›†æ‰€åœ¨çš„è¾“å…¥ç©ºé—´ä¸­ï¼Œé€’å½’åœ°å°†æ¯ä¸ªåŒºåŸŸåˆ’åˆ†ä¸ºä¸¤ä¸ªå­åŒºåŸŸå¹¶å†³å®šæ¯ä¸ªå­åŒºåŸŸä¸Šçš„è¾“å‡ºå€¼ï¼Œæ„å»ºäºŒå‰å†³ç­–æ ‘:</p>
<p>ï¼ˆ1ï¼‰é€‰æ‹©æœ€ä¼˜åˆ‡åˆ†å˜é‡ $j$ ä¸åˆ‡åˆ†ç‚¹ $s$ ï¼Œæ±‚è§£<br>$$<br>\min_{j, s}\left[\min_{c_{1}} \sum_{x_{i} \in R_{1}(j, s)}\left(y_{i}-c_{1}\right)^{2}+\min_{c_{2}} \sum_{x_{i} \in R_{2}(j, s)}\left(y_{i}-c_{2}\right)^{2}\right]<br>$$<br><strong>éå†</strong>å˜é‡ $j,$ å¯¹å›ºå®šçš„åˆ‡åˆ†å˜é‡ $j$ æ‰«æåˆ‡åˆ†ç‚¹ $s$ ï¼Œé€‰æ‹©ä½¿ä¸Šè¿°ç›®æ ‡å‡½æ•°è¾¾åˆ°æœ€å°å€¼çš„å¯¹<br>$(j, s)$</p>
<p>ï¼ˆ2ï¼‰ç”¨é€‰å®šçš„å¯¹ $(j, s)$ åˆ’åˆ†åŒºåŸŸå¹¶å†³å®šç›¸åº”çš„è¾“å‡ºå€¼:<br>$$<br>\begin{array}{c}<br>R_{1}(j, s)=\lbrace x \mid x^{(j)} \leqslant s\rbrace, \quad R_{2}(j, s)=\lbrace x \mid x^{(j)}&gt;s\rbrace \\<br>\hat{c}<em>{m}=\frac{1}{N</em>{m}} \sum_{x_{i} \in R_{m}(j, s)} y_{i}, \quad x \in R_{m}, \quad m=1,2<br>\end{array}<br>$$<br>ï¼ˆ3ï¼‰ç»§ç»­å¯¹ä¸¤ä¸ªå­åŒºåŸŸè°ƒç”¨æ­¥éª¤ $(1),(2),$ ç›´è‡³æ»¡è¶³åœæ­¢æ¡ä»¶ã€‚</p>
<p>ï¼ˆ4ï¼‰å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸º $M$ ä¸ªåŒºåŸŸ $R_{1}, R_{2}, \cdots, R_{M}$ ï¼Œç”Ÿæˆå†³ç­–æ ‘:<br>$$<br>f(x)=\sum_{m=1}^{M} \hat{c}<em>{m} I\left(x \in R</em>{m}\right)<br>$$<br>å½“æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œéå†çš„æ•ˆç‡ä¸é«˜ã€‚</p>
<ol start="2">
<li><strong>åˆ†ç±»æ ‘çš„ç”Ÿæˆ</strong></li>
</ol>
<p>åˆ†ç±»æ ‘ç”¨åŸºå°¼æŒ‡æ•°é€‰æ‹©æœ€ä¼˜ç‰¹å¾ï¼Œ åŒæ—¶å†³å®šè¯¥ç‰¹å¾çš„æœ€ä¼˜äºŒå€¼åˆ‡åˆ†ç‚¹ã€‚</p>
<p><strong>åŸºå°¼æŒ‡æ•°</strong>çš„å®šä¹‰<br>$$<br>\text{Gini}(p) = \sum_{k = 1}^{K} p_k (1 - p_k) = 1 - \sum_{k=1}^{K}p_k^2<br>$$<br>å¯¹äºç»™å®šæ ·æœ¬é›†åˆDï¼Œ $p_k = \frac{|C_K|}{|D|}$</p>
<p>åŸºå°¼æŒ‡æ•°è¡¨ç¤ºé›†åˆDçš„ä¸ç¡®å®šæ€§ï¼Œæ•°å€¼è¶Šå¤§ï¼Œæ ·æœ¬é›†åˆçš„ä¸ç¡®å®šæ€§å°±è¶Šå¤§ã€‚è¿™ä¸€ç‚¹ä¸ç†µç±»ä¼¼ã€‚</p>
<p>ç®—æ³• $5.6(\mathrm{CART}$ ç”Ÿæˆç®—æ³•ï¼‰ </p>
<p>è¾“å…¥: è®­ç»ƒæ•°æ®é›† $D$ ï¼Œåœæ­¢è®¡ç®—çš„æ¡ä»¶; </p>
<p>è¾“å‡º: CART å†³ç­–æ ‘ã€‚</p>
<p>æ ¹æ®è®­ç»ƒæ•°æ®é›†ï¼Œä»æ ¹ç»“ç‚¹å¼€å§‹ï¼Œé€’å½’åœ°å¯¹æ¯ä¸ªç»“ç‚¹è¿›è¡Œä»¥ä¸‹æ“ä½œï¼Œæ„å»ºäºŒå‰å†³ç­–æ ‘:</p>
<p>ï¼ˆ1ï¼‰è®¾ç»“ç‚¹çš„è®­ç»ƒæ•°æ®é›†ä¸º $D,$ è®¡ç®—ç°æœ‰ç‰¹å¾å¯¹è¯¥æ•°æ®é›†çš„åŸºå°¼æŒ‡æ•°ã€‚æ­¤æ—¶ï¼Œå¯¹æ¯ä¸€ä¸ªç‰¹å¾ $A$ ï¼Œå¯¹å…¶å¯èƒ½å–çš„æ¯ä¸ªå€¼ $a$ï¼Œæ ¹æ®æ ·æœ¬ç‚¹å¯¹ $A=a$ çš„æµ‹è¯•ä¸ºâ€œæ˜¯â€æˆ–â€œå¦â€ å°† $D$ åˆ†å‰²æˆ $D_{1}$ å’Œ $D_{2}$ ä¸¤éƒ¨åˆ†ï¼Œ è®¡ç®— $A=a$ æ—¶çš„åŸºå°¼æŒ‡æ•°ã€‚</p>
<p>ï¼ˆ2ï¼‰åœ¨æ‰€æœ‰å¯èƒ½çš„ç‰¹å¾ $A$ ä»¥åŠå®ƒä»¬æ‰€æœ‰å¯èƒ½çš„åˆ‡åˆ†ç‚¹ $a$ ä¸­ï¼Œé€‰æ‹©åŸºå°¼æŒ‡æ•°æœ€å°çš„ç‰¹å¾åŠå…¶å¯¹åº”çš„åˆ‡åˆ†ç‚¹ä½œä¸ºæœ€ä¼˜ç‰¹å¾ä¸æœ€ä¼˜åˆ‡åˆ†ç‚¹ã€‚ä¾æœ€ä¼˜ç‰¹å¾ä¸æœ€ä¼˜åˆ‡åˆ†ç‚¹ï¼Œä»ç°ç»“ç‚¹ç”Ÿæˆä¸¤ä¸ªå­ç»“ç‚¹ï¼Œå°†è®­ç»ƒæ•°æ®é›†ä¾ç‰¹å¾åˆ†é…åˆ°ä¸¤ä¸ªå­ç»“ç‚¹ä¸­å»ã€‚</p>
<p>ï¼ˆ3ï¼‰å¯¹ä¸¤ä¸ªå­ç»“ç‚¹é€’å½’åœ°è°ƒç”¨ $(1),(2),$ ç›´è‡³æ»¡è¶³åœæ­¢æ¡ä»¶ã€‚</p>
<p>ï¼ˆ4ï¼‰ ç”Ÿæˆ CART å†³ç­–æ ‘ã€‚</p>
<h2 id="5-2-CARTå‰ªæ"><a href="#5-2-CARTå‰ªæ" class="headerlink" title="5.2 CARTå‰ªæ"></a>5.2 CARTå‰ªæ</h2><p>å…·ä½“åœ°ï¼Œ ä»æ•´ä½“æ ‘ $T_0$ å¼€å§‹å‰ªæã€‚ å¯¹ $T_0$ çš„ä»»æ„å†…éƒ¨ç»“ç‚¹ $t$ ï¼Œä»¥ $t$ ä¸ºå•ç»“ç‚¹æ ‘çš„æŸå¤±å‡½æ•°æ˜¯<br>$$<br>C_{\alpha}(t) = C(t) + \alpha<br>$$<br>ä»¥ $t$ ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ $T_t$ çš„æŸå¤±å‡½æ•°æ˜¯<br>$$<br>C_{\alpha}(T_t) = C(T_t) + \alpha ï½œT_t|<br>$$<br>å½“ $\alpha = 0$ åŠ $\alpha$ å……åˆ†å°æ—¶ï¼Œæœ‰<br>$$<br>C_{\alpha}(T_t) &lt; C_{\alpha}(t)<br>$$<br>å½“ $\alpha$ å¢å¤§æ—¶ï¼Œåœ¨æŸä¸€ $\alpha$ æœ‰<br>$$<br>C_{\alpha}(T_t) = C_{\alpha}(t)<br>$$<br>æ‰€ä»¥åªè¦ $\alpha =\frac{C(t)-C\left(T_{t}\right)}{\left|T_{t}\right|-1}$ï¼Œå°±å¯ä»¥é€‰æ‹©ç»“ç‚¹æ›´å°‘çš„tã€‚</p>
<p>è€ŒBerimanç­‰äººè¯æ˜ï¼šå¯ä»¥ç”¨é€’å½’çš„æ–¹æ³•å¯¹æ ‘è¿›è¡Œå‰ªæã€‚å°† $\alpha$ é€æ¸å¢å¤§ï¼Œ$0 = \alpha_0 &lt; \alpha_1 &lt;\cdots &lt;\alpha_n &lt; +\infty$ ï¼Œäº§ç”Ÿä¸€ç³»åˆ—çš„åŒºé—´ $[\alpha_i, \alpha_{i+1}), i = 0,1,â€¦,n$ ï¼›å‰ªæå¾—åˆ°çš„å­æ ‘åºåˆ—å¯¹åº”ç€åŒºé—´ $\alpha \in [\alpha_i, \alpha_{i+1})$ï¼Œçš„æœ€ä¼˜å­æ ‘åºåˆ— $\lbrace T_0, T_1, \cdots, T_n \rbrace$ã€‚ç„¶ååˆ©ç”¨äº¤å‰éªŒè¯æŒ‘å‡ºä¸€ä¸ªæœ€å¥½çš„</p>
<p><strong>ç®—æ³• 5.7 ï¼ˆ$\mathbf{C A R T}$ å‰ªæç®—æ³•ï¼‰</strong></p>
<p>è¾“å…¥: $\mathrm{CART}$ ç®—æ³•ç”Ÿæˆçš„å†³ç­–æ ‘ $T_{0} ;$</p>
<p>è¾“å‡ºï¼šæœ€ä¼˜å†³ç­–æ ‘ $T_{\alpha^{\circ}}$</p>
<p>ï¼ˆ1ï¼‰è®¾ $k=0, T=T_{0}$ ã€‚</p>
<p>ï¼ˆ2ï¼‰è®¾ $\alpha=+\infty$ ã€‚</p>
<p>ï¼ˆ3ï¼‰è‡ªä¸‹è€Œä¸Šåœ°å¯¹å„å†…éƒ¨ç»“ç‚¹ $t$ è®¡ç®— $C\left(T_{t}\right),\left|T_{t}\right|$ ä»¥åŠ<br>$$<br>\begin{aligned}<br>g(t) &amp;=\frac{C(t)-C\left(T_{t}\right)}{\left|T_{t}\right|-1} \\<br>\alpha &amp;=\min (\alpha, g(t))<br>\end{aligned}<br>$$<br>è¿™é‡Œï¼Œ $T_{t}$ è¡¨ç¤ºä»¥ $t$ ä¸ºæ ¹ç»“ç‚¹çš„å­æ ‘ï¼Œ $C\left(T_{t}\right)$ æ˜¯å¯¹è®­ç»ƒæ•°æ®çš„é¢„æµ‹è¯¯å·®ï¼Œ $\left|T_{t}\right|$ æ˜¯ $T_{t}$ çš„å¶ ç»“ç‚¹ä¸ªæ•°ã€‚</p>
<p>ï¼ˆ4ï¼‰å¯¹ $g(t)=\alpha$ çš„å†…éƒ¨ç»“ç‚¹ $t$ è¿›è¡Œå‰ªæï¼Œå¹¶å¯¹å¶ç»“ç‚¹ $t$ ä»¥å¤šæ•°è¡¨å†³æ³•å†³å®šå…¶ç±»ï¼Œ<br>å¾—åˆ°æ ‘ $T$ ã€‚</p>
<p>ï¼ˆ5ï¼‰è®¾ $k=k+1, \alpha_{k}=\alpha, T_{k}=T_{\circ}$</p>
<p>ï¼ˆ6ï¼‰å¦‚æœ $T_{k}$ ä¸æ˜¯ç”±æ ¹ç»“ç‚¹åŠä¸¤ä¸ªå¶ç»“ç‚¹æ„æˆçš„æ ‘ï¼Œåˆ™å›åˆ°æ­¥éª¤ (2)$;$ å¦åˆ™ä»¤<br>$T_{k}=T_{n}$</p>
<p>ï¼ˆ7ï¼‰é‡‡ç”¨äº¤å‰éªŒè¯æ³•åœ¨å­æ ‘åºåˆ— $T_{0}, T_{1}, \cdots, T_{n}$ ä¸­é€‰å–æœ€ä¼˜å­æ ‘ $T_{\alpha} \circ$</p>
<h1 id="6-ä»£ç å®ç°"><a href="#6-ä»£ç å®ç°" class="headerlink" title="6. ä»£ç å®ç°"></a>6. ä»£ç å®ç°</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»éªŒç†µ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">entropy</span>(<span class="params">datasets</span>):</span></span><br><span class="line">    data_length = <span class="built_in">len</span>(datasets)</span><br><span class="line">    label_count = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data_length):</span><br><span class="line">        label = datasets[i][-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> label <span class="keyword">not</span> <span class="keyword">in</span> label_count:</span><br><span class="line">            label_count[label] = <span class="number">0</span></span><br><span class="line">        label_count[label] += <span class="number">1</span></span><br><span class="line">    entropy = - <span class="built_in">sum</span>([(p / data_length) * log(p / data_length, <span class="number">2</span>)</span><br><span class="line">                    <span class="keyword">for</span> p <span class="keyword">in</span> label_count.values()])</span><br><span class="line">    <span class="keyword">return</span> entropy</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¡ä»¶ç»éªŒç†µ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cond_entropy</span>(<span class="params">datasets, axis=<span class="number">0</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ±‚æ•°æ®é›†datasetsä¸­ç¬¬axisåˆ—çš„æ¡ä»¶ç»éªŒç†µ</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    data_length = <span class="built_in">len</span>(datasets)</span><br><span class="line">    feature_sets = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data_length):</span><br><span class="line">        feature = datasets[i][axis]</span><br><span class="line">        <span class="keyword">if</span> feature <span class="keyword">not</span> <span class="keyword">in</span> feature_sets:</span><br><span class="line">            feature_sets[feature] = []</span><br><span class="line">        feature_sets[feature].append(datasets[i])</span><br><span class="line">    cond_entropy = <span class="built_in">sum</span>([(<span class="built_in">len</span>(p) / data_length) * entropy(p)</span><br><span class="line">                        <span class="keyword">for</span> p <span class="keyword">in</span> feature_sets.values()])</span><br><span class="line">    <span class="keyword">return</span> cond_entropy</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿¡æ¯å¢ç›Š = ç»éªŒç†µ - æ¡ä»¶ç»éªŒç†µ</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">info_gain</span>(<span class="params">entropy, cond_entropy</span>):</span></span><br><span class="line">    <span class="keyword">return</span> entropy - cond_entropy</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨ä¿¡æ¯å¢ç›Šé€‰æ‹©æ ¹èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">info_gain_train</span>(<span class="params">datasets</span>):</span></span><br><span class="line">    data_dim = <span class="built_in">len</span>(datasets[<span class="number">0</span>]) - <span class="number">1</span></span><br><span class="line">    ent = entropy(datasets)</span><br><span class="line">    info_gain_feature = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data_dim):</span><br><span class="line">        i_info_gain = info_gain(ent, cond_entropy(datasets, axis=i))</span><br><span class="line">        info_gain_feature.append(i_info_gain)</span><br><span class="line">        print(<span class="string">&#x27;ç‰¹å¾&#123;&#125;çš„ä¿¡æ¯å¢ç›Šä¸ºï¼š&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(i + <span class="number">1</span>, i_info_gain))</span><br><span class="line">    best_feature = <span class="built_in">max</span>(info_gain_feature)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;ç‰¹å¾&#123;&#125;çš„ä¿¡æ¯å¢ç›Šæœ€å¤§ï¼Œé€‰æ‹©æ ¹èŠ‚ç‚¹ç‰¹å¾&#x27;</span>.<span class="built_in">format</span>(info_gain_feature.index(best_feature) + <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">datasets = [[<span class="string">&#x27;é’å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;ä¸€èˆ¬&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;é’å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¥½&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;é’å¹´&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¥½&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;é’å¹´&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;ä¸€èˆ¬&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;é’å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;ä¸€èˆ¬&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;ä¸­å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;ä¸€èˆ¬&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;ä¸­å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¥½&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;ä¸­å¹´&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;å¥½&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;ä¸­å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;éå¸¸å¥½&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;ä¸­å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;éå¸¸å¥½&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;è€å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;éå¸¸å¥½&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;è€å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;å¥½&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;è€å¹´&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¥½&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;è€å¹´&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;éå¸¸å¥½&#x27;</span>, <span class="string">&#x27;æ˜¯&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;è€å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;ä¸€èˆ¬&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>],</span><br><span class="line">               ]</span><br><span class="line">labels = [<span class="string">u&#x27;å¹´é¾„&#x27;</span>, <span class="string">u&#x27;æœ‰å·¥ä½œ&#x27;</span>, <span class="string">u&#x27;æœ‰è‡ªå·±çš„æˆ¿å­&#x27;</span>, <span class="string">u&#x27;ä¿¡è´·æƒ…å†µ&#x27;</span>, <span class="string">u&#x27;ç±»åˆ«&#x27;</span>]</span><br><span class="line">train_data = pd.DataFrame(datasets, columns=labels)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">info_gain_train(np.array(datasets))</span><br></pre></td></tr></table></figure>
<p><strong>ID3ç®—æ³•</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰èŠ‚ç‚¹ç±» äºŒå‰æ ‘</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, root=<span class="literal">True</span>, label=<span class="literal">None</span>, feature_name=<span class="literal">None</span>, feature=<span class="literal">None</span></span>):</span></span><br><span class="line">        self.root = root</span><br><span class="line">        self.label = label</span><br><span class="line">        self.feature_name = feature_name</span><br><span class="line">        self.feature = feature</span><br><span class="line">        self.tree = &#123;&#125;</span><br><span class="line">        self.result = &#123;</span><br><span class="line">            <span class="string">&#x27;label:&#x27;</span>: self.label,</span><br><span class="line">            <span class="string">&#x27;feature_name&#x27;</span>: self.feature_name,</span><br><span class="line">            <span class="string">&#x27;tree&#x27;</span>: self.tree</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(self.result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_node</span>(<span class="params">self, val, node</span>):</span></span><br><span class="line">        self.tree[val] = node</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">self, features</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.root <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">return</span> self.label</span><br><span class="line">        <span class="keyword">return</span> self.tree[features[self.feature]].predict(features)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DTree</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, epsilon=<span class="number">0.1</span></span>):</span></span><br><span class="line">        self.epsilon = epsilon</span><br><span class="line">        self._tree = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç†µ</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">calc_ent</span>(<span class="params">datasets</span>):</span></span><br><span class="line">        data_length = <span class="built_in">len</span>(datasets)</span><br><span class="line">        label_count = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data_length):</span><br><span class="line">            label = datasets[i][-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> label <span class="keyword">not</span> <span class="keyword">in</span> label_count:</span><br><span class="line">                label_count[label] = <span class="number">0</span></span><br><span class="line">            label_count[label] += <span class="number">1</span></span><br><span class="line">        ent = -<span class="built_in">sum</span>([(p / data_length) * log(p / data_length, <span class="number">2</span>)</span><br><span class="line">                    <span class="keyword">for</span> p <span class="keyword">in</span> label_count.values()])</span><br><span class="line">        <span class="keyword">return</span> ent</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç»éªŒæ¡ä»¶ç†µ</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cond_ent</span>(<span class="params">self, datasets, axis=<span class="number">0</span></span>):</span></span><br><span class="line">        data_length = <span class="built_in">len</span>(datasets)</span><br><span class="line">        feature_sets = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data_length):</span><br><span class="line">            feature = datasets[i][axis]</span><br><span class="line">            <span class="keyword">if</span> feature <span class="keyword">not</span> <span class="keyword">in</span> feature_sets:</span><br><span class="line">                feature_sets[feature] = []</span><br><span class="line">            feature_sets[feature].append(datasets[i])</span><br><span class="line">        cond_ent = <span class="built_in">sum</span>([(<span class="built_in">len</span>(p) / data_length) * self.calc_ent(p)</span><br><span class="line">                        <span class="keyword">for</span> p <span class="keyword">in</span> feature_sets.values()])</span><br><span class="line">        <span class="keyword">return</span> cond_ent</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿¡æ¯å¢ç›Š</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">info_gain</span>(<span class="params">ent, cond_ent</span>):</span></span><br><span class="line">        <span class="keyword">return</span> ent - cond_ent</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">info_gain_train</span>(<span class="params">self, datasets</span>):</span></span><br><span class="line">        count = <span class="built_in">len</span>(datasets[<span class="number">0</span>]) - <span class="number">1</span></span><br><span class="line">        ent = self.calc_ent(datasets)</span><br><span class="line">        best_feature = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">            c_info_gain = self.info_gain(ent, self.cond_ent(datasets, axis=c))</span><br><span class="line">            best_feature.append((c, c_info_gain))</span><br><span class="line">        <span class="comment"># æ¯”è¾ƒå¤§å°</span></span><br><span class="line">        best_ = <span class="built_in">max</span>(best_feature, key=<span class="keyword">lambda</span> x: x[-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> best_</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">train</span>(<span class="params">self, train_data</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        input:æ•°æ®é›†D(DataFrameæ ¼å¼)ï¼Œç‰¹å¾é›†Aï¼Œé˜ˆå€¼eta</span></span><br><span class="line"><span class="string">        output:å†³ç­–æ ‘T</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        _, y_train, features = train_data.iloc[:, :</span><br><span class="line">                                               -<span class="number">1</span>], train_data.iloc[:,</span><br><span class="line">                                                                    -<span class="number">1</span>], train_data.columns[:</span><br><span class="line">                                                                                            -<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 1,è‹¥Dä¸­å®ä¾‹å±äºåŒä¸€ç±»Ckï¼Œåˆ™Tä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå¹¶å°†ç±»Ckä½œä¸ºç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å›T</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(y_train.value_counts()) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> Node(root=<span class="literal">True</span>, label=y_train.iloc[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2, è‹¥Aä¸ºç©ºï¼Œåˆ™Tä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå°†Dä¸­å®ä¾‹æ ‘æœ€å¤§çš„ç±»Ckä½œä¸ºè¯¥èŠ‚ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å›T</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(features) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> Node(</span><br><span class="line">                root=<span class="literal">True</span>,</span><br><span class="line">                label=y_train.value_counts().sort_values(</span><br><span class="line">                    ascending=<span class="literal">False</span>).index[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3,è®¡ç®—æœ€å¤§ä¿¡æ¯å¢ç›Š åŒ5.1,Agä¸ºä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾</span></span><br><span class="line">        max_feature, max_info_gain = self.info_gain_train(np.array(train_data))</span><br><span class="line">        max_feature_name = features[max_feature]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4,Agçš„ä¿¡æ¯å¢ç›Šå°äºé˜ˆå€¼eta,åˆ™ç½®Tä¸ºå•èŠ‚ç‚¹æ ‘ï¼Œå¹¶å°†Dä¸­æ˜¯å®ä¾‹æ•°æœ€å¤§çš„ç±»Ckä½œä¸ºè¯¥èŠ‚ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å›T</span></span><br><span class="line">        <span class="keyword">if</span> max_info_gain &lt; self.epsilon:</span><br><span class="line">            <span class="keyword">return</span> Node(</span><br><span class="line">                root=<span class="literal">True</span>,</span><br><span class="line">                label=y_train.value_counts().sort_values(</span><br><span class="line">                    ascending=<span class="literal">False</span>).index[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5,æ„å»ºAgå­é›†</span></span><br><span class="line">        node_tree = Node(</span><br><span class="line">            root=<span class="literal">False</span>, feature_name=max_feature_name, feature=max_feature)</span><br><span class="line"></span><br><span class="line">        feature_list = train_data[max_feature_name].value_counts().index</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> feature_list:</span><br><span class="line">            sub_train_df = train_data.loc[train_data[max_feature_name] ==</span><br><span class="line">                                          f].drop([max_feature_name], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 6, é€’å½’ç”Ÿæˆæ ‘</span></span><br><span class="line">            sub_tree = self.train(sub_train_df)</span><br><span class="line">            node_tree.add_node(f, sub_tree)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># pprint.pprint(node_tree.tree)</span></span><br><span class="line">        <span class="keyword">return</span> node_tree</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span>(<span class="params">self, train_data</span>):</span></span><br><span class="line">        self._tree = self.train(train_data)</span><br><span class="line">        <span class="keyword">return</span> self._tree</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">self, X_test</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._tree.predict(X_test)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">datasets, labels = create_data()</span><br><span class="line">data_df = pd.DataFrame(datasets, columns=labels)</span><br><span class="line">dt = DTree()</span><br><span class="line">tree = dt.fit(data_df)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tree</span><br><span class="line"><span class="comment"># &#123;&#x27;label:&#x27;: None, &#x27;feature_name&#x27;: &#x27;æœ‰è‡ªå·±çš„æˆ¿å­&#x27;, &#x27;tree&#x27;: &#123;&#x27;å¦&#x27;: &#123;&#x27;label:&#x27;: None, &#x27;feature_name&#x27;: &#x27;æœ‰å·¥ä½œ&#x27;, &#x27;tree&#x27;: &#123;&#x27;å¦&#x27;: &#123;&#x27;label:&#x27;: &#x27;å¦&#x27;, &#x27;feature_name&#x27;: None, &#x27;tree&#x27;: &#123;&#125;&#125;, &#x27;æ˜¯&#x27;: &#123;&#x27;label:&#x27;: &#x27;æ˜¯&#x27;, &#x27;feature_name&#x27;: None, &#x27;tree&#x27;: &#123;&#125;&#125;&#125;&#125;, &#x27;æ˜¯&#x27;: &#123;&#x27;label:&#x27;: &#x27;æ˜¯&#x27;, &#x27;feature_name&#x27;: None, &#x27;tree&#x27;: &#123;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dt.predict([<span class="string">&#x27;è€å¹´&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;å¦&#x27;</span>, <span class="string">&#x27;ä¸€èˆ¬&#x27;</span>])</span><br><span class="line"><span class="comment"># &#x27;å¦&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>scikit-learnå®ä¾‹</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## sklearné‡Œå¹¶æ²¡æœ‰å®ç°åå‰ªæï¼Œåªæœ‰é¢„å‰ªææ“ä½œï¼Œä¾‹å¦‚è®¾ç½®æ ‘çš„æœ€å¤§æ·±åº¦max_depth</span></span><br><span class="line"></span><br><span class="line">iris = load_iris()</span><br><span class="line">df = pd.DataFrame(iris.data, columns=iris.feature_names)</span><br><span class="line">df[<span class="string">&#x27;label&#x27;</span>] = iris.target</span><br><span class="line">df.columns = [</span><br><span class="line">    <span class="string">&#x27;sepal length&#x27;</span>, <span class="string">&#x27;sepal width&#x27;</span>, <span class="string">&#x27;petal lenght&#x27;</span>, <span class="string">&#x27;petal width&#x27;</span>, <span class="string">&#x27;label&#x27;</span></span><br><span class="line">]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shuffle</span>(<span class="params">X,Y</span>):</span></span><br><span class="line">    randomize = np.arange(<span class="built_in">len</span>(X))</span><br><span class="line">    np.random.shuffle(randomize)</span><br><span class="line">    <span class="keyword">return</span> X[randomize], Y[randomize]</span><br><span class="line"></span><br><span class="line">data = np.array(df)</span><br><span class="line">X, Y = data[:, :<span class="number">2</span>], data[:,-<span class="number">1</span>]</span><br><span class="line">X, y = shuffle(X,Y)</span><br><span class="line">X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = <span class="number">0.3</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line">clf = DecisionTreeClassifier()</span><br><span class="line">clf.fit(X_train, Y_train)</span><br><span class="line">clf.score(X_test,Y_test)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line"><span class="keyword">import</span> graphviz</span><br><span class="line"></span><br><span class="line">features = [<span class="string">&quot;å¹´é¾„&quot;</span>, <span class="string">&quot;æœ‰å·¥ä½œ&quot;</span>, <span class="string">&quot;æœ‰è‡ªå·±çš„æˆ¿å­&quot;</span>, <span class="string">&quot;ä¿¡è´·æƒ…å†µ&quot;</span>]</span><br><span class="line">X_train = pd.DataFrame([</span><br><span class="line">    [<span class="string">&quot;é’å¹´&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;ä¸€èˆ¬&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;é’å¹´&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¥½&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;é’å¹´&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¥½&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;é’å¹´&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;ä¸€èˆ¬&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;é’å¹´&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;ä¸€èˆ¬&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;ä¸­å¹´&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;ä¸€èˆ¬&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;ä¸­å¹´&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¥½&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;ä¸­å¹´&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;å¥½&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;ä¸­å¹´&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;éå¸¸å¥½&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;ä¸­å¹´&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;éå¸¸å¥½&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;è€å¹´&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;éå¸¸å¥½&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;è€å¹´&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;å¥½&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;è€å¹´&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¥½&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;è€å¹´&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;éå¸¸å¥½&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;è€å¹´&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;ä¸€èˆ¬&quot;</span>]</span><br><span class="line">])</span><br><span class="line">y_train = pd.DataFrame([<span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;å¦&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;å¦&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;æ˜¯&quot;</span>, <span class="string">&quot;å¦&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ•°æ®é¢„å¤„ç†</span></span><br><span class="line">le_x = preprocessing.LabelEncoder()</span><br><span class="line">le_x.fit(np.unique(X_train)) <span class="comment"># æ‰¾å‡ºX_tranä¸­çš„ç‰¹å¾å€¼æœ‰å“ªäº›</span></span><br><span class="line"><span class="comment"># array([&#x27;ä¸€èˆ¬&#x27;, &#x27;ä¸­å¹´&#x27;, &#x27;å¦&#x27;, &#x27;å¥½&#x27;, &#x27;æ˜¯&#x27;, &#x27;è€å¹´&#x27;, &#x27;é’å¹´&#x27;, &#x27;éå¸¸å¥½&#x27;], dtype=object)</span></span><br><span class="line"><span class="comment"># è¿™æ · 0ä»£è¡¨â€˜ä¸€èˆ¬â€™ï¼Œ1ä»£è¡¨â€˜ä¸­å¹´â€™ï¼Œ....</span></span><br><span class="line">X_train = X_train.apply(le_x.transform) <span class="comment"># apply()å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°</span></span><br><span class="line">le_y = preprocessing.LabelEncoder()</span><br><span class="line">le_y.fit(np.unique(y_train))</span><br><span class="line">y_train = y_train.apply(le_y.transform)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨sklearn.DTè®­ç»ƒæ¨¡å‹</span></span><br><span class="line">model_tree = DecisionTreeClassifier()</span><br><span class="line">model_tree.fit(X_train, y_train)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>[1]. <a target="_blank" rel="noopener" href="https://github.com/fengdu78/lihang-code/tree/master/%E7%AC%AC05%E7%AB%A0%20%E5%86%B3%E7%AD%96%E6%A0%91">https://github.com/fengdu78/lihang-code/</a></p>
<p>[2]. ã€Šç»Ÿè®¡å­¦ä¹ ä¸æ–¹æ³•ã€‹ â€“ æèˆª</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/15/Naive-Bayes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/15/Naive-Bayes/" class="post-title-link" itemprop="url">Naive Bayes</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-03-15 16:47:59 / ä¿®æ”¹æ—¶é—´ï¼š17:29:20" itemprop="dateCreated datePublished" datetime="2021-03-15T16:47:59+08:00">2021-03-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ç”Ÿæˆæ¨¡å‹</p>
<p>å¯¹äºç»™å®šæ•°æ®é›†ï¼Œé¦–å…ˆåŸºäº<strong>ç‰¹å¾æ¡ä»¶ç‹¬ç«‹</strong>å‡è®¾å­¦ä¹ è¾“å…¥è¾“å‡ºçš„è”åˆæ¦‚ç‡åˆ†å¸ƒï¼› ç„¶ååŸºäºæ­¤æ¨¡å‹ï¼Œ å¯¹ç»™å®šçš„è¾“å…¥ $x$ï¼Œ åˆ©ç”¨è´å¶æ–¯å®šç†æ±‚å‡ºåéªŒæ¦‚ç‡æœ€å¤§çš„è¾“å‡º $y$ã€‚ æœ´ç´ è´å¶æ–¯æ³•å®ç°ç®€å•ï¼Œ å­¦ä¹ ä¸é¢„æµ‹çš„æ•ˆç‡éƒ½å¾ˆé«˜ï¼Œ æ˜¯ä¸€ç§å¸¸ç”¨çš„æ–¹æ³•ã€‚</p>
<h1 id="1-å­¦ä¹ ä¸åˆ†ç±»"><a href="#1-å­¦ä¹ ä¸åˆ†ç±»" class="headerlink" title="1. å­¦ä¹ ä¸åˆ†ç±»"></a>1. å­¦ä¹ ä¸åˆ†ç±»</h1><ul>
<li>é¦–å…ˆå­¦ä¹ å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒä»¥åŠæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒã€‚</li>
</ul>
<p>$$<br>P(Y=c_k),\quad k=1,2,â€¦k<br>$$</p>
<p>$$<br>P(X=x \mid Y=c_{k})=P(X^{(1)}=x^{(1)}, \cdots, X^{(n)}=x^{(n)} \mid Y=c_{k}), \quad k=1,2, \cdots, K<br>$$</p>
<p>äºæ˜¯å­¦åˆ°è”åˆæ¦‚ç‡åˆ†å¸ƒ $P(X,Y)$</p>
<p>ç”±äºæœ´ç´ è´å¶æ–¯å‡è®¾æ¡ä»¶ç‹¬ç«‹ï¼Œäºæ˜¯æ¡ä»¶æ¦‚ç‡ä¸º<br>$$<br>\begin{aligned}<br>P(X=x \mid Y=c_{k}) &amp;=P(X^{(1)}=x^{(1)}, \cdots, X^{(n)}=x^{(n)} \mid Y=c_{k}) \\<br>&amp;=\prod_{j=1}^{n} P(X^{(j)}=x^{(j)} \mid Y=c_{k})<br>\end{aligned}<br>$$</p>
<ul>
<li><p><strong>å‚æ•°å­¦ä¹ (æå¤§ä¼¼ç„¶)</strong><br>$$<br>P\left(Y=c_{k}\right)=\frac{\sum_{i=1}^{N} I\left(y_{i}=c_{k}\right)}{N}, \quad k=1,2, \cdots, K<br>$$</p>
<p>$$<br>\begin{array}{l}<br>P\left(X^{(j)}=a_{j l} \mid Y=c_{k}\right)=\frac{\sum_{i=1}^{N} I\left(x_{i}^{(j)}=a_{j l}, y_{i}=c_{k}\right)}{\sum_{i=1}^{N} I\left(y_{i}=c_{k}\right)} \\<br>j=1,2, \cdots, n ; \quad l=1,2, \cdots, S_{j} ; \quad k=1,2, \cdots, K<br>\end{array}<br>$$</p>
</li>
<li><p><strong>åˆ†ç±»å™¨</strong></p>
</li>
</ul>
<p>$$<br>y=f(x)=\arg \max_{c_{k}} \frac{P\left(Y=c_{k}\right) \prod_{j} P\left(X^{(j)}=x^{(j)} \mid Y=c_{k}\right)}{\sum_{k} P\left(Y=c_{k}\right) \prod_{j} P\left(X^{(j)}=x^{(j)} \mid Y=c_{k}\right)}<br>$$</p>
<h1 id="2-åŸç†-åéªŒæ¦‚ç‡æœ€å¤§åŒ–-æœŸæœ›é£é™©æœ€å°åŒ–"><a href="#2-åŸç†-åéªŒæ¦‚ç‡æœ€å¤§åŒ–-æœŸæœ›é£é™©æœ€å°åŒ–" class="headerlink" title="2. åŸç†(åéªŒæ¦‚ç‡æœ€å¤§åŒ– == æœŸæœ›é£é™©æœ€å°åŒ–)"></a>2. åŸç†(åéªŒæ¦‚ç‡æœ€å¤§åŒ– == æœŸæœ›é£é™©æœ€å°åŒ–)</h1><p>å‡è®¾é€‰æ‹©0-1æŸå¤±å‡½æ•°<br>$$<br>L(Y,f(X)) = \begin{cases}<br>1, &amp; Y \neq f(X) \\<br>0, &amp; Y = f(X)<br>\end{cases}<br>$$<br>æœŸæœ›é£é™©å‡½æ•°ä¸º<br>$$<br>R_{\exp }(f)=E[L(Y, f(X))]<br>$$<br>æœŸæœ›æ˜¯å¯¹è”åˆåˆ†å¸ƒ $P(X,Y)$å–çš„ï¼Œç”±æ­¤æ¡ä»¶æœŸæœ›<br>$$<br>R_{\exp }(f)=E_{X} \sum_{k=1}^{K}\left[L\left(c_{k}, f(X)\right)\right] P\left(c_{k} \mid X\right)<br>$$<br>ä¸ºäº†ä½¿æœŸæœ›é£é™©æœ€å°åŒ–ï¼Œåªéœ€å¯¹ $X=x$ é€ä¸ªæå°åŒ–ï¼Œ<br>$$<br>\begin{aligned}<br>f(x) &amp;=\arg \min_{y \in \mathcal{Y}} \sum_{k=1}^{K} L\left(c_{k}, y\right) P\left(c_{k} \mid X=x\right) \\<br>&amp;=\arg \min_{y \in \mathcal{Y}} \sum_{k=1}^{K} P\left(y \neq c_{k} \mid X=x\right) \\<br>&amp;=\arg \min_{y \in \mathcal{Y}}\left(1-P\left(y=c_{k} \mid X=x\right)\right) \\<br>&amp;=\arg \max_{y \in \mathcal{Y}} P\left(y=c_{k} \mid X=x\right)<br>\end{aligned}<br>$$</p>
<h1 id="3-è´å¶æ–¯ä¼°è®¡-æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘"><a href="#3-è´å¶æ–¯ä¼°è®¡-æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘" class="headerlink" title="3. è´å¶æ–¯ä¼°è®¡(æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘)"></a>3. è´å¶æ–¯ä¼°è®¡(æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘)</h1><p>ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡å¯èƒ½ä¼šå‡ºç°æ‰€è¦ä¼°è®¡çš„æ¦‚ç‡å€¼ä¸º0çš„æƒ…å†µã€‚ è¿™æ—¶ä¼šå½±å“åˆ°åéªŒæ¦‚ç‡çš„è®¡ç®—ç»“æœï¼Œ ä½¿åˆ†ç±»äº§ç”Ÿåå·®ã€‚ è§£å†³è¿™ä¸€é—®é¢˜çš„æ–¹æ³•æ˜¯é‡‡ç”¨è´å¶æ–¯ä¼°è®¡ã€‚å…·ä½“çš„æ¡ä»¶æ¦‚ç‡çš„è´å¶æ–¯ä¼°è®¡æ˜¯<br>$$<br>P_{\lambda}\left(X^{(j)}=a_{j l} \mid Y=c_{k}\right)=\frac{\sum_{i=1}^{N} I\left(x_{i}^{(j)}=a_{j l}, y_{i}=c_{k}\right)+\lambda}{\sum_{i=1}^{N} I\left(y_{i}=c_{k}\right)+S_{j} \lambda}<br>$$<br>$l=1,2,\cdots,S_j,k=1,2,â€¦,K$ ï¼Œ$\lambda \geq 0$ï¼Œç­‰ä»·äºåœ¨éšæœºå˜é‡å„ä¸ªå–å€¼ä¸Šèµ‹äºˆä¸€ä¸ªæ­£æ•°ã€‚$\lambda = 0$ æ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚å¸¸å– $\lambda = 1$ï¼Œç§°ä¸ºæ‹‰æ™®æ‹‰æ–¯å¹³æ»‘ã€‚æ£€éªŒå¯çŸ¥ï¼Œæ¦‚ç‡å’Œä¸º1ï¼Œå¹¶ä¸”æ¯ä¸ªæ¦‚ç‡å¤§äº0</p>
<p>å…ˆéªŒæ¦‚ç‡çš„è´å¶æ–¯ä¼°è®¡æ˜¯<br>$$<br>P_{\lambda}\left(Y=c_{k}\right)=\frac{\sum_{i=1}^{N} I\left(y_{i}=c_{k}\right)+\lambda}{N+K \lambda}<br>$$</p>
<h1 id="4-ä»£ç å®ç°"><a href="#4-ä»£ç å®ç°" class="headerlink" title="4. ä»£ç å®ç°"></a>4. ä»£ç å®ç°</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">import</span> math</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import data</span></span><br><span class="line">iris = load_iris()</span><br><span class="line">df = pd.DataFrame(iris.data, columns=iris.feature_names)</span><br><span class="line">df[<span class="string">&#x27;labels&#x27;</span>] = iris.target</span><br><span class="line">df.columns = [</span><br><span class="line">    <span class="string">&#x27;sepal length&#x27;</span>, <span class="string">&#x27;sepal width&#x27;</span>, <span class="string">&#x27;petal length&#x27;</span>, <span class="string">&#x27;petal width&#x27;</span>, <span class="string">&#x27;label&#x27;</span></span><br><span class="line">]</span><br><span class="line">data = np.array(df)</span><br><span class="line">X, Y = data[:, :-<span class="number">1</span>], data[:, -<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_shuffle</span>(<span class="params">X, Y</span>):</span></span><br><span class="line">    randomize = np.arange(<span class="built_in">len</span>(X))</span><br><span class="line">    np.random.shuffle(randomize)</span><br><span class="line">    <span class="keyword">return</span> X[randomize], Y[randomize]</span><br><span class="line"></span><br><span class="line">X, Y = _shuffle(X,Y)</span><br><span class="line"></span><br><span class="line">X_train, X_test, Y_train, Y_test = train_test_split(X,Y, test_size = <span class="number">0.3</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NaiveBayes</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.model = <span class="literal">None</span></span><br><span class="line">        self.Y_mean = <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®—å‡å€¼</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mean</span>(<span class="params">self, X</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(X) / <span class="built_in">float</span>(<span class="built_in">len</span>(X))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®—æ ‡å‡†å·®</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">std</span>(<span class="params">self, X</span>):</span></span><br><span class="line">        avg = self.mean(X)</span><br><span class="line">        <span class="keyword">return</span> math.sqrt(<span class="built_in">sum</span>([<span class="built_in">pow</span>(x - avg, <span class="number">2</span>) <span class="keyword">for</span> x <span class="keyword">in</span> X]) / <span class="built_in">float</span>(<span class="built_in">len</span>(X)))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ¦‚ç‡å¯†åº¦å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gaussian_probability</span>(<span class="params">self, x, mean, std</span>):</span></span><br><span class="line">        exp = math.exp(-(math.<span class="built_in">pow</span>(x - mean, <span class="number">2</span>) / (<span class="number">2</span> * math.<span class="built_in">pow</span>(std, <span class="number">2</span>))))</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1</span> / (math.sqrt(<span class="number">2</span> * math.pi)) * std) * exp</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®—X_trainçš„mean å’Œstd</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">summarize</span>(<span class="params">self, X_train</span>):</span> <span class="comment">#  *X_train æ˜Ÿå·ä½œç”¨æ˜¯è§£åŒ…ç„¶åé€ä¸ªä¼ å…¥ </span></span><br><span class="line">        summaries = [(self.mean(i), self.std(i)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">zip</span>(*X_train)] <span class="comment"># æ‰€ä»¥zip(*X_train) == zip([1,2,3],[2,3,4],...)</span></span><br><span class="line">        <span class="keyword">return</span> summaries</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span>(<span class="params">self, X, Y</span>):</span></span><br><span class="line">        labels = <span class="built_in">list</span>(<span class="built_in">set</span>(Y))</span><br><span class="line">        data = &#123;label: [] <span class="keyword">for</span> label <span class="keyword">in</span> labels&#125; <span class="comment"># åˆå§‹åŒ–</span></span><br><span class="line">        self.Y_mean = np.zeros(<span class="built_in">len</span>(labels))</span><br><span class="line">        <span class="keyword">for</span> x, label <span class="keyword">in</span> <span class="built_in">zip</span>(X, Y):</span><br><span class="line">            data[label].append(x)</span><br><span class="line">            self.Y_mean[<span class="built_in">int</span>(label)] += <span class="number">1.</span></span><br><span class="line">        self.Y_mean /= <span class="built_in">len</span>(Y)</span><br><span class="line">        <span class="comment"># è®¡ç®—P(x_i|y_k) for i in range...</span></span><br><span class="line">        self.model = &#123;</span><br><span class="line">            label:self.summarize(value)</span><br><span class="line">            <span class="keyword">for</span> label, value <span class="keyword">in</span> data.items()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;gaussianNB train done&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">calculate_probabilities</span>(<span class="params">self, input_data</span>):</span></span><br><span class="line">        <span class="comment"># summaries: &#123;0: [(mean1,std1),(mean2,std2),(mean3,std3),(mean4,std4)], 1:...&#125;</span></span><br><span class="line">        probabilities = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> label, value <span class="keyword">in</span> self.model.items(): <span class="comment"># value --&gt; summaries</span></span><br><span class="line">            probabilities[label] = self.Y_mean[<span class="built_in">int</span>(label)] <span class="comment"># P(C_i)</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(value)):</span><br><span class="line">                mean, std = value[i]</span><br><span class="line">                probabilities[label] *= self.gaussian_probability(input_data[i], mean, std)</span><br><span class="line">                <span class="comment"># è®¡ç®—P(x|c_i) * P(C_i)çš„æ¦‚ç‡</span></span><br><span class="line">        <span class="keyword">return</span> probabilities</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">self, X_test</span>):</span> </span><br><span class="line">        <span class="comment"># è¿™é‡ŒX_testä¸ºå•ä¸ªå®ä¾‹</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X_test)):</span><br><span class="line">            label = <span class="built_in">sorted</span>(self.calculate_probabilities(X_test[i]).items(), key=<span class="keyword">lambda</span> x:x[-<span class="number">1</span>])[-<span class="number">1</span>][<span class="number">0</span>]  <span class="comment"># sorted é»˜è®¤ä»å°åˆ°å¤§ è¿”å›ä¸€ä¸ªlist</span></span><br><span class="line">            <span class="comment"># å¦‚[(1, 75), (0, 85), (2, 95)]</span></span><br><span class="line">            result.append(label)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self, X_test, Y_test</span>):</span></span><br><span class="line">        right = <span class="number">0</span></span><br><span class="line">        predictions = self.predict(X_test)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Y_test)):</span><br><span class="line">            <span class="keyword">if</span> predictions[i] == Y_test[i]:</span><br><span class="line">                right += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> right / <span class="built_in">float</span>(<span class="built_in">len</span>(Y_test))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model = NaiveBayes()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">model.fit(X_train, Y_train)</span><br><span class="line"><span class="comment"># &#x27;gaussianNB train done&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result1 = model.predict(X_test)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.score(X_test, Y_test)</span><br></pre></td></tr></table></figure>
<p><strong>scikit-learn å®ä¾‹</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> GaussianNB</span><br><span class="line">clf = GaussianNB()</span><br><span class="line"><span class="comment">#X = np.array([[-1, -1], [-2, -1], [-3, -2], [1, 1], [2, 1], [3, 2]])</span></span><br><span class="line"><span class="comment">#Y = np.array([1, 1, 1, 2, 2, 2])</span></span><br><span class="line">clf.fit(X_train, Y_train)</span><br><span class="line">result2 = clf.predict(X_test)</span><br><span class="line">clf.score(X_test, Y_test)</span><br></pre></td></tr></table></figure>
<h1 id="Referenceï¼š"><a href="#Referenceï¼š" class="headerlink" title="Referenceï¼š"></a>Referenceï¼š</h1><p>[1]. <a target="_blank" rel="noopener" href="https://github.com/fengdu78/lihang-code/blob/master/%E7%AC%AC04%E7%AB%A0%20%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/4.NaiveBayes.ipynb">https://github.com/fengdu78/lihang-code</a></p>
<p>[2]. ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ â€“ æèˆª</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/14/K-NN/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/14/K-NN/" class="post-title-link" itemprop="url">K-nearest neighbor(K-NN)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-03-14 19:23:56" itemprop="dateCreated datePublished" datetime="2021-03-14T19:23:56+08:00">2021-03-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-03-15 17:29:49" itemprop="dateModified" datetime="2021-03-15T17:29:49+08:00">2021-03-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>åŸºæœ¬çš„åˆ†ç±»å’Œå›å½’æ–¹æ³•</p>
<p>ç»™å®šä¸€ä¸ªè®­ç»ƒæ•°æ®é›†ï¼Œ å¯¹æ–°çš„è¾“å…¥å®ä¾‹ï¼Œ åœ¨è®­ç»ƒæ•°æ®é›†ä¸­æ‰¾åˆ°ä¸è¯¥å®ä¾‹æœ€é‚»è¿‘çš„kä¸ªå®ä¾‹ï¼Œ è¿™kä¸ªå®ä¾‹çš„å¤šæ•°å±äºæŸä¸ªç±»ï¼Œ å°±æŠŠè¯¥è¾“å…¥å®ä¾‹åˆ†ä¸ºè¿™ä¸ªç±»ã€‚ </p>
<h1 id="1-k-è¿‘é‚»æ¨¡å‹"><a href="#1-k-è¿‘é‚»æ¨¡å‹" class="headerlink" title="1. k è¿‘é‚»æ¨¡å‹"></a>1. k è¿‘é‚»æ¨¡å‹</h1><p>ä¸‰ä¸ªåŸºæœ¬è¦ç´ ï¼šè·ç¦»åº¦é‡ï¼Œkå€¼é€‰æ‹©ã€åˆ†ç±»å†³ç­–è§„åˆ™</p>
<h2 id="1-1-è·ç¦»åº¦é‡"><a href="#1-1-è·ç¦»åº¦é‡" class="headerlink" title="1.1 è·ç¦»åº¦é‡"></a>1.1 è·ç¦»åº¦é‡</h2><p>$x_{i}=\left(x_{i}^{(1)}, x_{i}^{(2)}, \cdots, x_{i}^{(n)}\right)^{\mathrm{T}}$ $L_{p}$ è·ç¦»ï¼š<br>$$<br>L_{p}\left(x_{i}, x_{j}\right)=\left(\sum_{l=1}^{n}\left|x_{i}^{(l)}-x_{j}^{(l)}\right|^{p}\right)^{\frac{1}{p}}<br>$$<br>å½“ $p=2$ ä¸º<strong>æ¬§å¼è·ç¦»</strong>ï¼ˆå¸¸ç”¨ï¼‰</p>
<p>å½“ $p=1 $ ä¸ºæ›¼å“ˆé¡¿è·ç¦»</p>
<p>å½“ $p=\infty$ æ—¶ï¼Œæ˜¯å„ä¸ªåæ ‡è·ç¦»çš„æœ€å¤§å€¼<br>$$<br>L_{\infty}(x_{i}, x_{j})=\max_{l}\left|x_{i}^{(l)}-x_{j}^{(l)}\right|<br>$$</p>
<h2 id="1-2-kå€¼é€‰æ‹©"><a href="#1-2-kå€¼é€‰æ‹©" class="headerlink" title="1.2 kå€¼é€‰æ‹©"></a>1.2 kå€¼é€‰æ‹©</h2><p>kå€¼é€‰æ‹©è¾ƒå°æ—¶ï¼Œè¿‘ä¼¼è¯¯å·®å°ï¼Œä¼°è®¡è¯¯å·®å¤§ï¼Œè¿‡æ‹Ÿåˆ</p>
<p>kå€¼é€‰æ‹©è¾ƒå¤§æ—¶ï¼Œè¿‘ä¼¼è¯¯å·®å¤§ï¼Œå¯ä»¥å‡å°‘ä¼°è®¡è¯¯å·®</p>
<p><strong>Trick:</strong>  kå€¼ä¸€èˆ¬å–ä¸€ä¸ªæ¯”è¾ƒå°çš„æ•°å€¼ã€‚ é€šå¸¸é‡‡ç”¨äº¤å‰éªŒè¯æ³•æ¥é€‰å–æœ€ä¼˜çš„kå€¼</p>
<h2 id="1-3-åˆ†ç±»å†³ç­–è§„åˆ™"><a href="#1-3-åˆ†ç±»å†³ç­–è§„åˆ™" class="headerlink" title="1.3 åˆ†ç±»å†³ç­–è§„åˆ™"></a>1.3 åˆ†ç±»å†³ç­–è§„åˆ™</h2><p>å¾€å¾€æ˜¯<strong>å¤šæ•°è¡¨å†³</strong>ï¼šç”±è¾“å…¥å®ä¾‹çš„kä¸ªé‚»è¿‘çš„è®­ç»ƒå®ä¾‹ä¸­çš„å¤šæ•°ç±»å†³å®šè¾“å…¥å®ä¾‹çš„ç±»</p>
<p>è¯¯åˆ†ç±»ç‡ï¼š<br>$$<br>\frac{1}{k} \sum_{x_{i} \in N_{k}(x)} I\left(y_{i} \neq c_{j}\right)=1-\frac{1}{k} \sum_{x_{i} \in N_{k}(x)} I\left(y_{i}=c_{j}\right)<br>$$</p>
<h1 id="2-æ¨¡å‹å®ç°ï¼škdæ ‘"><a href="#2-æ¨¡å‹å®ç°ï¼škdæ ‘" class="headerlink" title="2. æ¨¡å‹å®ç°ï¼škdæ ‘"></a>2. æ¨¡å‹å®ç°ï¼škdæ ‘</h1><p>å®ç°kè¿‘é‚»æ³•æ—¶ï¼Œ ä¸»è¦è€ƒè™‘çš„é—®é¢˜æ˜¯å¦‚ä½•å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œå¿«é€Ÿkè¿‘é‚»æœç´¢ã€‚ è¿™ç‚¹åœ¨ç‰¹å¾ç©ºé—´çš„ç»´æ•°å¤§åŠè®­ç»ƒæ•°æ®å®¹é‡å¤§æ—¶å°¤å…¶å¿…è¦</p>
<p>çº¿æ€§æ‰«æä¸å¯å–ï¼Œå› ä¸ºéå†æ‰€æœ‰çš„æ•°æ®è®¡ç®—é‡å¤ªå¤§</p>
<p><strong>è§£å†³æ–¹æ³•ï¼škdæ ‘ï¼ˆkd treeï¼‰</strong></p>
<p>kdæ ‘æ˜¯äºŒå‰æ ‘ï¼Œ å¹³è¡¡çš„kdæ ‘æœç´¢æ—¶çš„æ•ˆç‡æœªå¿…æ˜¯æœ€ä¼˜çš„</p>
<p>ç®—æ³• 3.2 (æ„é€ å¹³è¡¡ $k d$ æ ‘ï¼‰</p>
<p>è¾“å…¥: $k$ ç»´ç©ºé—´æ•°æ®é›† $T=  \lbrace x_{1}, x_{2}, \cdots, x_{N} \rbrace$ï¼Œå…¶ä¸­ $x_{i}=\left(x_{i}^{(1)}, x_{i}^{(2)}, \cdots, x_{i}^{(k)}\right)^{\mathrm{T}}$ï¼Œ$i=1,2, \cdots, N$<br>è¾“å‡º: $k d$ æ ‘ã€‚<br>       (1) å¼€å§‹: æ„é€ æ ¹ç»“ç‚¹ï¼Œæ ¹ç»“ç‚¹å¯¹åº”äºåŒ…å« $T$ çš„ $k$ ç»´ç©ºé—´çš„è¶…çŸ©å½¢åŒºåŸŸã€‚</p>
<p>â€‹        $x^{(1)}$ ä¸ºåæ ‡è½´ï¼Œä»¥ $T$ ä¸­æ‰€æœ‰å®ä¾‹çš„ $x^{(1)}$ åæ ‡çš„ä¸­ä½æ•°ä¸ºåˆ‡åˆ†ç‚¹ï¼Œå°†æ ¹ç»“ç‚¹é€‰æ‹©å¯¹åº”çš„è¶…çŸ©å½¢åŒºåŸŸåˆ‡åˆ†ä¸ºä¸¤ä¸ªå­åŒºåŸŸã€‚åˆ‡åˆ†ç”±é€šè¿‡åˆ‡åˆ†ç‚¹å¹¶ä¸åæ ‡è½´ $x^{(1)}$ å‚ç›´çš„è¶…å¹³é¢å®ç°ã€‚ </p>
<p>â€‹        ç”±æ ¹ç»“ç‚¹ç”Ÿæˆæ·±åº¦ä¸º 1 çš„å·¦ã€å³å­ç»“ç‚¹: å·¦å­ç»“ç‚¹å¯¹åº”åæ ‡ $x^{(1)}$ å°äºåˆ‡åˆ†ç‚¹çš„å­$x^{(1)}$ å¤§äºåˆ‡åˆ†ç‚¹çš„å­åŒºåŸŸã€‚ åŒºåŸŸï¼Œå³å­ç»“ç‚¹å¯¹åº”äºåæ ‡å°†è½åœ¨åˆ‡åˆ†è¶…å¹³é¢ä¸Šçš„å®ä¾‹ç‚¹ä¿å­˜åœ¨æ ¹ç»“ç‚¹ã€‚</p>
<p>â€‹        (2)é‡å¤: å¯¹æ·±åº¦ä¸º $j$ çš„ç»“ç‚¹ï¼Œé€‰æ‹© $x^{(l)}$ ä¸ºåˆ‡åˆ†çš„åæ ‡è½´ï¼Œ$l=j(\bmod k)+1,$ ä»¥è¯¥ç»“ç‚¹çš„åŒºåŸŸä¸­æ‰€æœ‰å®ä¾‹çš„ $x^{(l)}$ åæ ‡çš„ä¸­ä½æ•°ä¸ºåˆ‡åˆ†ç‚¹ï¼Œå°†è¯¥ç»“ç‚¹å¯¹åº”çš„è¶…çŸ©å½¢åŒºåŸŸåˆ‡åˆ†ä¸ºä¸¤ä¸ªå­åŒºåŸŸã€‚åˆ‡åˆ†ç”±é€šè¿‡åˆ‡åˆ†ç‚¹å¹¶ä¸åæ ‡è½´ $x^{(l)}$ å‚ç›´çš„è¶…å¹³é¢å®ç°ã€‚<br>â€‹       ç”±è¯¥ç»“ç‚¹ç”Ÿæˆæ·±åº¦ä¸º $j+1$ çš„å·¦ã€å³å­ç»“ç‚¹ï¼šå·¦å­ç»“ç‚¹å¯¹åº”åæ ‡ $x^{(l)}$ å°äºåˆ‡åˆ†ç‚¹ çš„å­åŒºåŸŸï¼Œå³å­ç»“ç‚¹å¯¹åº”åæ ‡ $x^{(l)}$ å¤§äºåˆ‡åˆ†ç‚¹çš„å­åŒºåŸŸã€‚</p>
<p>â€‹        å°†è½åœ¨åˆ‡åˆ†è¶…å¹³é¢ä¸Šçš„å®ä¾‹ç‚¹ä¿å­˜åœ¨è¯¥ç»“ç‚¹ã€‚</p>
<p>â€‹        (3)ç›´åˆ°ä¸¤ä¸ªå­åŒºåŸŸæ²¡æœ‰å®ä¾‹å­˜åœ¨æ—¶åœæ­¢ã€‚ä»è€Œå½¢æˆ $k d$ æ ‘çš„åŒºåŸŸåˆ’åˆ†.</p>
<p><strong>æœç´¢kdæ ‘</strong></p>
<p>ç»™å®šä¸€ä¸ªç›®æ ‡ç‚¹ï¼Œ æœç´¢å…¶æœ€è¿‘é‚»ã€‚ é¦–å…ˆæ‰¾åˆ°åŒ…å«ç›®æ ‡ç‚¹çš„å¶ç»“ç‚¹ï¼› ç„¶åä»è¯¥å¶ç»“ç‚¹å‡ºå‘ï¼Œ ä¾æ¬¡å›é€€åˆ°çˆ¶ç»“ç‚¹ï¼› ä¸æ–­æŸ¥æ‰¾ä¸ç›®æ ‡ç‚¹æœ€é‚»è¿‘çš„ç»“ç‚¹ï¼Œ å½“ç¡®å®šä¸å¯èƒ½å­˜åœ¨æ›´è¿‘çš„ç»“ç‚¹æ—¶ç»ˆæ­¢</p>
<p><strong>ç®—æ³• $3.3$(ç”¨ $k d$ æ ‘çš„æœ€è¿‘é‚»æœç´¢)</strong></p>
<p>è¾“å…¥: å·²æ„é€ çš„ $k d$ æ ‘ï¼Œç›®æ ‡ç‚¹ $x$</p>
<p>è¾“å‡º: $x$ çš„æœ€è¿‘é‚»ã€‚</p>
<p>(1) åœ¨ $k d$ æ ‘ä¸­æ‰¾å‡ºåŒ…å«ç›®æ ‡ç‚¹ $x$ çš„å¶ç»“ç‚¹: ä»æ ¹ç»“ç‚¹å‡ºå‘ï¼Œé€’å½’åœ°å‘ä¸‹è®¿é—® $k d$ æ ‘ã€‚è‹¥ç›®æ ‡ç‚¹ $x$ å½“å‰ç»´çš„åæ ‡å°äºåˆ‡åˆ†ç‚¹çš„åæ ‡ï¼Œåˆ™ç§»åŠ¨åˆ°å·¦å­ç»“ç‚¹ï¼Œå¦åˆ™ç§»åŠ¨åˆ°å³å­ç»“ç‚¹ã€‚<strong>ç›´åˆ°å­ç»“ç‚¹ä¸ºå¶ç»“ç‚¹ä¸ºæ­¢</strong>ã€‚</p>
<p>(2) ä»¥æ­¤å¶ç»“ç‚¹ä¸ºâ€œå½“å‰æœ€è¿‘ç‚¹â€ã€‚</p>
<p>(3) é€’å½’åœ°å‘ä¸Šå›é€€ï¼Œåœ¨æ¯ä¸ªç»“ç‚¹è¿›è¡Œä»¥ä¸‹æ“ä½œ:</p>
<p>â€‹        (a)å¦‚æœè¯¥ç»“ç‚¹ä¿å­˜çš„å®ä¾‹ç‚¹æ¯”å½“å‰æœ€è¿‘ç‚¹è·ç¦»ç›®æ ‡ç‚¹æ›´è¿‘ï¼Œåˆ™ä»¥è¯¥å®ä¾‹ç‚¹ä¸ºâ€œå½“å‰æœ€è¿‘ç‚¹â€ã€‚</p>
<p>â€‹        (b)å½“å‰æœ€è¿‘ç‚¹ä¸€å®šå­˜åœ¨äºè¯¥ç»“ç‚¹ä¸€ä¸ªå­ç»“ç‚¹å¯¹åº”çš„åŒºåŸŸã€‚æ£€æŸ¥è¯¥å­ç»“ç‚¹çš„çˆ¶ç»“ç‚¹çš„å¦ä¸€å­ç»“ç‚¹å¯¹åº”çš„åŒºåŸŸæ˜¯å¦æœ‰æ›´è¿‘çš„ç‚¹ã€‚å…·ä½“åœ°ï¼Œæ£€æŸ¥å¦ä¸€å­ç»“ç‚¹å¯¹åº”çš„ åŒºåŸŸæ˜¯å¦ä¸ä»¥ç›®æ ‡ç‚¹ä¸ºçƒå¿ƒã€ä»¥ç›®æ ‡ç‚¹ä¸â€œå½“å‰æœ€è¿‘ç‚¹â€é—´çš„è·ç¦»ä¸ºåŠå¾„çš„è¶…çƒä½“ç›¸äº¤ã€‚</p>
<p>â€‹        å¦‚æœç›¸äº¤ï¼Œå¯èƒ½åœ¨å¦ä¸€ä¸ªå­ç»“ç‚¹å¯¹åº”çš„åŒºåŸŸå†…å­˜åœ¨è·ç›®æ ‡ç‚¹æ›´è¿‘çš„ç‚¹ï¼Œç§»åŠ¨ åˆ°å¦ä¸€ä¸ªå­ç»“ç‚¹ã€‚æ¥ç€ï¼Œé€’å½’åœ°è¿›è¡Œæœ€è¿‘é‚»æœç´¢; </p>
<p>â€‹        å¦‚æœä¸ç›¸äº¤ï¼Œå‘ä¸Šå›é€€ã€‚</p>
<p>(4) å½“å›é€€åˆ°æ ¹ç»“ç‚¹æ—¶ï¼Œæœç´¢ç»“æŸã€‚æœ€åçš„â€œå½“å‰æœ€è¿‘ç‚¹â€å³ä¸º $x$ çš„æœ€è¿‘é‚»ç‚¹ã€‚</p>
<h1 id="3-ä»£ç å®ç°"><a href="#3-ä»£ç å®ç°" class="headerlink" title="3. ä»£ç å®ç°"></a>3. ä»£ç å®ç°</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## max()å‡½æ•°æŠ€å·§</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## åˆçº§æŠ€å·§</span></span><br><span class="line">tmp = <span class="built_in">max</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">print(tmp)</span><br><span class="line"><span class="comment">#å¯è¿­ä»£å¯¹è±¡</span></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">tmp = <span class="built_in">max</span>(a)</span><br><span class="line">print(tmp)</span><br><span class="line"></span><br><span class="line"><span class="comment">## ä¸­çº§æŠ€å·§ï¼škeyå±æ€§çš„ä½¿ç”¨</span></span><br><span class="line"><span class="comment"># keyå‚æ•°ä¸ä¸ºç©ºæ—¶ï¼Œå°±ä»¥keyçš„å‡½æ•°å¯¹è±¡ä¸ºåˆ¤æ–­çš„æ ‡å‡†ã€‚</span></span><br><span class="line"><span class="comment"># å¦‚æœæˆ‘ä»¬æƒ³æ‰¾å‡ºä¸€ç»„æ•°ä¸­ç»å¯¹å€¼æœ€å¤§çš„æ•°ï¼Œå°±å¯ä»¥é…åˆlamdaå…ˆè¿›è¡Œå¤„ç†ï¼Œå†æ‰¾å‡ºæœ€å¤§å€¼</span></span><br><span class="line">a = [-<span class="number">9</span>, -<span class="number">8</span>, <span class="number">1</span>, <span class="number">3</span>, -<span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line">tmp = <span class="built_in">max</span>(a, key=<span class="keyword">lambda</span> x: <span class="built_in">abs</span>(x))</span><br><span class="line">print(tmp)</span><br><span class="line"></span><br><span class="line"><span class="comment">## é«˜çº§æŠ€å·§ï¼šæ‰¾å‡ºå­—å…¸ä¸­å€¼æœ€å¤§çš„é‚£ç»„æ•°æ®</span></span><br><span class="line"><span class="comment">#åœ¨å¯¹å­—å…¸è¿›è¡Œæ•°æ®æ“ä½œçš„æ—¶å€™ï¼Œé»˜è®¤åªä¼šå¤„ç†keyï¼Œè€Œä¸æ˜¯value</span></span><br><span class="line"><span class="comment">#å…ˆä½¿ç”¨zipæŠŠå­—å…¸çš„keyså’Œvaluesç¿»è½¬è¿‡æ¥ï¼Œå†ç”¨maxå–å‡ºå€¼æœ€å¤§çš„é‚£ç»„æ•°æ®</span></span><br><span class="line"><span class="comment">#è¿™ä¸ªæ—¶å€™keyæ˜¯å€¼ï¼Œvalueæ˜¯ä¹‹å‰çš„key</span></span><br><span class="line"><span class="comment">#å¦‚æœæœ‰ä¸€ç»„å•†å“ï¼Œå…¶åç§°å’Œä»·æ ¼éƒ½å­˜åœ¨ä¸€ä¸ªå­—å…¸ä¸­ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•å¿«é€Ÿæ‰¾åˆ°ä»·æ ¼æœ€è´µçš„é‚£ç»„å•†å“ï¼š</span></span><br><span class="line">prices = &#123;</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>:<span class="number">123</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>:<span class="number">450.1</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>:<span class="number">12</span>,</span><br><span class="line">    <span class="string">&#x27;E&#x27;</span>:<span class="number">444</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># åœ¨å¯¹å­—å…¸è¿›è¡Œæ•°æ®æ“ä½œçš„æ—¶å€™ï¼Œé»˜è®¤åªä¼šå¤„ç†keyï¼Œè€Œä¸æ˜¯value</span></span><br><span class="line"><span class="comment"># å…ˆä½¿ç”¨zipæŠŠå­—å…¸çš„keyså’Œvaluesç¿»è½¬è¿‡æ¥ï¼Œå†ç”¨maxå–å‡ºå€¼æœ€å¤§çš„é‚£ç»„æ•°æ®</span></span><br><span class="line">max_prices = <span class="built_in">max</span>(<span class="built_in">zip</span>(prices.values(), prices.keys()))</span><br><span class="line">print(max_prices) </span><br><span class="line"><span class="comment">#è¿™ä¸ªæ—¶å€™keyæ˜¯å€¼ï¼Œvalueæ˜¯ä¹‹å‰çš„key</span></span><br><span class="line"><span class="comment"># (450.1, &#x27;B&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å½“å­—å…¸ä¸­çš„valueç›¸åŒçš„æ—¶å€™ï¼Œæ‰ä¼šæ¯”è¾ƒkey</span></span><br><span class="line">prices = &#123;</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>: <span class="number">123</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="number">123</span>,</span><br><span class="line">&#125;</span><br><span class="line">max_prices = <span class="built_in">max</span>(<span class="built_in">zip</span>(prices.values(), prices.keys()))print(max_prices) <span class="comment"># (123, &#x27;B&#x27;)</span></span><br><span class="line">min_prices = <span class="built_in">min</span>(<span class="built_in">zip</span>(prices.values(), prices.keys()))print(min_prices) <span class="comment"># (123, &#x27;A&#x27;)</span></span><br></pre></td></tr></table></figure>
<p><strong>K-NN</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## load data</span></span><br><span class="line">iris = load_iris()  <span class="comment"># np.array æ ¼å¼</span></span><br><span class="line">df = pd.DataFrame(iris.data, columns = iris.feature_names)</span><br><span class="line">df[<span class="string">&#x27;label&#x27;</span>] = iris.target <span class="comment"># æ·»åŠ labelåˆ—</span></span><br><span class="line">df[:<span class="number">20</span>] <span class="comment"># æŸ¥çœ‹ä¸€ä¸‹å®é™…æ•°æ®</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">data = np.array(df.iloc[:,:]) <span class="comment"># æ•°æ®ç”±Datafromè½¬åŒ–ä¸ºarray</span></span><br><span class="line">X, Y = data[:, :-<span class="number">1</span>], data[:, -<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_shuffle</span>(<span class="params">X, Y</span>):</span></span><br><span class="line">    randomize = np.arange(<span class="built_in">len</span>(X))</span><br><span class="line">    np.random.shuffle(randomize)</span><br><span class="line">    <span class="keyword">return</span> X[randomize], Y[randomize]</span><br><span class="line">X, Y = _shuffle(X,Y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_train_test_split</span>(<span class="params">X, Y, split_ratio = <span class="number">0.1</span></span>):</span></span><br><span class="line">    train_size = <span class="built_in">int</span>(<span class="built_in">len</span>(X) * (<span class="number">1</span> - split_ratio))</span><br><span class="line">    <span class="keyword">return</span> X[:train_size], Y[:train_size], X[train_size:], Y[train_size:]</span><br><span class="line"></span><br><span class="line">X_train, Y_train, X_test, Y_test = _train_test_split(X, Y, split_ratio = <span class="number">0.1</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## æ•°æ®æ ‡å‡†åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_normalize</span>(<span class="params">X, train_set = <span class="literal">True</span>, specified_columns = <span class="literal">None</span>, X_mean = <span class="literal">None</span>, X_std = <span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> specified_columns == <span class="literal">None</span>:</span><br><span class="line">        specified_columns = np.arange(<span class="built_in">len</span>(X[<span class="number">0</span>]))</span><br><span class="line">    <span class="keyword">if</span> train_set:</span><br><span class="line">        X_mean = np.mean(X[:, specified_columns], axis = <span class="number">0</span>)</span><br><span class="line">        X_std = np.std(X[:, specified_columns], axis = <span class="number">0</span>)</span><br><span class="line">    X[:, specified_columns] = (X[:,specified_columns] - X_mean) / (X_std + <span class="number">1e-8</span>)</span><br><span class="line">    <span class="keyword">return</span> X, X_mean, X_std</span><br><span class="line"></span><br><span class="line">X_train, X_mean, X_std = _normalize(X_train, train_set=<span class="literal">True</span>)</span><br><span class="line">X_test, _, _ = _normalize(X_test, train_set = <span class="literal">None</span>, X_mean = X_mean, X_std = X_std)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>çº¿æ€§éå†æœ€è¿‘çš„Kä¸ªç‚¹</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KNN_LinearSearch</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, X_train, Y_train, k = <span class="number">3</span>, p=<span class="number">2</span></span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        k: ä¸´è¿‘ç‚¹çš„ä¸ªæ•°</span></span><br><span class="line"><span class="string">        p: è·ç¦»åº¦é‡</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.k = k</span><br><span class="line">        self.p = p</span><br><span class="line">        self.X_train = X_train</span><br><span class="line">        self.Y_train = Y_train</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">self, X_test</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        X_testï¼Œè¯¥å‡½æ•°æ‰¾å‡ºæœ€è¿‘çš„kä¸ªç‚¹ï¼Œå¹¶æŒ‰ç…§å¤šæ•°è¡¨å†³è§„åˆ™è¿›è¡Œé¢„æµ‹</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X_test)):</span><br><span class="line">            X = X_test[i]</span><br><span class="line">            knn_list = []</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(self.k):</span><br><span class="line">                dist = np.linalg.norm(X - self.X_train[j], <span class="built_in">ord</span>=self.p) <span class="comment">#npä¸­æ±‚çº¿æ€§ä»£æ•°èŒƒæ•°çš„å…¬å¼</span></span><br><span class="line">                knn_list.append((dist, self.Y_train[j]))</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(self.k, <span class="built_in">len</span>(self.X_train)):</span><br><span class="line">                max_index = knn_list.index(<span class="built_in">max</span>(knn_list, key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>]))</span><br><span class="line">                dist_new = np.linalg.norm(X-self.X_train[l], <span class="built_in">ord</span>=self.p)</span><br><span class="line">                <span class="keyword">if</span> knn_list[max_index][<span class="number">0</span>] &gt; dist_new:</span><br><span class="line">                    knn_list[max_index] = (dist, self.Y_train[l])</span><br><span class="line">                    </span><br><span class="line">            <span class="comment"># åˆ†ç±»å†³ç­–è§„åˆ™ï¼šå¤šæ•°è¡¨å†³</span></span><br><span class="line">            knn_label = [k[-<span class="number">1</span>] <span class="keyword">for</span> k <span class="keyword">in</span> knn_list]</span><br><span class="line">            max_count_label = <span class="built_in">max</span>(knn_label, key=knn_label.count)</span><br><span class="line">            result.append(max_count_label)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Correct_rate</span>(<span class="params">self, X_test, Y_test</span>):</span></span><br><span class="line">        right_count = <span class="number">0</span></span><br><span class="line">        predictions = self.predict(X_test)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Y_test)):</span><br><span class="line">            <span class="keyword">if</span> predictions[i] == Y_test[i]:</span><br><span class="line">                right_count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> right_count / <span class="built_in">len</span>(X_test)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">KNN = KNN_LinearSearch(X_train, Y_train)</span><br><span class="line">KNN.predict(X_test)</span><br><span class="line"><span class="comment"># [1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0]</span></span><br><span class="line">KNN.Correct_rate(X_test, Y_test)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Kdæ ‘-æœ€è¿‘é‚»æœç´¢</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KdNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, dom_elt, split, left, right</span>):</span></span><br><span class="line">        self.dom_elt = dom_elt <span class="comment"># kç»´å‘é‡èŠ‚ç‚¹ï¼ˆkç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªæ ·æœ¬ç‚¹ï¼‰, åˆ†å‰²çš„é‚£ä¸ªæ ·æœ¬ç‚¹ dom_elt = [1,2,3,5,6...]</span></span><br><span class="line">        self.split = split <span class="comment"># æ•´æ•°ï¼ˆè¿›è¡Œåˆ†å‰²çº¬åº¦çš„åºå·ï¼‰</span></span><br><span class="line">        self.left = left <span class="comment"># è¯¥ç»“ç‚¹åˆ†å‰²è¶…å¹³é¢å·¦å­ç©ºé—´æ„æˆçš„kd-tree</span></span><br><span class="line">        self.right = right <span class="comment"># è¯¥ç»“ç‚¹åˆ†å‰²è¶…å¹³é¢å³å­ç©ºé—´æ„æˆçš„kd-tree</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KdTree</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        dim = <span class="built_in">len</span>(data[<span class="number">0</span>]) <span class="comment"># æ•°æ®ç»´åº¦</span></span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">CreateNode</span>(<span class="params">split, data_set</span>):</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> data_set:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            <span class="comment"># æŒ‰è¦è¿›è¡Œåˆ†å‰²çš„é‚£ä¸€åˆ‡æ•°æ®æ’åº</span></span><br><span class="line">            data_set.sort(key=<span class="keyword">lambda</span> x: x[split]) <span class="comment"># è¿™é‡Œsortï¼Œkeyçš„ç”¨æ³•å’Œmaxç±»ä¼¼</span></span><br><span class="line">            split_pos = <span class="built_in">len</span>(data_set) // <span class="number">2</span> <span class="comment"># æ•´æ•°é™¤æ³•</span></span><br><span class="line">            median = data_set[split_pos]  <span class="comment"># ä¸­ä½æ•°åˆ†å‰²ç‚¹</span></span><br><span class="line">            split_next = (split + <span class="number">1</span>) % dim</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># é€’å½’çš„åˆ›å»ºkdæ ‘</span></span><br><span class="line">            <span class="keyword">return</span> KdNode(median, split, </span><br><span class="line">                          CreateNode(split_next, data_set[:split_pos]),</span><br><span class="line">                          CreateNode(split_next, data_set[split_pos + <span class="number">1</span>:]))</span><br><span class="line">        self.root = CreateNode(<span class="number">0</span>, data) <span class="comment"># ä»ç¬¬0ç»´å¼€å§‹åˆ›å»ºkdæ ‘</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># kdæ ‘çš„å‰åºéå†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">preorder</span>(<span class="params">root</span>):</span></span><br><span class="line">    print(root.dom_elt)</span><br><span class="line">    <span class="keyword">if</span> root.left: <span class="comment"># èŠ‚ç‚¹ä¸ä¸ºç©º</span></span><br><span class="line">        preorder(root.left)</span><br><span class="line">    <span class="keyword">if</span> root.right:</span><br><span class="line">        preorder(root.right)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## å¯»æ‰¾æœ€è¿‘çš„kä¸ªç‚¹</span></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªnamedtuple, åˆ†åˆ«å­˜æ”¾æœ€è¿‘åæ ‡ç‚¹ã€æœ€è¿‘è·ç¦»å’Œè®¿é—®è¿‡çš„èŠ‚ç‚¹æ•°</span></span><br><span class="line">result = namedtuple(<span class="string">&quot;Result_tuple&quot;</span>, <span class="string">&quot;nearest_point nearest_dist nodes_visited&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_nearest</span>(<span class="params">tree, point</span>):</span></span><br><span class="line">    dim = <span class="built_in">len</span>(point)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">travel</span>(<span class="params">kd_node, target, max_dist</span>):</span></span><br><span class="line">        <span class="comment"># è¿­ä»£ç»ˆæ­¢æ¡ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> kd_node <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> result([<span class="number">0</span>] * dim, <span class="built_in">float</span>(<span class="string">&quot;inf&quot;</span>), <span class="number">0</span>)  <span class="comment"># float(&quot;inf&quot;)æ­£æ— ç©·ï¼Œfloat(&quot;-inf&quot;)</span></span><br><span class="line">        </span><br><span class="line">        nodes_visited = <span class="number">1</span></span><br><span class="line">        s = kd_node.split  <span class="comment"># åˆ†å‰²çš„çº¬åº¦</span></span><br><span class="line">        pivot = kd_node.dom_elt  <span class="comment"># è¿›è¡Œåˆ†å‰²çš„è½´ï¼Œå®ä¾‹ç‚¹</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> target[s] &lt;= pivot[s]:  <span class="comment"># å¦‚æœç›®æ ‡ç‚¹ç¬¬sç»´å°äºåˆ†å‰²ç‚¹çš„å¯¹åº”å€¼</span></span><br><span class="line">            nearer_node = kd_node.left <span class="comment">#ä¸‹ä¸€è®¿é—®èŠ‚ç‚¹ä¸ºå·¦å­æ ‘æ ¹èŠ‚ç‚¹</span></span><br><span class="line">            further_node = kd_node.right <span class="comment"># åŒæ—¶è®°å½•å³å­æ ‘ä»¥ä¾¿åæœŸä¸ç›®æ ‡ç‚¹è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            nearer_node = kd_node.right</span><br><span class="line">            further_node = kd_node.left</span><br><span class="line">            </span><br><span class="line">        temp1 = travel(nearer_node, target, max_dist) <span class="comment"># é€’å½’éå†</span></span><br><span class="line">        </span><br><span class="line">        nearest = temp1.nearest_point <span class="comment"># ä»¥æ­¤å¶èŠ‚ç‚¹ä½œä¸ºå½“å‰æœ€è¿‘ç‚¹</span></span><br><span class="line">        dist = temp1.nearest_dist <span class="comment"># æ›´æ–°æœ€è¿‘è·ç¦»</span></span><br><span class="line">        nodes_visited += temp1.nodes_visited</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> dist &lt; max_dist:</span><br><span class="line">            max_dist = dist</span><br><span class="line">        </span><br><span class="line">        temp_dist = <span class="built_in">abs</span>(pivot[s] - target[s]) <span class="comment"># ç¬¬sç»´ä¸Šç›®æ ‡ç‚¹ä¸åˆ†å‰²è¶…å¹³é¢çš„è·ç¦»</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> max_dist &lt; temp_dist: <span class="comment"># åˆ¤æ–­è¶…çƒä½“æ˜¯å¦ä¸è¶…å¹³é¢ç›¸äº¤</span></span><br><span class="line">            <span class="keyword">return</span> result(nearest, dist, nodes_visited) <span class="comment"># ä¸ç›¸äº¤åˆ™å¯ä»¥ç›´æ¥è¿”å›ï¼Œä¸ç”¨ç»§ç»­åˆ¤æ–­ï¼Œä¹Ÿå°±æ„å‘³è¿™çˆ¶èŠ‚ç‚¹(åˆ†å‰²ç‚¹)çš„å¦ä¸€å­èŠ‚ç‚¹ä¸ä¼šæ¯”ç°åœ¨çš„å­èŠ‚ç‚¹ä¸ç›®æ ‡ç‚¹æ›´è¿‘</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è®¡ç®—ç›®æ ‡ç‚¹å’Œåˆ†å‰²ç‚¹çš„æ¬§æ°è·ç¦»</span></span><br><span class="line">        temp_dist = sqrt(<span class="built_in">sum</span>((p1 - p2) ** <span class="number">2</span> <span class="keyword">for</span> p1, p2 <span class="keyword">in</span> <span class="built_in">zip</span>(pivot, target)))</span><br><span class="line">        <span class="keyword">if</span> temp_dist &lt; dist: <span class="comment"># æ„å‘³ç€åˆ†å‰²ç‚¹æ­¤æ—¶ä¸ºæœ€è¿‘ç‚¹</span></span><br><span class="line">            nearest = pivot <span class="comment"># æ›´æ–°æœ€è¿‘ç‚¹</span></span><br><span class="line">            dist =  temp_dist <span class="comment"># æ›´æ–°æœ€è¿‘è·ç¦»</span></span><br><span class="line">            max_dist = dist  <span class="comment"># æ›´æ–°è¶…è¶…çƒä½“åŠå¾„</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ£€æŸ¥å¦ä¸€ä¸ªå­èŠ‚ç‚¹å¯¹åº”çš„åŒºåŸŸæ˜¯å¦æœ‰æ›´è¿‘çš„ç‚¹</span></span><br><span class="line">        temp2 = travel(further_node, target, max_dist)</span><br><span class="line">        </span><br><span class="line">        nodes_visited += temp2.nodes_visited</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> temp2.nearest_dist &lt; dist: <span class="comment"># å¦‚æœå¦ä¸€ä¸ªå­èŠ‚ç‚¹å†…å­˜åœ¨æ›´è¿‘è·ç¦»</span></span><br><span class="line">            nearest = temp2.nearest_point</span><br><span class="line">            dist = temp2.nearest_dist</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result(nearest, dist, nodes_visited) </span><br><span class="line">    <span class="keyword">return</span> travel(tree.root, point, <span class="built_in">float</span>(<span class="string">&quot;inf&quot;</span>))  <span class="comment"># ä»æ ¹èŠ‚ç‚¹é€’å½’</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">data = [[<span class="number">2</span>,<span class="number">3</span>],[<span class="number">5</span>,<span class="number">4</span>],[<span class="number">9</span>,<span class="number">6</span>],[<span class="number">4</span>,<span class="number">7</span>],[<span class="number">8</span>,<span class="number">1</span>],[<span class="number">7</span>,<span class="number">2</span>]]</span><br><span class="line">kd = KdTree(data)</span><br><span class="line">preorder(kd.root)</span><br><span class="line">[<span class="number">7</span>, <span class="number">2</span>]</span><br><span class="line">[<span class="number">5</span>, <span class="number">4</span>]</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">[<span class="number">4</span>, <span class="number">7</span>]</span><br><span class="line">[<span class="number">9</span>, <span class="number">6</span>]</span><br><span class="line">[<span class="number">8</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> clock</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº§ç”Ÿä¸€ä¸ªkç»´éšæœºå‘é‡ï¼Œæ¯ç»´åˆ†é‡å€¼åœ¨0ï½1ä¹‹é—´</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_point</span>(<span class="params">k</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [random() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº§ç”Ÿnä¸ªkç»´éšæœºå‘é‡</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_points</span>(<span class="params">k, n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [random_point(k) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ret = find_nearest(kd, [<span class="number">3</span>, <span class="number">4.5</span>])</span><br><span class="line">print(ret)</span><br><span class="line"><span class="comment"># Result_tuple(nearest_point=[2, 3], nearest_dist=1.8027756377319946, nodes_visited=4)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">400000</span></span><br><span class="line">t0 = clock()</span><br><span class="line">kd2 = KdTree(random_points(<span class="number">3</span>,N)) <span class="comment"># æ„å»ºåŒ…å«å››åä¸‡ä¸ª3ç»´ç©ºé—´æ ·æœ¬ç‚¹çš„kdæ ‘</span></span><br><span class="line">ret2 = find_nearest(kd2, [<span class="number">0.1</span>, <span class="number">0.5</span>, <span class="number">0.8</span>]) <span class="comment"># å››åä¸‡ä¸ªæ ·æœ¬ç‚¹ä¸­å¯»æ‰¾ç¦»ç›®æ ‡æœ€è¿‘çš„ç‚¹</span></span><br><span class="line">t1 = clock()</span><br><span class="line">print(<span class="string">&quot;time: &quot;</span>, t1-t0, <span class="string">&quot;s&quot;</span>)</span><br><span class="line">print(ret2)</span><br><span class="line"><span class="comment"># time:  5.106322 s</span></span><br><span class="line"><span class="comment"># Result_tuple(nearest_point=[0.10488218676493222, 0.49793482149466295, 0.7951887681764834], nearest_dist=0.007158817047962914, nodes_visited=62)</span></span><br></pre></td></tr></table></figure>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><p>[1] <a target="_blank" rel="noopener" href="https://github.com/fengdu78/lihang-code/blob/master/%E7%AC%AC03%E7%AB%A0%20k%E8%BF%91%E9%82%BB%E6%B3%95/3.KNearestNeighbors.ipynb">https://github.com/fengdu78/lihang-code/blob/master/%E7%AC%AC03%E7%AB%A0%20k%E8%BF%91%E9%82%BB%E6%B3%95/3.KNearestNeighbors.ipynb</a></p>
<p>[2] ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ â€”æèˆª</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/11/Perceptron/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/11/Perceptron/" class="post-title-link" itemprop="url">Perceptron(æœªå®Œå¾…æ›´)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-03-11 21:04:14" itemprop="dateCreated datePublished" datetime="2021-03-11T21:04:14+08:00">2021-03-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-03-15 17:30:44" itemprop="dateModified" datetime="2021-03-15T17:30:44+08:00">2021-03-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>äºŒåˆ†ç±»çº¿æ€§æ¨¡å‹</p>
<h1 id="1-æ¨¡å‹"><a href="#1-æ¨¡å‹" class="headerlink" title="1. æ¨¡å‹"></a>1. æ¨¡å‹</h1><p>$$<br>f(x)=\operatorname{sign}(w \cdot x+b)<br>$$</p>
<p><strong>Loss function:</strong><br>$$<br>L(w, b)=-\sum_{x_{i} \in M} y_{i}\left(w \cdot x_{i}+b\right)<br>$$<br>å› æ­¤å…¶<strong>ç›®æ ‡å‡½æ•°</strong>ä¸º<br>$$<br>\min_{w, b}L(w, b)=-\sum_{x_{i} \in M} y_{i}(w \cdot x_{i}+b)<br>$$<br>ä¼˜åŒ–æ–¹æ³•ï¼š</p>
<ul>
<li>éšæœºæ¢¯åº¦ä¸‹é™(SGD)ï¼šæ¯æ¬¡æ›´æ–°ä½¿ç”¨ä¸€ä¸ªæ•°æ® </li>
</ul>
<p><strong>ç®—æ³•2.1:</strong></p>
<p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† $T = {(x_1,y_1),(x_2,y_2),â€¦,(x_N,y_N)}$ ï¼Œå…¶ä¸­ $x_{i} \in \mathcal{X}=\mathbf{R}^{n}$ï¼Œ$y_{i} \in \mathcal{Y}=\lbrace -1,+1 \rbrace$, $i=1,2, \cdots, N $ ï¼›å­¦ä¹ ç‡ $\eta (0&lt;\eta \leqslant 1) ;$<br>è¾“å‡º ï¼š$ w, b $ çŸ¥æœºæ¨¡å‹ $f(x)=\operatorname{sign}(w \cdot x+b)$ ã€‚<br>(1) é€‰å–åˆå€¼ $w_{0}, b_{0} ;$<br>(2) åœ¨è®­ç»ƒé›†ä¸­é€‰å–æ•°æ® $\left(x_{i}, y_{i}\right) ;$<br>(3) å¦‚æœ $y_{i}\left(w \cdot x_{i}+b\right) \leqslant 0$,<br>$$<br>\begin{array}{l}<br>w \leftarrow w+\eta y_{i} x_{i} \\<br>b \leftarrow b+\eta y_{i}<br>\end{array}<br>$$<br>(4) è½¬è‡³ (2)ï¼Œç›´è‡³è®­ç»ƒé›†ä¸­æ²¡æœ‰è¯¯åˆ†ç±»ç‚¹ã€‚</p>
<h1 id="2-ç®—æ³•çš„æ”¶æ•›æ€§"><a href="#2-ç®—æ³•çš„æ”¶æ•›æ€§" class="headerlink" title="2. ç®—æ³•çš„æ”¶æ•›æ€§"></a>2. ç®—æ³•çš„æ”¶æ•›æ€§</h1><p>å¯¹äº<strong>çº¿æ€§å¯åˆ†çš„çš„æ•°æ®é›†</strong>ï¼Œperceptronç»è¿‡æœ‰é™æ¬¡è¿­ä»£ä¸€å®šä¼šæ”¶æ•›</p>
<p><strong>è¯æ˜è¿‡ç¨‹å¾…åç»­è¡¥å……ï¼š</strong></p>
<h1 id="3-æ„ŸçŸ¥æœºçš„å¯¹å¶å½¢å¼"><a href="#3-æ„ŸçŸ¥æœºçš„å¯¹å¶å½¢å¼" class="headerlink" title="3. æ„ŸçŸ¥æœºçš„å¯¹å¶å½¢å¼"></a>3. æ„ŸçŸ¥æœºçš„å¯¹å¶å½¢å¼</h1><p>å¯¹å¶å½¢å¼çš„åŸºæœ¬æƒ³æ³•æ˜¯ï¼Œå°† $w$ å’Œ $b$ è¡¨ç¤ºä¸ºå®ä¾‹ $x_{i}$ å’Œæ ‡è®° $y_{i}$ çš„çº¿æ€§ç»„åˆçš„å½¢å¼, é€šè¿‡æ±‚è§£å…¶ç³»æ•°è€Œæ±‚å¾— $w$ å’Œ $b$ ã€‚ä¸å¤±ä¸€èˆ¬æ€§ï¼Œåœ¨ç®—æ³•ä¸­å¯å‡è®¾åˆå§‹å€¼ $w_{0}, b_{0}$ å‡ä¸º<br>$0 ã€‚$ å¯¹è¯¯åˆ†ç±»ç‚¹ $\left(x_{i}, y_{i}\right)$ é€šè¿‡<br>$$<br>\begin{array}{l}<br>w \leftarrow w+\eta y_{i} x_{i} \\<br>b \leftarrow b+\eta y_{i}<br>\end{array}<br>$$<br>æœ€åå­¦å¾—çš„ $w,b$ å¯ä»¥è¡¨ç¤ºä¸º<br>$$<br>\begin{array}{c}<br>w=\sum_{i=1}^{N} \alpha_{i} y_{i} x_{i} \\<br>b=\sum_{i=1}^{N} \alpha_{i} y_{i}<br>\end{array}<br>$$<br><strong>ç®—æ³• 2.2(æ„ŸçŸ¥æœºå­¦ä¹ ç®—æ³•çš„å¯¹å¶å½¢å¼)</strong><br>è¾“å…¥ï¼šçº¿æ€§å¯åˆ†çš„æ•°æ®é›† $T = \lbrace (x_1,y_1),(x_2,y_2),â€¦,(x_N,y_N) \rbrace$, å…¶ä¸­ $x_{i} \in \mathbf{R}^{n}$ï¼Œ$y_{i} \in\lbrace -1,+1 \rbrace, i=1,2, \cdots, N $ å­¦ä¹ ç‡ $\eta(0&lt;\eta \leqslant 1) ;$<br>è¾“ å‡ºï¼š$\alpha, b$ï¼› æ„Ÿ çŸ¥ æœº æ¨¡å‹ $f(x)=\operatorname{sign}\left(\sum_{j=1}^{N} \alpha_{j} y_{j} x_{j} \cdot x+b\right), \quad$ å…¶ ä¸­ $\alpha=\left(\alpha_{1}, \alpha_{2}, \cdots, \alpha_{N}\right)^{\mathrm{T}}$<br>(1) $\alpha \leftarrow 0, b \leftarrow 0 ;$<br>(2) åœ¨è®­ç»ƒé›†ä¸­é€‰å–æ•°æ® $\left(x_{i}, y_{i}\right) ;$</p>
<p>(3) å¦‚æœ $y_{i}\left(\sum_{j=1}^{N} \alpha_{j} y_{j} x_{j} \cdot x_{i}+b\right) \leqslant 0$,<br>$$<br>\begin{array}{l}<br>\alpha_{i} \leftarrow \alpha_{i}+\eta \\<br>b \leftarrow b+\eta y_{i}<br>\end{array}<br>$$<br>(4ï¼‰è½¬è‡³ (2) ç›´åˆ°æ²¡æœ‰è¯¯åˆ†ç±»æ•°æ®ã€‚</p>
<p><strong>è®¨è®ºæ„ŸçŸ¥æœºçš„å¯¹å¶æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ</strong></p>
<p><strong>è¿™ä¸¤ä¸ªä¸åº”è¯¥æ˜¯ä¸€æ ·çš„å—ï¼Ÿ</strong></p>
<h1 id="4-æ„ŸçŸ¥æœºä»£ç "><a href="#4-æ„ŸçŸ¥æœºä»£ç " class="headerlink" title="4. æ„ŸçŸ¥æœºä»£ç "></a>4. æ„ŸçŸ¥æœºä»£ç </h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line">iris = datasets.load_iris()</span><br><span class="line">X = iris.data[:<span class="number">100</span>, :<span class="number">2</span>]</span><br><span class="line">Y = iris.target[:<span class="number">100</span>]</span><br><span class="line">Y[Y == <span class="number">0</span>] = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®æ ‡å‡†åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_normalize</span>(<span class="params">X, train_set = <span class="literal">True</span>, specified_column = <span class="literal">None</span>, X_mean = <span class="literal">None</span>, X_std = <span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> specified_column == <span class="literal">None</span>:</span><br><span class="line">        specified_column = np.arange(<span class="built_in">len</span>(X[<span class="number">0</span>]))</span><br><span class="line">    <span class="keyword">if</span> train_set:</span><br><span class="line">        X_mean = np.mean(X[:, specified_column], axis = <span class="number">0</span>)</span><br><span class="line">        X_std = np.std(X[:, specified_column], axis = <span class="number">0</span>)</span><br><span class="line">    X[:, specified_column] = (X[:, specified_column] - X_mean) / (X_std + <span class="number">1e-8</span>)</span><br><span class="line">    <span class="keyword">return</span> X, X_mean, X_std</span><br><span class="line"></span><br><span class="line">X, X_mean, X_std = _normalize(X, train_set = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## æ³¨æ„labelçš„æ ‡æªå¿…é¡»æ˜¯ -1 å’Œ 1 è¦ä¸ç„¶ä¼šæ— é™å¾ªç¯ä¸‹å»</span></span><br><span class="line"><span class="comment">## è¿™æ ·å†™æœ‰ä¸ªé”™è¯¯ï¼Œå¦‚æœæ•°æ®é›†ä¸æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œå°†ä¸€ç›´å¾ªç¯ä¸‹å», irisæ•°æ®é›†æ˜¯çº¿æ€§å¯åˆ†çš„</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_train</span>(<span class="params">X, Y, learning_rate = <span class="number">0.2</span></span>):</span></span><br><span class="line">    data_dim = <span class="built_in">len</span>(X[<span class="number">0</span>])</span><br><span class="line">    w = np.zeros((<span class="number">1</span>, data_dim))</span><br><span class="line">    b = <span class="number">0</span></span><br><span class="line">    not_finish = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">while</span> not_finish:</span><br><span class="line">        wrong_count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X)):</span><br><span class="line">            Y_pred = np.sign(np.dot(w, X[idx]) + b)</span><br><span class="line">            <span class="keyword">if</span> Y_pred * Y[idx] &lt;= <span class="number">0</span>: </span><br><span class="line">                w += learning_rate * Y[idx] * X[idx]</span><br><span class="line">                b += learning_rate * Y[idx]</span><br><span class="line">                wrong_count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> wrong_count == <span class="number">0</span>:</span><br><span class="line">            not_finish = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Perceptron is done!&#x27;</span></span><br><span class="line">_train(X,Y,<span class="number">0.1</span>)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/16/RL%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/16/RL%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">RLæ€»ç»“</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-02-16 16:59:41 / ä¿®æ”¹æ—¶é—´ï¼š17:00:39" itemprop="dateCreated datePublished" datetime="2021-02-16T16:59:41+08:00">2021-02-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-æœ‰-æ— æ¨¡å‹å­¦ä¹ "><a href="#1-æœ‰-æ— æ¨¡å‹å­¦ä¹ " class="headerlink" title="1. æœ‰/æ— æ¨¡å‹å­¦ä¹ "></a>1. æœ‰/æ— æ¨¡å‹å­¦ä¹ </h2><ul>
<li><p>æœ‰æ¨¡å‹å­¦ä¹ </p>
<p>æ–¹æ³•ï¼šåŠ¨æ€è§„åˆ’</p>
</li>
<li><p>æ— æ¨¡å‹</p>
<p>æ–¹æ³•ï¼šè’™ç‰¹å¡æ´›ã€æ—¶åºå·®åˆ†</p>
</li>
</ul>
<h2 id="2-åŒ-å¼‚ç­–å­¦ä¹ "><a href="#2-åŒ-å¼‚ç­–å­¦ä¹ " class="headerlink" title="2. åŒ/å¼‚ç­–å­¦ä¹ "></a>2. åŒ/å¼‚ç­–å­¦ä¹ </h2><ul>
<li>åŒç­–<strong>å›åˆæ›´æ–°</strong>ï¼ˆç­–ç•¥$\pi$å’Œç¯å¢ƒäº¤äº’å¾—åˆ°==å®Œæ•´è½¨è¿¹==ï¼Œç„¶åå­¦ä¹ æ›´æ–°ä»·å€¼å‡½æ•°$V^{\pi}$ï¼‰<ul>
<li>æ¯æ¬¡è®¿é—®å›åˆæ›´æ–°</li>
<li>é¦–æ¬¡è®¿é—®å›åˆæ›´æ–°</li>
<li>å¸¦èµ·å§‹æ¢ç´¢çš„åŒç­–å›åˆæ›´æ–°ï¼ˆé¿å…é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼‰</li>
<li>åŸºäºæŸ”æ€§ç­–ç•¥çš„åŒç­–å›åˆæ›´æ–°ï¼ˆé¿å…é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼‰</li>
</ul>
</li>
<li>å¼‚ç­–<strong>å›åˆæ›´æ–°</strong>ï¼ˆ<strong>è¡Œä¸ºç­–ç•¥</strong>$\piâ€™$å’Œç¯å¢ƒäº¤äº’å¾—åˆ°==å®Œæ•´è½¨è¿¹==ï¼Œ<strong>ç›®æ ‡ç­–ç•¥</strong>$\pi$å­¦ä¹ æ›´æ–°ä»·å€¼å‡½æ•°$V^{\pi}$ï¼‰<ul>
<li>é‡è¦æ€§é‡‡æ · æå®æ¯…è®²çš„å¾ˆå¥½</li>
<li>å¼‚ç­–å›åˆæ›´æ–°ç­–ç•¥è¯„ä¼°  # åˆ©ç”¨è¡Œä¸ºç­–ç•¥ä¼°è®¡ç›®æ ‡ç­–ç•¥çš„åŠ¨ä½œçŠ¶æ€ä»·å€¼å¯¹å‡½æ•°å’ŒçŠ¶æ€ä»·å€¼å¯¹å‡½æ•°</li>
<li>å¼‚ç­–å›åˆæ›´æ–°æœ€ä¼˜ç­–ç•¥çš„æ±‚è§£  # è¯„ä¼° + æ”¹è¿›  æ”¹è¿›éƒ¨åˆ†æ˜¯ä¾æ®æ¯ä¸ªçŠ¶æ€ä¸‹çš„æœ€å¤§ä»·å€¼åŠ¨ä½œã€‚</li>
</ul>
</li>
</ul>
<h2 id="3-å›åˆæ›´æ–°-æ—¶åºå·®åˆ†æ›´æ–°"><a href="#3-å›åˆæ›´æ–°-æ—¶åºå·®åˆ†æ›´æ–°" class="headerlink" title="3. å›åˆæ›´æ–°/æ—¶åºå·®åˆ†æ›´æ–°"></a>3. å›åˆæ›´æ–°/æ—¶åºå·®åˆ†æ›´æ–°</h2><ul>
<li>å›åˆæ›´æ–°ï¼ˆæ— åå·®ä½†æ–¹å·®å¤§ï¼Œå’Œç¯å¢ƒå®Œæ•´çš„äº¤äº’ä¸€ä¸ªå›åˆï¼‰<ul>
<li>åˆ©ç”¨è’™ç‰¹å¡æ´›æ–¹æ³•ï¼Œå¯¹å®Œæ•´çš„Gè¿›è¡Œæ— åå·®ä¼°è®¡ï¼Œä½†æ˜¯æ–¹å·®è¾ƒå¤§</li>
</ul>
</li>
<li>æ—¶åºå·®åˆ†æ›´æ–°ï¼ˆæœ‰åå·®ï¼Œä½†æ–¹å·®å°ï¼Œæ”¶æ•›å¿«ï¼Œnæ­¥å°±å’Œç¯å¢ƒäº¤äº’næ¬¡ï¼‰<ul>
<li>åŒç­–ï¼Œç­–ç•¥$\pi$ç”Ÿæˆè½¨è¿¹ï¼Œç„¶åç­–ç•¥$\pi$å­¦ä¹ æ›´æ–°$q(s,Â·)$ï¼Œç„¶åæ ¹æ®qå€¼æ›´æ–°ç­–ç•¥<ul>
<li>$TD(\lambda)$(é™¤æç«¯çš„æ— ç©·å¤–æ˜¯æ—¶åºå·®åˆ†ï¼ŒåŒç­–)</li>
<li>SARSAç®—æ³• = å•/å¤šæ­¥æ—¶åºå·®åˆ†ï¼ˆç­–ç•¥è¯„ä¼°ï¼‰+ ç­–ç•¥æ”¹è¿›   ï¼ˆåŒç­–ï¼‰</li>
<li>æœŸæœ›SARSAç®—æ³•ï¼š$U_t=R_{t+1}+\gamma \sum_{a\in \mathcal{A}}\pi(a|S_{t+1})q(S_{t+1},a)$ ä¹Ÿæœ‰å•æ­¥å’Œå¤šæ­¥  ï¼ˆåŒç­–ï¼‰</li>
</ul>
</li>
<li>å¼‚ç­–ï¼Œè¡Œä¸ºç­–ç•¥$b$å’Œç¯å¢ƒè¿›è¡Œäº¤äº’å¾—åˆ°è½¨è¿¹ï¼Œç„¶åä¾æ®æ­¤è½¨è¿¹å¯¹ç­–ç•¥$\pi$è¿›è¡Œå­¦ä¹ æ›´æ–°qå€¼ï¼Œç„¶åæ ¹æ®qå€¼å¯¹ç­–ç•¥è¿›è¡Œæ›´æ–°<ul>
<li>å•æ­¥/å¤šæ­¥æ—¶åºå·®åˆ†</li>
<li>SARSAç®—æ³•/æœŸæœ›SARSAç®—æ³•</li>
<li>Q-learning</li>
<li>Double Q-learning</li>
</ul>
</li>
</ul>
</li>
<li>èµ„æ ¼è¿¹<ul>
<li>èµ„æ ¼è¿¹å’Œä»¥ä¸Šæ—¶åºå·®åˆ†ç­–ç•¥éƒ½å¯ä»¥ç»“åˆï¼Œä¸ç®¡æ˜¯åŒç­–è¿˜æ˜¯å¼‚ç­–ã€‚</li>
</ul>
</li>
</ul>
<h2 id="4-åŸºäºä»·å€¼-ç­–ç•¥-äºŒè€…ç»“åˆ"><a href="#4-åŸºäºä»·å€¼-ç­–ç•¥-äºŒè€…ç»“åˆ" class="headerlink" title="4. åŸºäºä»·å€¼/ç­–ç•¥/äºŒè€…ç»“åˆ"></a>4. åŸºäºä»·å€¼/ç­–ç•¥/äºŒè€…ç»“åˆ</h2><ul>
<li><p>åŸºäº<strong>ä»·å€¼</strong>çš„</p>
<ul>
<li>è’™ç‰¹å¡æ´›æ–¹æ³•ä¼°è®¡G</li>
<li>åŠ¨æ€è§„åˆ’</li>
<li>$TD(\lambda)$</li>
<li>SARSA</li>
<li>Q-learning</li>
<li>Double Q-learning</li>
</ul>
</li>
<li><p>åŸºäº<strong>ç­–ç•¥</strong>ï¼ˆå›åˆæ›´æ–°ï¼Œåˆ©ç”¨ç­–ç•¥äº¤äº’ä¸æ–­å¾—åˆ°å®Œæ•´è½¨è¿¹ï¼Œå¤šä¸ªå›åˆæ›´æ–°ç›®æ ‡æ˜¯ä½¿ç­–ç•¥$\pi$çš„æœŸæœ›$E(G)$æœ€å¤§</p>
<ul>
<li>åŒç­–å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦ç®—æ³•</li>
<li>å¼‚ç­–å›åˆæ›´æ–°ç­–ç•¥æ¢¯åº¦ç®—æ³•</li>
</ul>
</li>
<li><p><strong>æ‰§è¡Œè€…/è¯„è®ºè€…</strong>æ–¹æ³• = ä»·å€¼æ›´æ–° + ç­–ç•¥æ›´æ–° (ä»·å€¼æ›´æ–°éƒ¨åˆ†ä½¿ç”¨æ·±åº¦å¼ºåŒ–å­¦ä¹ æ–¹æ³•+å•æ­¥æ—¶åºå·®åˆ†ï¼Œç­–ç•¥æ›´æ–°ä¹Ÿæ˜¯ç”¨æ·±åº¦å¼ºåŒ–å­¦ä¹ æ–¹æ³•)</p>
<ul>
<li><p><strong>åŠ¨ä½œä»·å€¼</strong>æ‰§è¡Œè€…è¯„è®ºè€…ç®—æ³• $E(\Psi_t \nabla \ln\pi(a_t|s_t;\theta)), \Psi_t=\gamma^tq_{\pi}(s_t,a_t)$</p>
</li>
<li><p><strong>A2C-ä¼˜åŠ¿</strong>æ‰§è¡Œè€…/è¯„è®ºè€…ç®—æ³• $\Psi_t=\gamma^t[q_{\pi}(s_t,a_t)-v_{\pi}(s_t)]$</p>
</li>
<li><p><strong>æ—¶åºå·®åˆ†</strong>æ‰§è¡Œè€…/è¯„è®ºè€…ç®—æ³• $\Psi_t=\gamma^t[r_{t+1}+\gamma v_{\pi}(s_{t+1})-v_{\pi}(s_t)]$</p>
</li>
<li><p><strong>A3C-å¼‚æ­¥</strong>ä¼˜åŠ¿æ‰§è¡Œè€…/è¯„è®ºè€…ç®—æ³•ï¼›åˆ©ç”¨å¤šä¸ªagentåŒæ—¶æœé›†ç»éªŒæ›´æ–°è‡ªå·±çš„å‚æ•°å¹¶ä¼ ç»™ä¸€ä¸ªæ€»çš„agentï¼Œå¯ä»¥å•/å¤šæ­¥æ—¶åºå·®åˆ†</p>
</li>
<li><p>å¸¦<strong>èµ„æ ¼è¿¹</strong>çš„æ‰§è¡Œè€…è¯„è®ºè€…ç®—æ³•</p>
</li>
<li><p>åŸºäº<strong>ä»£ç†ä¼˜åŠ¿</strong>çš„åŒç­–ç®—æ³•</p>
<ul>
<li><strong>é‚»è¿‘ç­–ç•¥ä¼˜åŒ–PPO2</strong>ï¼Œåœ¨ç›®æ ‡ä¸­æ·»åŠ æè¿°åˆ†å¸ƒå·®å¼‚çš„æŒ‡æ ‡ï¼Œ$E_{\pi(\theta_{old})}[\min(\frac{\pi(A_t|S_t;\theta_{new})}{\pi(A_t|S_t;\theta_{old})}a_{\pi(\theta_{old})}(S_a,A_t), a_{\pi(\theta_{old})}(S_a,A_t)+\varepsilon|a_{\pi(\theta_{old})}(S_a,A_t)|)]$</li>
</ul>
</li>
<li><p><strong>ä¿¡ä»»åŸŸç®—æ³•</strong></p>
<ul>
<li><p><strong>è‡ªç„¶ç­–ç•¥æ¢¯åº¦ç®—æ³•NPG</strong>ï¼Œæœ€å¤§åŒ–ä»£ç†ä¼˜åŠ¿ï¼Œå¹¶æ·»åŠ çº¦æŸæ¡ä»¶ï¼ŒKLæ•£åº¦å°äº$\delta$ï¼Œä½†NPGæ˜¯å¯¹ç›®æ ‡å‡½æ•°è¿›è¡Œæ³°å‹’ä¸€é˜¶è¿‘ä¼¼ï¼Œçº¦æŸæ¡ä»¶è¿›è¡Œæ³°å‹’äºŒé˜¶è¿‘ä¼¼ã€‚å¯¹è¿‘ä¼¼åçš„é—®é¢˜è¿›è¡Œæ±‚è§£ã€‚</p>
<p>$\mathbf{\theta} \leftarrow \mathbf{\theta} +  \sqrt{\frac{2\delta}{\mathbf{g^TF^{-1}g}}}\mathbf{F^{-1}g}$</p>
</li>
<li><p>å¸¦å…±è½­æ¢¯åº¦çš„è‡ªç„¶ç­–ç•¥æ¢¯åº¦ç®—æ³•</p>
<p>åˆ©ç”¨å…±è½­æ¢¯åº¦ç®—æ³•æ±‚è§£$\mathbf{F^{-1}g}ï¼Œ\mathbf{Fx=g}$ï¼Œ$\mathbf{\theta} \leftarrow \mathbf{\theta} +  \sqrt{\frac{2\delta}{\mathbf{x^TFx}}}\mathbf{x}$</p>
</li>
<li><p><strong>ä¿¡èµ–åŸŸç­–ç•¥ä¼˜åŒ–TRPO</strong>ï¼Œåœ¨NPGçš„åŸºç¡€ä¸Šä¿®æ”¹å¾—åˆ°ï¼Œå› ä¸ºå…¶è¿‘ä¼¼é—®é¢˜å¯èƒ½ä¸ä¸€å®šå¯¼è‡´é—®é¢˜æœ‰æœ€ä¼˜è§£ï¼Œåœ¨ä¸ªåˆ«æƒ…å†µä¸‹å¯èƒ½ä½¿æƒ…å†µæ›´ç³Ÿï¼ŒTRPOå¯¹è¿­ä»£å¼è¿›è¡Œæ”¹è¿›<br>$$<br>\boldsymbol{\theta_{k+1} = \theta_k}+\alpha^j \sqrt{\frac{2\delta}{\boldsymbol{[x([\theta_k])^T]Fx([\theta_k])}}}\boldsymbol{x([\theta_k])}<br>$$<br>å…¶ä¸­$\alpha$æ˜¯å­¦ä¹ å‚æ•°ï¼Œ$j$æ˜¯æŸä¸ªéè´Ÿæ•´æ•°ï¼Œå¯¹äºè‡ªç„¶ç­–ç•¥æ¢¯åº¦$j$æ€»æ˜¯0ï¼ŒTRPOç”¨ä¸€ä¸‹æ–¹æ³•ç¡®å®š$j$çš„å€¼ï¼šä»éè´Ÿæ•´æ•°dåˆ°0ï¼Œ1ï¼Œ2â€¦ä¸­ä¾æ¬¡å¯»æ‰¾é¦–ä¸ªæ»¡è¶³æœŸæœ›KLæ•£åº¦çº¦æŸå¹¶ä¸”èƒ½å¤Ÿæå‡ä»£ç†æ¢¯åº¦çš„å€¼ã€‚ä¸è¿‡ç”±äºä¸€èˆ¬è¿‘ä¼¼çš„ä¸é”™ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸º0ï¼Œä¸ªåˆ«æƒ…å†µä¸º1ï¼Œå…¶ä»–å€¼å‡ ä¹æ²¡æœ‰ã€‚</p>
</li>
<li><p><strong>Kroneckerå› å­ä¿¡ä»»åŸŸæ‰§è¡Œè€…/è¯„è®ºè€…ç®—æ³• ACKTR</strong>ï¼Œå°†Kroneckerå› å­è¿‘ä¼¼æ›²ç‡ç®—æ³•ç”¨åˆ°ä¿¡ä»»åŸŸç­–ç•¥ä¼˜åŒ–ç®—æ³•ä¸­ï¼Œå‡å°‘è®¡ç®—é‡</p>
</li>
</ul>
</li>
<li><p>é‡è¦æ€§é‡‡æ ·å¼‚ç­–æ‰§è¡Œè€…/è¯„è®ºè€…ç®—æ³•</p>
<ul>
<li><strong>å¼‚ç­–</strong>æ‰§è¡Œè€…/è¯„è®ºè€…ç®—æ³•ï¼Œå°†ç›®æ ‡æœŸæœ›$E_{\pi(\boldsymbol{\theta})}(\Psi_t \nabla \ln\pi(a_t|s_t;\theta))$ï¼Œå˜ä¸º$E_b(\frac{\pi(A_t|S_t;\boldsymbol{\theta})}{b(A_t|S_t)}\Psi_t \nabla \ln\pi(a_t|s_t;\theta))$</li>
<li><strong>å¸¦ç»éªŒå›æ”¾çš„å¼‚ç­–</strong>æ‰§è¡Œè€…/è¯„è®ºè€…ç®—æ³•ï¼ˆ<strong>ACER</strong>ï¼‰</li>
</ul>
</li>
<li><p><strong>æŸ”æ€§æ‰§è¡Œè€…/è¯„è®ºè€…ç®—æ³•ï¼ˆSACï¼‰</strong></p>
</li>
<li><p>ç¡®å®šæ€§ç­–ç•¥</p>
<ul>
<li>åŒç­–ç¡®å®šæ€§ç®—æ³•</li>
<li>å¼‚ç­–ç¡®å®šæ€§ç®—æ³•</li>
<li><strong>æ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•(DDPG)</strong></li>
<li><strong>åŒé‡å»¶è¿Ÿæ·±åº¦ç¡®å®šæ€§ç­–ç•¥æ¢¯åº¦ç®—æ³•(TD3)</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="5-æ·±åº¦å¼ºåŒ–å­¦ä¹ -éæ·±åº¦å¼ºåŒ–å­¦ä¹ "><a href="#5-æ·±åº¦å¼ºåŒ–å­¦ä¹ -éæ·±åº¦å¼ºåŒ–å­¦ä¹ " class="headerlink" title="5. æ·±åº¦å¼ºåŒ–å­¦ä¹ /éæ·±åº¦å¼ºåŒ–å­¦ä¹ "></a>5. æ·±åº¦å¼ºåŒ–å­¦ä¹ /éæ·±åº¦å¼ºåŒ–å­¦ä¹ </h2><ul>
<li>æ·±åº¦Qå­¦ä¹ </li>
<li>åŒé‡æ·±åº¦Qç½‘ç»œ</li>
<li>å¯¹å¶æ·±åº¦Qç½‘ç»œ<ul>
<li>å¯¹äºæŸä¸ªçŠ¶æ€Sï¼Œæœ‰äº›actionå¯èƒ½é‡‡æ ·ä¸åˆ°ï¼Œä½†é€šè¿‡å¯¹å¶æ·±åº¦Qç½‘ç»œä¹Ÿå¯ä»¥æ›´æ–°</li>
</ul>
</li>
<li>Noise Net<ul>
<li>å¯¹é‡‡æ ·çš„Qç½‘ç»œçš„å‚æ•°æ·»åŠ å™ªå£°ï¼Œæ¢ç´¢</li>
</ul>
</li>
<li>Distributional Q_function<ul>
<li>è¯¥æ–¹æ³•è®¤ä¸ºQ(s, a)æœ‰ä¸€ä¸ªåˆ†å¸ƒï¼Œå³ç›¸åŒçš„çŠ¶æ€å’Œè¡Œä¸ºçš„ä»·å€¼ï¼Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒï¼Œç”¨ç¥ç»ç½‘ç»œä¼°è®¡è¿™ä¸ªåˆ†å¸ƒ</li>
</ul>
</li>
</ul>
<h2 id="6-ç¦»çº¿å­¦ä¹ -åœ¨çº¿å­¦ä¹ ï¼ˆå¾…æ›´ï¼‰"><a href="#6-ç¦»çº¿å­¦ä¹ -åœ¨çº¿å­¦ä¹ ï¼ˆå¾…æ›´ï¼‰" class="headerlink" title="6. ç¦»çº¿å­¦ä¹ /åœ¨çº¿å­¦ä¹ ï¼ˆå¾…æ›´ï¼‰"></a>6. ç¦»çº¿å­¦ä¹ /åœ¨çº¿å­¦ä¹ ï¼ˆå¾…æ›´ï¼‰</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/09/%E8%B5%84%E6%A0%BC%E8%BF%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/09/%E8%B5%84%E6%A0%BC%E8%BF%B9/" class="post-title-link" itemprop="url">èµ„æ ¼è¿¹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-02-09 11:36:47" itemprop="dateCreated datePublished" datetime="2021-02-09T11:36:47+08:00">2021-02-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-03-15 17:30:13" itemprop="dateModified" datetime="2021-03-15T17:30:13+08:00">2021-03-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å¦‚ä½•ç†è§£èµ„æ ¼è¿¹"><a href="#å¦‚ä½•ç†è§£èµ„æ ¼è¿¹" class="headerlink" title="å¦‚ä½•ç†è§£èµ„æ ¼è¿¹"></a>å¦‚ä½•ç†è§£èµ„æ ¼è¿¹</h1><p>è€ƒè™‘è¿™æ ·ä¸€ä¸ªå›åˆ$S_0,A_0,R_1,S_1,A_1,â€¦,R_n,S_n,A_n$</p>
<p>æˆ‘ä»¬çŸ¥é“å¯¹äº $(S_0,A_0)$è®¡ç®—$q_(S_0,A_0)$ï¼Œå¯ä»¥ç”¨$U(S_0,A_0)=R_1+q(S_1,A_1)$è¿‘ä¼¼ä¸ºçœŸå®å€¼å»æ›´æ–°$q_(S_0,A_0)$ï¼Œè¿™ä¸ªæ—¶å€™æ—¶åºè¯¯å·®ä¸º$TD_{error}=U(S_0,A_0)-q(S_0,A_0)$ï¼Œæ—¶åºè¯¯å·®æ‰€åŒ…å«çš„ä¿¡æ¯å…¨éƒ¨ç”¨æ¥æ›´æ–°$q_(S_0,A_0)$</p>
<p>$(S_5,A_5)$æ—¶ï¼Œ</p>
<p>$U(S_5,A_5)=R_6+\gamma q(S_6,A_6)$</p>
<p>$U(S_0,A_0)=R_1+\gamma R_2+\gamma ^2R_3+\gamma ^3R_4+\gamma ^4R_5+\gamma ^5U(S_5,A_5) $</p>
<p>è¿™ä¸ªæ—¶å€™$(S_5,A_5)$å¤„çš„æ—¶åºè¯¯å·®å¯¹äºæ›´æ–° $(S_0,A_0)$å¤„çš„$q_(S_0,A_0)$æ‰€äº§ç”Ÿçš„ä½œç”¨æ˜¯$\gamma ^5 *TD_{error}$</p>
<p>ä»ä¸Šå¼å¯ä»¥çœ‹å‡ºä¸$(S_0,A_0)$çŠ¶æ€ç›¸è·è¶Šè¿œçš„$(S_k,A_k)$æ‰€äº§ç”Ÿçš„æ—¶åºè¯¯å·®å¯¹äº$(S_0,A_0)$æ‰€èµ·çš„ä½œç”¨å°±è¶Šå°ï¼Œæ‰€ä»¥é—´éš”æ­¥æ•°æ¯å¢åŠ ä¸€æ­¥ï¼Œå‰é¢çš„æ¯ä¸ªåŠ¨ä½œçŠ¶æ€å¯¹çš„èµ„æ ¼è¿¹éƒ½è¦è¿›è¡Œè¡°å‡.</p>
<p>æ¯”å¦‚åœ¨$t=4$æ—¶ï¼Œ</p>
<p>$U(S_0,A_0):\gamma^4,U(S_1,A_1):\gamma^3ï¼ŒU(S_2,A_2):\gamma^2ï¼ŒU(S_3,A_3):\gamma$ã€‚</p>
<p>å‰è¿›ä¸€æ­¥ï¼Œ$t=5$æ—¶,</p>
<p>$U(S_0,A_0):\gamma^5,U(S_1,A_1):\gamma^4ï¼ŒU(S_2,A_2):\gamma^3ï¼ŒU(S_3,A_3):\gamma^2ï¼ŒU(S_4,A_4):\gamma$</p>
<p>è€Œå¯¹äº$TD(\lambda)$ æ¥è¯´</p>
<p>$U(S_0,A_0)=R_1+q(S_1,A_1)\qquad 1-\lambda$</p>
<p>$U(S_0,A_0)=R_1+\gamma U(S_1,A_1) \qquad (1-\lambda)\lambda$</p>
<p>$U(S_0,A_0)=R_1+\gamma R_2+\gamma ^2 U(S_2,A_2) \qquad (1-\lambda)\lambda ^2$</p>
<p>â€¦â€¦.</p>
<p>æ‰€ä»¥å…¶é—´éš”æ­¥æ•°æ¯å¢åŠ ä¸€æ­¥ï¼Œå½“å‰çŠ¶æ€åŠ¨ä½œä»·å€¼äº§ç”Ÿçš„æ—¶åºè¯¯å·®ï¼Œç”¨åˆ°æ›´æ–°å‰é¢çš„çŠ¶æ€åŠ¨ä½œä»·å€¼æ—¶è¦ç›¸åº”çš„è¡°å‡å¯¹åº”$\gamma\lambda$æ¬¡å¹‚ã€‚</p>
<p>è€ƒè™‘èµ„æ ¼è¿¹å…¶å®çœ‹èµ·æ¥å¾ˆåˆç†ï¼Œå› ä¸ºå½“å›åˆè½¨è¿¹é€æ¸å»¶ä¼¸ï¼Œä¸ä»…å½“å‰çš„åŠ¨ä½œçŠ¶æ€ä»·å€¼éœ€è¦æ›´æ–°ï¼Œç”±äºæ–°çš„ä¿¡æ¯çš„å‡ºç°ï¼Œåˆä¼šä½¿å¾—ä¹‹å‰å·²ç»æ›´æ–°çš„åŠ¨ä½œçŠ¶æ€ä»·å€¼ï¼Œå’Œæˆ‘ä»¬çš„$U$(ç±»ä¼¼æœºå™¨å­¦ä¹ çš„ç›®æ ‡)ä¹‹é—´é‡æ–°äº§ç”Ÿæ–°çš„è¯¯å·®ï¼Œæˆ‘ä»¬ç†åº”å°†è¿™éƒ¨åˆ†è€ƒè™‘åˆ°æŸå¤±å‡½æ•°ä¸­ï¼Œè¿›è¡Œæ¢¯åº¦æ›´æ–°ã€‚</p>
<h1 id="å¸¦èµ„æ ¼è¿¹çš„æ¢¯åº¦ä¸‹é™"><a href="#å¸¦èµ„æ ¼è¿¹çš„æ¢¯åº¦ä¸‹é™" class="headerlink" title="å¸¦èµ„æ ¼è¿¹çš„æ¢¯åº¦ä¸‹é™"></a>å¸¦èµ„æ ¼è¿¹çš„æ¢¯åº¦ä¸‹é™</h1><p>ã€Šå¼ºåŒ–å­¦ä¹ å¯¼è®ºã€‹Richard S.Suttonï¼šèµ„æ ¼è¿¹$\mathbf{z}_t$æ˜¯ä¸€ä¸ªå’Œæƒå€¼å‘é‡$\mathbf{w}_t$ åŒç»´åº¦çš„å‘é‡ï¼Œåœ¨$TD(\lambda)$ä¸­ï¼Œèµ„æ ¼è¿¹å‘é‡è¢«åˆå§‹åŒ–ä¸ºé›¶ï¼Œç„¶ååœ¨æ¯ä¸€æ­¥ç´¯åŠ ä»·å€¼å‡½æ•°çš„æ¢¯åº¦ï¼Œä»¥$\gamma\lambda$</p>
<p>$$<br>\begin{align}<br>\mathbf{z_{-1}} &amp;= \mathbf{0}, \\<br>\mathbf{z_t} &amp;= \gamma\lambda\mathbf{z_{t-1}}+\nabla\hat{v}(S_t,\mathbf{w_t}), 0 \leq t\leq T<br>\end{align}<br>$$<br>æŸä¸€æ—¶åˆ»çš„å•æ­¥æ—¶åºå·®åˆ†è¯¯å·®ä¸º<br>$$<br>\delta_t=R_{t+1}+\gamma\hat{v}(S_{t+1},\mathbf{w_t})-\hat{v}(S_t,\mathbf{w_t})<br>$$<br>åœ¨$TD(\lambda)$ä¸­ï¼Œæƒå€¼å‘é‡æ¯ä¸€æ­¥çš„æ›´æ–°æ­£æ¯”äºæ—¶åºå·®åˆ†çš„æ ‡é‡çš„è¯¯å·®å’Œèµ„æ ¼è¿¹ã€‚<br>$$<br>\mathbf{w_{t+1}}=\mathbf{w_t}+\alpha\delta_t\mathbf{z_t}<br>$$<br>å½“æ—¶çœ‹èµ„æ ¼è¿¹æ—¶å€™ç‰¹åˆ«è¿·è¿™ä¸€éƒ¨åˆ†ï¼Œå…¶å®è‡ªå·±ç¨å¾®æ¨å¯¼ä¸¤ä¸ªå›åˆå°±æ˜ç™½äº†ã€‚è¿™é‡Œçš„èµ„æ ¼è¿¹å…¶å®å°±æ˜¯æŠŠåé¢çš„æ¢¯åº¦ä¸­çš„å­¦ä¹ ç‡å’Œæ—¶åºè¯¯å·®æå‡ºæ¥å‰©ä¸‹çš„å†…å®¹ã€‚å› ä¸ºæ˜¯åˆ©ç”¨å‡½æ•°è¿‘ä¼¼ï¼Œæ‰€ä»¥ä¼šåŒ…å«ä»·å€¼çš„æ¢¯åº¦ã€‚å…·ä½“æ¨å¯¼ä¸¤æ­¥ã€‚</p>
<p>å½“$t=0$æ—¶ï¼š<br>$$<br>\begin{align*}<br>U(S_0) &amp;= R_1+\gamma v(S_1,\mathbf{w_0}) \\<br>Loss &amp;= [U(S_0)-v(S_0,\mathbf{w_0})]^2 \\<br>\mathbf{w_1} &amp;= \mathbf{w_0}+\alpha[U(S_0)-v(S_0,\mathbf{w_0})]\nabla v(S_0,\mathbf{w_0}) \\<br>             &amp;= \mathbf{w_0}+\alpha\delta_0\nabla v(S_0,\mathbf{w_0}) \\<br>\mathbf{z_0} &amp;=\mathbf{0} + \nabla v(S_0,\mathbf{w_0})<br>\end{align*}<br>$$<br>ä»ä¸Šå¼èµ„æ ¼è¿¹å¯ä»¥çœ‹å‡ºï¼Œå…¶å’Œæƒå€¼å‘é‡æ˜¯åŒç»´åº¦çš„ã€‚</p>
<p>å½“$t=1$æ—¶ï¼š<br>$$<br>U(S_1)=R_2+\gamma v(S_2,\mathbf{w_1})<br>$$<br>è¿™æ—¶æ—¶åºè¯¯å·®ä¸º$\delta_1=U(S_1)-v(S_1)$ï¼Œè€Œ$U(S_0) = R_1 + \gamma U(S_1)$ï¼Œæ‰€ä»¥åœ¨$TD(\lambda)$ä¸‹ï¼Œ$U(S_0)$å’Œ$v(S_0,\mathbf{w_1})$çš„è¯¯å·®ä¸º$\gamma\lambda\delta_1$ï¼Œè¿™ä¸¤éƒ¨åˆ†çš„è¯¯å·®ç†åº”éƒ½è€ƒè™‘ï¼Œè¿™ä¸ªæ—¶å€™çš„æŸå¤±å‡½æ•°å°±å˜ä¸º<br>$$<br>Loss=[U(S_0)-v(S_0,\mathbf{w_1})]^2 + [U(S_1)-v(S_1,\mathbf{w_1})]^2<br>$$<br>è¿›è¡Œæ¢¯åº¦æ›´æ–°<br>$$<br>\begin{align*}<br>\mathbf{w_2} &amp;= \mathbf{w_1}+\alpha[U(S_0)-v(S_0,\mathbf{w_1})]\nabla v(S_0,\mathbf{w_1})+ \alpha[U(S_1)-v(S_1,\mathbf{w_1})]\nabla v(S_1,\mathbf{w_1})\\<br>             &amp;= \mathbf{w_1}+\alpha\gamma\lambda\delta_1\nabla v(S_0,\mathbf{w_1}) +\alpha\delta_1\nabla v(S_1,\mathbf{w_1})\\<br>\end{align*}<br>$$<br>æŠŠå­¦ä¹ ç‡å’Œæ—¶åºè¯¯å·®$\delta _1$æå‡ºæ¥ï¼Œå¾—åˆ°èµ„æ ¼è¿¹<br>$$<br>\mathbf{z_1} =\gamma\lambda\nabla v(S_0,\mathbf{w_1}) + \nabla v(S_1,\mathbf{w_1})<br>$$<br>ç”±äº$\nabla v(S_0,\mathbf{w_0})=\nabla v(S_0,\mathbf{w_1})$ï¼Œæ‰€ä»¥<br>$$<br>\mathbf{z_1} =\gamma\lambda\mathbf{z_0} + \nabla v(S_1,\mathbf{w_1})<br>$$<br>ä»¥æ¬¡å¾€ä¸‹æ›´æ–°â€¦â€¦</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/02/06/DP-MC-TD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/06/DP-MC-TD/" class="post-title-link" itemprop="url">DP\MC\TD</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-02-06 16:48:28" itemprop="dateCreated datePublished" datetime="2021-02-06T16:48:28+08:00">2021-02-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-02-07 20:04:50" itemprop="dateModified" datetime="2021-02-07T20:04:50+08:00">2021-02-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-æœ‰æ¨¡å‹æ•°å€¼è¿­ä»£"><a href="#1-æœ‰æ¨¡å‹æ•°å€¼è¿­ä»£" class="headerlink" title="1. æœ‰æ¨¡å‹æ•°å€¼è¿­ä»£"></a>1. æœ‰æ¨¡å‹æ•°å€¼è¿­ä»£</h1><h2 id="1-1-ä¸»è¦æ€æƒ³"><a href="#1-1-ä¸»è¦æ€æƒ³" class="headerlink" title="1.1 ä¸»è¦æ€æƒ³"></a>1.1 ä¸»è¦æ€æƒ³</h2><p>æœ‰æ¨¡å‹æ•°å€¼è¿­ä»£ä¸»è¦åˆ©ç”¨<strong>åŠ¨æ€è§„åˆ’ï¼ˆDynamic Programmingï¼ŒDPï¼‰</strong>çš„æ€æƒ³ã€‚ </p>
<p>åŠ¨æ€è§„åˆ’è¿­ä»£ç®—æ³•è¿ç”¨äº†è‡ªç›Šçš„æ€æƒ³ã€‚ä½†åœ¨å®é™…é—®é¢˜ä¸­ï¼Œç›´æ¥ä½¿ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•å¸¸å‡ºç°å›°éš¾ï¼Œä»ä¸‹é¢çš„çŠ¶æ€åŠ¨ä½œä»·å€¼è¿­ä»£å¯ä»¥çœ‹å‡ºï¼Œå®é™…é—®é¢˜çš„çŠ¶æ€ç©ºé—´éå¸¸å¤§ï¼Œä»…ä»…æ˜¯æ‰«æä¸€éæ‰€æœ‰çš„çŠ¶æ€éƒ½æ˜¯ä¸å¯èƒ½çš„äº‹æƒ…ã€‚<br>$$<br>q_{pi}(s_t,a_t)=r(s_t,a_t)+\gamma \sum_{sâ€™}p(sâ€™|s_t,a_t)v_{\pi}(sâ€™)<br>$$</p>
<blockquote>
<p><strong>è‡ªç›Š</strong>ï¼šç”¨ä¸€ä¸ªä¼°è®¡å€¼æ¥ä¼°è®¡å¦å¤–ä¸€ä¸ªä¼°è®¡å€¼</p>
</blockquote>
<p><strong>æ–¹æ³•æ”¹è¿›ï¼šå¼‚æ­¥åŠ¨æ€è§„åˆ’</strong></p>
<p>å¼‚æ­¥åŠ¨æ€è§„åˆ’çš„æ€æƒ³æ˜¯ï¼Œæ¯æ¬¡æ‰«æä¸å†å®Œæ•´çš„æ›´æ–°ä¸€æ•´å¥—çŠ¶æ€ä»·å€¼å‡½æ•°ï¼Œè€Œåªæ˜¯éƒ¨åˆ†æ›´æ–°æ„Ÿå…´è¶£çš„å€¼ã€‚ä¾‹å¦‚ï¼Œæœ‰çš„çŠ¶æ€sä¸ä¼šè½¬ç§»åˆ°å¦ä¸€äº›çŠ¶æ€ï¼ˆ$p(sâ€™|s,a)=0$$çš„çŠ¶æ€$$sâ€™$ï¼‰</p>
<h2 id="1-2-ç†è®ºåŸºç¡€"><a href="#1-2-ç†è®ºåŸºç¡€" class="headerlink" title="1.2 ç†è®ºåŸºç¡€"></a>1.2 ç†è®ºåŸºç¡€</h2><p>ç†è®ºåŸºç¡€ï¼š<strong>åº¦é‡ç©ºé—´ä¸Šçš„Banachä¸åŠ¨ç‚¹å®šç†</strong></p>
<p>ä¹‹æ‰€ä»¥æ˜¯æœ‰æ¨¡å‹çš„ä»·å€¼è¿­ä»£ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬çŸ¥é“å…¶åŠ¨åŠ›ç³»ç»Ÿ$p(sâ€™|s,a)$ï¼Œå³è½¬ç§»æ¦‚ç‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä»ä»ä¸€ä¸ªç¡®å®šæ€§ç­–ç•¥å‡ºå‘ï¼Œç»è¿‡ä¸æ–­ç­–ç•¥è¯„ä¼°ï¼Œç­–ç•¥æ”¹è¿›â€¦â€¦æœ€åæ”¶æ•›åˆ°æœ€ä¼˜ç­–ç•¥ã€‚èƒŒåçš„æ•°å­¦è¯æ˜å°±æ˜¯åº¦é‡ç©ºé—´ä¸Šçš„Banachä¸åŠ¨ç‚¹å®šç†ã€‚</p>
<p><strong>DPçš„ç‰¹ç‚¹</strong></p>
<ol>
<li>åˆ©ç”¨bootstrapingè‡ªç›Šçš„æ€æƒ³</li>
<li>æ²¡æœ‰åˆ©ç”¨å¼‚æ­¥åŠ¨æ€è§„åˆ’çš„æ–¹æ³•ï¼Œæ¯æ¬¡è¿­ä»£éœ€è¦æ›´æ–°æ‰€æœ‰çš„çŠ¶æ€</li>
</ol>
<h1 id="2-æ— æ¨¡å‹çš„æ•°å€¼è¿­ä»£"><a href="#2-æ— æ¨¡å‹çš„æ•°å€¼è¿­ä»£" class="headerlink" title="2. æ— æ¨¡å‹çš„æ•°å€¼è¿­ä»£"></a>2. æ— æ¨¡å‹çš„æ•°å€¼è¿­ä»£</h1><h2 id="2-1-Monte-Carlo-MC"><a href="#2-1-Monte-Carlo-MC" class="headerlink" title="2.1 Monte Carlo(MC)"></a>2.1 Monte Carlo(MC)</h2><p><strong>åŸºæœ¬æ€æƒ³</strong>ï¼šåˆ©ç”¨MCä¼°è®¡æœŸæœ›å€¼$V_{\pi}(s)$å’Œ$Q_{\pi}(s,a)$</p>
<p>ä¸¾ä¾‹ï¼šå¯¹äºä¸€ä¸ªå…·ä½“çš„ç­–ç•¥$\pi$æ¥è¯´ï¼Œåˆ©ç”¨è¿™ä¸ªç­–ç•¥ç©nä¸ªå›åˆ</p>
<p>$S_0^1=s,A_0^1=a,R_1^1,S_1^1,A_1^1,R_2^1â€¦â€¦ \qquad G^1$</p>
<p>$S_0^2=s,A_0^2=a,R_1^2,S_1^2,A_1^2,R_2^2â€¦â€¦ \qquad G^2$</p>
<p>$â€¦â€¦$</p>
<p>$S_0^n,A_0^n,R_1^n,S_1^n,A_1^n,R_2^nâ€¦â€¦ \qquad G^n$</p>
<p>åˆ©ç”¨Monte Carloæ¥ä¼°è®¡ä»·å€¼å‡½æ•°$V_{\pi}(s)=\frac{1}{k}(G^1+G^2+â€¦â€¦)$ï¼Œä»ç›¸åŒçŠ¶æ€så‡ºå‘çš„å›åˆç´¯è®¡å›æŠ¥å¹³å‡å€¼ã€‚$Q_{\pi}(s,a)=\frac{1}{k}(G^1+G^2+â€¦â€¦)$ï¼Œä»ç›¸åŒçŠ¶æ€åŠ¨ä½œå¯¹å‡ºå‘çš„å›åˆç´¯è®¡å›æŠ¥å¹³å‡å€¼ã€‚</p>
<p>åˆ©ç”¨Monte Carloè¿›è¡Œæ›´æ–°ï¼Œå®é™…åº”ç”¨ä¸­åˆåˆ†ä¸º<strong>æ¯æ¬¡è®¿é—®å›åˆæ›´æ–°</strong>å’Œ<strong>é¦–æ¬¡è®¿é—®å›åˆæ›´æ–°</strong></p>
<p><strong>MCçš„ç‰¹ç‚¹</strong></p>
<ol>
<li>æ²¡æœ‰åˆ©ç”¨è‡ªç›Šçš„æ€æƒ³</li>
<li>åˆ©ç”¨ç»éªŒå¹³å‡å›æŠ¥çš„æ–¹æ³•æ¥ä¼°è®¡</li>
<li><strong>å±€é™</strong>ï¼šåªèƒ½ç”¨åœ¨æœ‰ç»ˆæ­¢çš„MDPï¼Œæ¯ä¸€æ­¥çš„<strong>R</strong> éƒ½æ˜¯ä¸€ä¸ªå˜é‡ï¼Œç´¯ç§¯åçš„Gæ–¹å·®è¾ƒå¤§ã€‚</li>
<li>æ¯ä¸ªå›åˆåªéœ€è¦æ›´æ–°ä¸€æ¡è¯¥å›åˆè½¨è¿¹ä¸Šçš„çŠ¶æ€</li>
</ol>
<h2 id="2-2-Temporal-Difference-TD"><a href="#2-2-Temporal-Difference-TD" class="headerlink" title="2.2 Temporal Difference(TD)"></a>2.2 Temporal Difference(TD)</h2><h3 id="2-2-1-TD-n"><a href="#2-2-1-TD-n" class="headerlink" title="2.2.1 TD(n)"></a>2.2.1 TD(n)</h3><p>å¯¹äºçŠ¶æ€ä»·å€¼æ¥è¯´ï¼Œnæ­¥æ—¶åºå·®åˆ†$TD(n)$ç›®æ ‡ä¸ºï¼š</p>
<p>$U_{t:t+n}^{(v)}=R_{t+1}+\gamma R_{t+2}+â€¦+\gamma ^nq(S_{t+n},A_{t+n})$</p>
<img src="http://ww1.sinaimg.cn/large/0088OO84ly1gnf7vtk8jej30rj0o0di4.jpg" alt="TD(n)" style="zoom:50%;" />

<p>å¯¹äºåŠ¨ä½œçŠ¶æ€ä»·å€¼æ¥è¯´ï¼Œå°†ä¸Šå›¾çš„ç™½åœ†å’Œé»‘åœ†äº’æ¢ã€‚ä»¥TD(0)ä¸ºä¾‹ï¼Œæ›´æ–°åŠ¨ä½œçŠ¶æ€ä»·å€¼å¯ä»¥è¡¨ç¤ºä¸º<br>$$<br>U_t=R_{t+1}+\gamma q(S_{t+1},A_{t+1}) \<br>q(S_t,A_t)\gets q(S_t,A_t)+\alpha[U_t-q(S_t,A_t)]<br>$$<br>ä»ä¸Šå¼å¯ä»¥çœ‹å‡ºï¼ŒTD(n)æ˜¯åˆ©ç”¨äº†<strong>è‡ªç›Š</strong>çš„æ€æƒ³ã€‚</p>
<p>å¯¹äºæ—¶åºå·®åˆ†æ¥è¯´<br>$$<br>q_{target}(S_t,A_t)=E[R_{t+1}+ q(S_{t+1},A_{t+1}]<br>$$<br>åœ¨å®é™…åº”ç”¨ä¸­æˆ‘ä»¬ç”¨<br>$$<br>U_t=R_{t+1}+\gamma q(S_{t+1},A_{t+1})\approx q_{target}(S_t,A_t)<br>$$</p>
<h3 id="2-2-2-SARSA"><a href="#2-2-2-SARSA" class="headerlink" title="2.2.2 SARSA"></a>2.2.2 SARSA</h3><ol>
<li><p>å•æ­¥SARSAï¼šå•æ­¥æ—¶åºå·®åˆ†ç›®æ ‡ï¼ˆç­–ç•¥è¯„ä¼°ï¼‰ +  ç­–ç•¥æ”¹è¿›</p>
</li>
<li><p>å¤šæ­¥SARSAï¼šå¤šæ­¥æ—¶åºå·®åˆ†ç›®æ ‡ï¼ˆç­–ç•¥è¯„ä¼°ï¼‰ +  ç­–ç•¥æ”¹è¿›</p>
</li>
<li><p><strong>æœŸæœ›SARSA</strong>ï¼š$U_t=R_{t+1}+\gamma \sum_{a\in \mathcal{A}}\pi(a|S_{t+1})q(S_{t+1},a)$ ä¹Ÿæœ‰å•æ­¥å’Œå¤šæ­¥</p>
</li>
</ol>
<p><strong>TD</strong>çš„ç‰¹ç‚¹ï¼š</p>
<ol>
<li>å¯ä»¥ä»ä¸å®Œæ•´çš„è½¨è¿¹ä¸­å­¦ä¹ </li>
<li>ä»‹äºMCå’ŒDPä¹‹é—´çš„æ–¹æ³•</li>
<li>æœ‰samplingï¼ˆæœŸæœ›çš„è¿‘ä¼¼ï¼‰å’Œbootstraping</li>
<li>æ–¹å·®è¾ƒäºMCæ›´å°</li>
<li>å¯ä»¥åœ¨çº¿å­¦ä¹ ï¼Œæ¯èµ°ä¸€æ­¥å°±æ›´æ–°</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/30/%E9%95%9C%E5%83%8F%E8%AE%BE%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/30/%E9%95%9C%E5%83%8F%E8%AE%BE%E7%BD%AE/" class="post-title-link" itemprop="url">é•œåƒè®¾ç½®</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-01-30 10:33:09 / ä¿®æ”¹æ—¶é—´ï¼š11:34:54" itemprop="dateCreated datePublished" datetime="2021-01-30T10:33:09+08:00">2021-01-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä»¥æ¸…åå¤§å­¦é•œåƒæºä¸ºä¾‹(<a target="_blank" rel="noopener" href="https://pypi.tuna.tsinghua.edu.cn/simple/">https://pypi.tuna.tsinghua.edu.cn/simple/</a>)</p>
<h1 id="pypié•œåƒ"><a href="#pypié•œåƒ" class="headerlink" title="pypié•œåƒ"></a>pypié•œåƒ</h1><h2 id="ä¸´æ—¶ä½¿ç”¨"><a href="#ä¸´æ—¶ä½¿ç”¨" class="headerlink" title="ä¸´æ—¶ä½¿ç”¨"></a>ä¸´æ—¶ä½¿ç”¨</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some_package</span><br></pre></td></tr></table></figure>
<h2 id="è®¾ä¸ºé»˜è®¤"><a href="#è®¾ä¸ºé»˜è®¤" class="headerlink" title="è®¾ä¸ºé»˜è®¤"></a>è®¾ä¸ºé»˜è®¤</h2><p>å‡çº§pipåˆ°æœ€æ–°çš„ç‰ˆæœ¬(&gt;=10.0.0)åè¿›è¡Œé…ç½®</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install pip -U</span><br><span class="line">pip config <span class="built_in">set</span> <span class="keyword">global</span>.index-url https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>
<p>å¦‚æœ pip é»˜è®¤æºçš„ç½‘ç»œè¿æ¥è¾ƒå·®ï¼Œä¸´æ—¶ä½¿ç”¨æœ¬é•œåƒç«™æ¥å‡çº§ pipï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pip -U</span><br></pre></td></tr></table></figure>
<h2 id="pipå®‰è£…æœ¬åœ°åŒ…"><a href="#pipå®‰è£…æœ¬åœ°åŒ…" class="headerlink" title="pipå®‰è£…æœ¬åœ°åŒ…"></a>pipå®‰è£…æœ¬åœ°åŒ…</h2><p><code>pip install  ï½/Downloads/a.whl</code></p>
<h2 id="å›½å†…å¸¸ç”¨PyPIé•œåƒç½‘ç«™"><a href="#å›½å†…å¸¸ç”¨PyPIé•œåƒç½‘ç«™" class="headerlink" title="å›½å†…å¸¸ç”¨PyPIé•œåƒç½‘ç«™"></a>å›½å†…å¸¸ç”¨PyPIé•œåƒç½‘ç«™</h2><p>è±†ç“£ï¼š <a target="_blank" rel="noopener" href="https://pypi.doubanio.com/simple/">https://pypi.doubanio.com/simple/</a> </p>
<p>ç½‘æ˜“ï¼š <a target="_blank" rel="noopener" href="https://mirrors.163.com/pypi/simple/">https://mirrors.163.com/pypi/simple/</a> </p>
<p>é˜¿é‡Œäº‘ï¼š <a target="_blank" rel="noopener" href="https://mirrors.aliyun.com/pypi/simple/">https://mirrors.aliyun.com/pypi/simple/</a> </p>
<p>è…¾è®¯äº‘ï¼š <a target="_blank" rel="noopener" href="https://mirrors.cloud.tencent.com/pypi/simple">https://mirrors.cloud.tencent.com/pypi/simple</a> </p>
<p>æ¸…åå¤§å­¦ï¼š <a target="_blank" rel="noopener" href="https://pypi.tuna.tsinghua.edu.cn/simple/">https://pypi.tuna.tsinghua.edu.cn/simple/</a></p>
<h2 id="condaå¸¸ç”¨å‘½ä»¤åŠå¦‚ä½•åˆ‡æ¢é•œåƒ"><a href="#condaå¸¸ç”¨å‘½ä»¤åŠå¦‚ä½•åˆ‡æ¢é•œåƒ" class="headerlink" title="condaå¸¸ç”¨å‘½ä»¤åŠå¦‚ä½•åˆ‡æ¢é•œåƒ"></a>condaå¸¸ç”¨å‘½ä»¤åŠå¦‚ä½•åˆ‡æ¢é•œåƒ</h2><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">conda activate xxxx <span class="comment">#å¼€å¯xxxxç¯å¢ƒ</span></span><br><span class="line">conda deactivate <span class="comment">#å…³é—­ç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line">conda env <span class="built_in">list</span> <span class="comment">#æ˜¾ç¤ºæ‰€æœ‰çš„è™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">conda info --envs <span class="comment">#æ˜¾ç¤ºæ‰€æœ‰çš„è™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">conda info -e <span class="comment">#æ˜¾ç¤ºæ‰€æœ‰å·²ç»åˆ›å»ºçš„ç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line">conda update -n base conda <span class="comment">#updateæœ€æ–°ç‰ˆæœ¬çš„conda</span></span><br><span class="line"></span><br><span class="line">conda create -n xxxx python=<span class="number">3.6</span> <span class="comment">#åˆ›å»ºpython3.6çš„xxxxè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line">conda remove --name xxxx  --<span class="built_in">all</span> <span class="comment">#å½»åº•åˆ é™¤æ—§ç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line">conda remove -n tensorflow --<span class="built_in">all</span>  <span class="comment">#å½»åº•åˆ é™¤æ—§ç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Condaæ˜¯æ²¡æœ‰é‡å‘½åç¯å¢ƒçš„åŠŸèƒ½, è¦å®ç°è¿™ä¸ªåŸºæœ¬éœ€æ±‚, å¯ä»¥é€šè¿‡å…‹éš†-åˆ é™¤çš„è¿‡ç¨‹ã€‚</span></span><br><span class="line"><span class="comment">#åˆ‡è®°ä¸è¦ç›´æ¥mvç§»åŠ¨ç¯å¢ƒçš„æ–‡ä»¶å¤¹æ¥é‡å‘½å, ä¼šå¯¼è‡´ä¸€ç³»åˆ—æ— æ³•æƒ³è±¡çš„é”™è¯¯çš„å‘ç”Ÿ!</span></span><br><span class="line">conda create --name newname --clone oldname <span class="comment">#å…‹éš†ç¯å¢ƒ</span></span><br><span class="line">conda remove --name oldname --<span class="built_in">all</span> <span class="comment">#å½»åº•åˆ é™¤æ—§ç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line">conda <span class="built_in">list</span>          <span class="comment">#æŸ¥çœ‹å·²ç»å®‰è£…çš„æ–‡ä»¶åŒ…</span></span><br><span class="line">conda <span class="built_in">list</span> -n xxx   <span class="comment">#æŒ‡å®šæŸ¥çœ‹xxxè™šæ‹Ÿç¯å¢ƒä¸‹å®‰è£…çš„package</span></span><br><span class="line">conda update xxx    <span class="comment">#æ›´æ–°xxxæ–‡ä»¶åŒ…</span></span><br><span class="line">conda uninstall xxx <span class="comment">#å¸è½½xxxæ–‡ä»¶åŒ…</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#conda å®‰è£…æœ¬åœ°åŒ…</span></span><br><span class="line">conda install --use-local  ~/Downloads/a.tar.bz2</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ˜¾ç¤ºç›®å‰condaçš„æ•°æ®æºæœ‰å“ªäº›</span></span><br><span class="line">conda config --show channels</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ·»åŠ æ•°æ®æºï¼šä¾‹å¦‚, æ·»åŠ æ¸…åanacondaé•œåƒï¼š</span></span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls yes</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ é™¤æ•°æ®æº</span></span><br><span class="line">conda config --remove channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Condaé…ç½®å›½å†…é•œåƒæº"><a href="#Condaé…ç½®å›½å†…é•œåƒæº" class="headerlink" title="Condaé…ç½®å›½å†…é•œåƒæº"></a>Condaé…ç½®å›½å†…é•œåƒæº</h2><h3 id="æ–¹æ³•1ï¼šç”¨vimæ‰“å¼€æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹é•œåƒæºã€‚æ¨èä½¿ç”¨ä¸­ç§‘å¤§é•œåƒæº"><a href="#æ–¹æ³•1ï¼šç”¨vimæ‰“å¼€æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹é•œåƒæºã€‚æ¨èä½¿ç”¨ä¸­ç§‘å¤§é•œåƒæº" class="headerlink" title="æ–¹æ³•1ï¼šç”¨vimæ‰“å¼€æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹é•œåƒæºã€‚æ¨èä½¿ç”¨ä¸­ç§‘å¤§é•œåƒæº"></a>æ–¹æ³•1ï¼šç”¨vimæ‰“å¼€æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹é•œåƒæºã€‚æ¨èä½¿ç”¨ä¸­ç§‘å¤§é•œåƒæº</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.condarc</span><br><span class="line"><span class="comment">#æ¸…åæº</span></span><br><span class="line">channels:</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/</span><br><span class="line">ssl_verify: true</span><br><span class="line"><span class="comment">#ä¸­ç§‘å¤§æº</span></span><br><span class="line">channels:</span><br><span class="line">  - https://mirrors.ustc.edu.cn/anaconda/pkgs/main/</span><br><span class="line">  - https://mirrors.ustc.edu.cn/anaconda/pkgs/free/</span><br><span class="line">  - https://mirrors.ustc.edu.cn/anaconda/cloud/conda-forge/</span><br><span class="line">ssl_verify: true</span><br><span class="line"><span class="comment">#ä¸Šäº¤å¤§æº</span></span><br><span class="line">channels:</span><br><span class="line">  - https://mirrors.sjtug.sjtu.edu.cn/anaconda/pkgs/main/</span><br><span class="line">  - https://mirrors.sjtug.sjtu.edu.cn/anaconda/pkgs/free/</span><br><span class="line">  - https://mirrors.sjtug.sjtu.edu.cn/anaconda/cloud/conda-forge/</span><br><span class="line">ssl_verify: true</span><br></pre></td></tr></table></figure>
<h3 id="æ–¹æ³•2-åœ¨å‘½ä»¤ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œæ·»åŠ é•œåƒæº"><a href="#æ–¹æ³•2-åœ¨å‘½ä»¤ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œæ·»åŠ é•œåƒæº" class="headerlink" title="æ–¹æ³•2: åœ¨å‘½ä»¤ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œæ·»åŠ é•œåƒæº"></a>æ–¹æ³•2: åœ¨å‘½ä»¤ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œæ·»åŠ é•œåƒæº</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸­ç§‘å¤§é•œåƒæº</span></span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/pkgs/main/</span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/conda-forge/</span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/msys2/</span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/bioconda/</span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/menpo/</span><br><span class="line">conda config --add channels https://mirrors.ustc.edu.cn/anaconda/cloud/</span><br><span class="line"></span><br><span class="line"><span class="comment"># é˜¿é‡Œé•œåƒæº</span></span><br><span class="line">conda config --add channels https://mirrors.aliyun.com/pypi/simple/</span><br><span class="line"></span><br><span class="line"><span class="comment"># è±†ç“£çš„pythonçš„æº</span></span><br><span class="line"></span><br><span class="line">conda config --add channels http://pypi.douban.com/simple/ </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæ£€ç´¢è·¯å¾„ï¼Œæ¯æ¬¡å®‰è£…åŒ…æ—¶ä¼šå°†åŒ…æºè·¯å¾„æ˜¾ç¤ºå‡ºæ¥</span></span><br><span class="line"></span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls yes</span><br><span class="line"></span><br><span class="line">conda config --<span class="built_in">set</span> always_yes <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæ‰€æœ‰é•œåƒé€šé“è·¯å¾„å‘½ä»¤</span></span><br><span class="line"></span><br><span class="line">conda config --show channels</span><br></pre></td></tr></table></figure>
<h3 id="é‡åˆ°ä¸€äº›é—®é¢˜"><a href="#é‡åˆ°ä¸€äº›é—®é¢˜" class="headerlink" title="é‡åˆ°ä¸€äº›é—®é¢˜"></a><strong>é‡åˆ°ä¸€äº›é—®é¢˜</strong></h3><p><strong>condaæ— æ³•åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</strong></p>
<p>1.é€šè¿‡condaåˆ›å»ºè™šæ‹Ÿç¯å¢ƒå‡ºé”™ï¼Œå…³æ‰ç½‘ç»œä»£ç†ä»¥åï¼Œé‡æ–°æ‰“å¼€ç»ˆç«¯å†è¯•è¯•ï¼›</p>
<p>2.æ›´æ¢condaæºè¯•è¯•ï¼›</p>
<p><strong>æ³¨æ„äº‹é¡¹</strong></p>
<p>å®æ„¿æ–°å®‰è£…è™šæ‹Ÿç¯å¢ƒï¼Œä¹Ÿä¸è¦åŒºæŠ˜è…¾pythonå‡çº§å’Œé™çº§çš„é—®é¢˜ï¼Œæ›´ä¸è¦å»åŠ¨ç³»ç»Ÿè‡ªå¸¦çš„pythonç‰ˆæœ¬ï¼ï¼ï¼å¦åˆ™æ“ä½œå¤±è¯¯ï¼Œç»ˆç«¯æ‰“ä¸å¼€é‚£å°±å°´å°¬äº†ï¼</p>
<h3 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h3><ol>
<li>çŸ¥ä¹ï¼š<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/345251737">https://zhuanlan.zhihu.com/p/345251737</a></li>
<li>æ¸…åé•œåƒç½‘ç«™å¸®åŠ©ï¼š<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/pypi/">https://mirrors.tuna.tsinghua.edu.cn/help/pypi/</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Guangshan Shui</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Shuigs18" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Shuigs18" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Guangshan Shui</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

<span id="sitetime"></span>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- è¿”å›dateå¯¹è±¡è·ä¸–ç•Œæ ‡å‡†æ—¶é—´(UTC)1970å¹´1æœˆ1æ—¥åˆå¤œä¹‹é—´çš„æ¯«ç§’æ•°(æ—¶é—´æˆ³)
        year - ä½œä¸ºdateå¯¹è±¡çš„å¹´ä»½ï¼Œä¸º4ä½å¹´ä»½å€¼
        month - 0-11ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æœˆä»½
        day - 1-31ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å¤©æ•°
        hours - 0(åˆå¤œ24ç‚¹)-23ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å°æ—¶æ•°
        minutes - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„åˆ†é’Ÿæ•°
        seconds - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„ç§’æ•°
        microseconds - 0-999ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æ¯«ç§’æ•° */
        var t1 = Date.UTC(2020, 12, 25, 03, 16, 00); //åŒ—äº¬æ—¶é—´2018-2-13 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²è¿è¡Œ " +diffYears+" å¹´ "+diffDays + " å¤© " + diffHours + " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
    }/*å› ä¸ºå»ºç«™æ—¶é—´è¿˜æ²¡æœ‰ä¸€å¹´ï¼Œå°±å°†ä¹‹æ³¨é‡Šæ‰äº†ã€‚éœ€è¦çš„å¯ä»¥å–æ¶ˆ*/
    siteTime();
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
