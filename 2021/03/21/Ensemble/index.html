<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="boosting  bagging  stacking   1. boosting ä»£è¡¨ç®—æ³•ï¼šAdaBoost  åªèƒ½åˆ†ç±»ï¼Ÿ å¼±åˆ†ç±»å™¨ï¼šæ¯”è¾ƒç²—ç³™çš„åˆ†ç±»è§„åˆ™ å¼ºåˆ†ç±»å™¨ï¼šç²¾ç¡®çš„åˆ†ç±»è§„åˆ™ æå‡æ–¹æ³•å°±æ˜¯ç»„åˆå¼±åˆ†ç±»å™¨ï¼Œæ„æˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨ å¤§å¤šæ•°çš„æå‡æ–¹æ³•éƒ½æ˜¯æ”¹å˜è®­ç»ƒæ•°æ®çš„æ¦‚ç‡åˆ†å¸ƒï¼ˆè®­ç»ƒæ•°æ®çš„æƒå€¼åˆ†å¸ƒï¼‰ï¼Œé’ˆå¯¹ä¸åŒçš„è®­ç»ƒæ•°æ®åˆ†å¸ƒè°ƒç”¨å¼±å­¦ä¹ ç®—æ³•å­¦ä¹  å¯¹äºæå‡æ–¹æ³•æ¥è¯´æœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦å›ç­”ï¼š  æ¯ä¸€è½®å¦‚ä½•æ”¹å˜è®­ç»ƒæ•°æ®çš„">
<meta property="og:type" content="article">
<meta property="og:title" content="Ensemble">
<meta property="og:url" content="http://example.com/2021/03/21/Ensemble/index.html">
<meta property="og:site_name" content="æ°´å¹¿å±±">
<meta property="og:description" content="boosting  bagging  stacking   1. boosting ä»£è¡¨ç®—æ³•ï¼šAdaBoost  åªèƒ½åˆ†ç±»ï¼Ÿ å¼±åˆ†ç±»å™¨ï¼šæ¯”è¾ƒç²—ç³™çš„åˆ†ç±»è§„åˆ™ å¼ºåˆ†ç±»å™¨ï¼šç²¾ç¡®çš„åˆ†ç±»è§„åˆ™ æå‡æ–¹æ³•å°±æ˜¯ç»„åˆå¼±åˆ†ç±»å™¨ï¼Œæ„æˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨ å¤§å¤šæ•°çš„æå‡æ–¹æ³•éƒ½æ˜¯æ”¹å˜è®­ç»ƒæ•°æ®çš„æ¦‚ç‡åˆ†å¸ƒï¼ˆè®­ç»ƒæ•°æ®çš„æƒå€¼åˆ†å¸ƒï¼‰ï¼Œé’ˆå¯¹ä¸åŒçš„è®­ç»ƒæ•°æ®åˆ†å¸ƒè°ƒç”¨å¼±å­¦ä¹ ç®—æ³•å­¦ä¹  å¯¹äºæå‡æ–¹æ³•æ¥è¯´æœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦å›ç­”ï¼š  æ¯ä¸€è½®å¦‚ä½•æ”¹å˜è®­ç»ƒæ•°æ®çš„">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-21T06:53:52.000Z">
<meta property="article:modified_time" content="2021-03-21T07:05:09.490Z">
<meta property="article:author" content="Guangshan Shui">
<meta property="article:tag" content="ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹">
<meta property="article:tag" content="ã€Šæœºå™¨å­¦ä¹ ã€‹">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2021/03/21/Ensemble/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Ensemble | æ°´å¹¿å±±</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">æ°´å¹¿å±±</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/21/Ensemble/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guangshan Shui">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ°´å¹¿å±±">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Ensemble
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-03-21 14:53:52 / ä¿®æ”¹æ—¶é—´ï¼š15:05:09" itemprop="dateCreated datePublished" datetime="2021-03-21T14:53:52+08:00">2021-03-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <ul>
<li><p>boosting</p>
</li>
<li><p>bagging</p>
</li>
<li><p>stacking</p>
</li>
</ul>
<h1 id="1-boosting"><a href="#1-boosting" class="headerlink" title="1. boosting"></a>1. boosting</h1><ul>
<li><strong>ä»£è¡¨ç®—æ³•ï¼šAdaBoost</strong></li>
</ul>
<p><strong>åªèƒ½åˆ†ç±»ï¼Ÿ</strong></p>
<p>å¼±åˆ†ç±»å™¨ï¼šæ¯”è¾ƒç²—ç³™çš„åˆ†ç±»è§„åˆ™</p>
<p>å¼ºåˆ†ç±»å™¨ï¼šç²¾ç¡®çš„åˆ†ç±»è§„åˆ™</p>
<p>æå‡æ–¹æ³•å°±æ˜¯ç»„åˆå¼±åˆ†ç±»å™¨ï¼Œæ„æˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨</p>
<p>å¤§å¤šæ•°çš„æå‡æ–¹æ³•éƒ½æ˜¯æ”¹å˜è®­ç»ƒæ•°æ®çš„æ¦‚ç‡åˆ†å¸ƒï¼ˆè®­ç»ƒæ•°æ®çš„æƒå€¼åˆ†å¸ƒï¼‰ï¼Œé’ˆå¯¹<strong>ä¸åŒçš„è®­ç»ƒæ•°æ®åˆ†å¸ƒ</strong>è°ƒç”¨å¼±å­¦ä¹ ç®—æ³•å­¦ä¹ </p>
<p>å¯¹äºæå‡æ–¹æ³•æ¥è¯´æœ‰ä¸¤ä¸ªé—®é¢˜éœ€è¦å›ç­”ï¼š</p>
<ol>
<li><p>æ¯ä¸€è½®å¦‚ä½•æ”¹å˜è®­ç»ƒæ•°æ®çš„æƒå€¼æˆ–æ¦‚ç‡åˆ†å¸ƒ </p>
</li>
<li><p>å¦‚ä½•å°†å¼±åˆ†ç±»å™¨ç»„åˆæˆä¸€ä¸ªå¼ºåˆ†ç±»å™¨</p>
</li>
</ol>
<h2 id="1-1-AdaBoost"><a href="#1-1-AdaBoost" class="headerlink" title="1.1 AdaBoost"></a>1.1 AdaBoost</h2><p><strong>AdaBoostçš„åšæ³•ï¼š</strong></p>
<p>é’ˆå¯¹é—®é¢˜1ï¼Œæé«˜è¢«å‰ä¸€è½®å¼±åˆ†ç±»å™¨é”™è¯¯åˆ†ç±»çš„æ ·æœ¬çš„æƒå€¼ï¼Œé™ä½åˆ†ç±»æ­£ç¡®çš„æ ·æœ¬çš„æƒå€¼</p>
<p>é’ˆå¯¹é—®é¢˜2ï¼Œç»„åˆé‡‡ç”¨<strong>åŠ æƒå¤šæ•°è¡¨å†³</strong>çš„æ–¹æ³•</p>
<p><strong>ç®—æ³•8.1 (AdaBoost)</strong></p>
<p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† $T$ ï¼›å¼±å­¦ä¹ ç®—æ³•</p>
<p>è¾“å‡ºï¼šæœ€ç»ˆçš„åˆ†ç±»å™¨ $G(x)$</p>
<ol>
<li><p>åˆå§‹åŒ–è®­ç»ƒæ•°æ®æƒå€¼åˆ†å¸ƒ<br>$$<br>D_1 = (w_{11}, \cdots, w_{1i}, \cdots, w_{1N}),\quad w_{1i} = \frac{1}{N}, \quad i = 1,2,â€¦,N<br>$$</p>
</li>
<li><p>å¯¹ $m = 1,2,â€¦, M$</p>
<p>a. ä½¿ç”¨å…·æœ‰æƒå€¼åˆ†å¸ƒçš„ $D_m$ çš„è®­ç»ƒæ•°æ®é›†å­¦ä¹ å¾—åˆ°åŸºæœ¬åˆ†ç±»å™¨(å­¦ä¹ çš„ä¾æ®å°±æ˜¯åˆ†ç±»è¯¯å·®ç‡æœ€å°ï¼Œåˆ†ç±»é”™è¯¯çš„æƒé‡å’Œ)<br>$$<br>G_m(x) : \mathcal{X} \rightarrow \lbrace c_1,c_2,\cdots, c_k \rbrace<br>$$<br>b.è®¡ç®— $G_m(x)$ åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šçš„åˆ†ç±»è¯¯å·®ç‡<br>$$<br>e_{m}=\sum_{i=1}^{N} P\left(G_{m}\left(x_{i}\right) \neq y_{i}\right)=\sum_{i=1}^{N} w_{mi} I\left(G_{m}\left(x_{i}\right) \neq y_{i}\right)<br>$$<br>c. è®¡ç®— $G_m(x)$ çš„ç³»æ•°<br>$$<br>\alpha_m = \frac{1}{2} \log(\frac{1-e_m}{e_m})<br>$$<br>è¿™é‡Œçš„å¯¹æ•°æ˜¯è‡ªç„¶å¯¹æ•°</p>
<p>d. æ›´æ–°è®­ç»ƒæ•°æ®é›†çš„æƒå€¼åˆ†å¸ƒ<br>$$<br>D_{m+1} = (w_{m+1,1}, â€¦, w_{m+1, i}, â€¦, w_{m+1, N}) \\<br>w_{m+1, i} = \frac{w_{mi}}{Z_m} \exp(-\alpha_m I\left(G_{m}\left(x_{i}\right) = y_{i}\right)), \quad i =1,2,â€¦,N<br>$$<br>è¿™é‡Œï¼Œ $Z_m$è§„èŒƒå› å­<br>$$<br>Z_m = \sum_{i = 1}^{N}w_{mi}\exp(-\alpha_m I\left(G_{m}\left(x_{i}\right) = y_{i}\right))<br>$$<br>$I\left(G_{m}\left(x_{i}\right) = y_{i}\right)$ï¼Œå½“åˆ†ç±»æ­£ç¡®çš„æ—¶å€™å–1ï¼Œåˆ†ç±»é”™è¯¯å–0ã€‚äºŒåˆ†ç±»æ—¶å¯ä»¥ $y_iG_m(x_i)$ ä»£æ›¿</p>
<p><strong>å®ƒä½¿ $D_{m+1}$ ç§°ä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒ</strong></p>
</li>
<li><p>æ„å»ºåŸºæœ¬åˆ†ç±»å™¨çš„çº¿æ€§ç»„åˆ<br>$$<br>f(x) = \sum_{m=1}^{M}\alpha_mG_m(x)<br>$$<br>æœ€ç»ˆå¾—åˆ°åˆ†ç±»å™¨<br>$$<br>G(x) = \text{sign}(f(x))<br>$$</p>
</li>
</ol>
<blockquote>
<p>æ³¨ï¼š $e_m$ å¤§çš„ï¼Œ$\alpha_m$ å°ï¼Œè¿™ä¸ªæ—¶å€™è§‚å¯Ÿæƒå€¼çš„æ›´æ–°å…¬å¼ï¼Œå¯¹äºåˆ†å­æ¥è¯´ï¼Œæ­£ç¡®ç‡é«˜çš„ï¼Œåˆ†å­å°ï¼Œæ­£ç¡®ç‡ä½çš„ï¼Œåˆ†å­å¤§ï¼Œ è¿™æ ·å°±è¾¾åˆ°äº†æé«˜è¢«å‰ä¸€è½®å¼±åˆ†ç±»å™¨é”™è¯¯åˆ†ç±»çš„æ ·æœ¬çš„æƒå€¼ï¼Œé™ä½åˆ†ç±»æ­£ç¡®çš„æ ·æœ¬çš„æƒå€¼çš„ç›®çš„</p>
</blockquote>
<h3 id="Qï¼šAdaboostç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ"><a href="#Qï¼šAdaboostç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ" class="headerlink" title="Qï¼šAdaboostç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ"></a>Qï¼šAdaboostç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ</h3><p>æœ‰äº›ä»£ç å°†ç»ˆæ­¢æ¡ä»¶è®¾ç½®ä¸ºä¸€ä¸ªè¶…å‚æ•°ï¼Œå³å¼±åˆ†ç±»å™¨çš„ä¸ªæ•°ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ</p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/41047671/answer/127832345">çŸ¥ä¹: ä¿æ‰¬çš„å›ç­”</a></p>
<p>Adabooståœ¨å®éªŒä¸­è¡¨ç°å‡ºæ›´åŠ ä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼ˆç›¸å¯¹äºåˆ«çš„boostingæ–¹æ³•ï¼‰çš„ç°è±¡ï¼Œå°¤å…¶æ˜¯åœ¨å®éªŒä¸­å‘ç°ï¼Œè¿­ä»£ä¸­ç»éªŒè¯¯å·®éƒ½å·²ç»ä¸å˜åŒ–äº†çš„æƒ…å†µä¸‹ï¼Œæµ‹è¯•è¯¯å·®å±…ç„¶è¿˜èƒ½ä¸‹é™ä¸€æ®µæ—¶é—´ã€‚</p>
<p>å¯¹äºäºŒåˆ†ç±»é—®é¢˜ï¼ŒAdaBoostçš„è®­ç»ƒè¯¯å·®ä»¥æŒ‡æ•°é€Ÿç‡ä¸‹é™å°±å¾ˆå…·æœ‰å¸å¼•åŠ›</p>
<h2 id="1-2-AdaBoostç®—æ³•è§£é‡Š"><a href="#1-2-AdaBoostç®—æ³•è§£é‡Š" class="headerlink" title="1.2 AdaBoostç®—æ³•è§£é‡Š"></a>1.2 AdaBoostç®—æ³•è§£é‡Š</h2><p><strong>AdaBoost = åŠ æ³•æ¨¡å‹ + æŸå¤±å‡½æ•°(æŒ‡æ•°å‡½æ•°) + å­¦ä¹ ç®—æ³•(å‰å‘åˆ†æ­¥ç®—æ³•)</strong></p>
<ul>
<li>åŠ æ³•æ¨¡å‹</li>
</ul>
<p>$$<br>f(x) = \sum_{m=1}^{M} \beta_m b(x;\gamma_m)<br>$$</p>
<ul>
<li>æŸå¤±å‡½æ•°</li>
</ul>
<p><br>$$<br>L(y,f(x)) = \exp(-yf(x))\\<br>(\alpha_m, G_m(x)) = \arg \min_{\alpha,G}\sum_{i = 1}^{N}\exp[-y_i(f_{m-1}(x_i) +\alpha G(x_i))]<br>$$</p>
<h2 id="1-3-Adaboostä»£ç å®ç°"><a href="#1-3-Adaboostä»£ç å®ç°" class="headerlink" title="1.3 Adaboostä»£ç å®ç°"></a>1.3 Adaboostä»£ç å®ç°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å†³çš„é—®é¢˜ï¼šäºŒåˆ†ç±»ï¼ŒY_label = &#123;-1, 1&#125; è¿™é‡Œç®€åŒ–ç‰¹å¾X Xi = &#123;0,1&#125; (äºŒå€¼åŒ–å¤„ç†)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç®—æ³•å®ç°æ€è·¯</span></span><br><span class="line"><span class="comment">## è®¡ç®—åˆ†ç±»é”™è¯¯ç‡ï¼Œè¾“å…¥åº”è¯¥æ˜¯ï¼šæ•°æ®é›†å’Œè®­ç»ƒå¥½çš„æ¨¡å¼±åˆ†ç±»å™¨å‚æ•°ï¼Œè¿”å›é¢„æµ‹ç»“æœå’Œåˆ†ç±»è¯¯å·®ç‡</span></span><br><span class="line"><span class="comment">## å•å±‚æå‡æ ‘ï¼š è¾“å…¥ï¼šæ•°æ®ï¼Œæƒå€¼åˆ†å¸ƒ è¾“å‡ºï¼šåˆ›å»ºçš„å•å±‚æå‡æ ‘</span></span><br><span class="line"><span class="comment">## ç”Ÿæˆæå‡æ ‘ï¼šè¾“å…¥ï¼šæ•°æ®ï¼Œ è¾“å‡ºï¼šæå‡æ ‘</span></span><br><span class="line"><span class="comment">## é¢„æµ‹ç»“æœ</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_e_Gx</span>(<span class="params">X_trainArr, Y_trainArr, n, div, D</span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    è®¡ç®—åˆ†ç±»è¯¯å·®ç‡</span></span><br><span class="line"><span class="string">    nï¼Œè¦æ“ä½œçš„ç‰¹å¾</span></span><br><span class="line"><span class="string">    divï¼Œåˆ’åˆ†çš„ç‚¹</span></span><br><span class="line"><span class="string">    D, æƒå€¼åˆ†å¸ƒ</span></span><br><span class="line"><span class="string">    return é¢„æµ‹ç»“æœ, åˆ†ç±»è¯¯å·®ç‡</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–è¯¯å·®ç‡</span></span><br><span class="line">    e = <span class="number">0</span> </span><br><span class="line">    <span class="comment"># å•ç‹¬æå–X, Y</span></span><br><span class="line">    X_n = X_trainArr[:, n]</span><br><span class="line">    Y_n = Y_trainArr</span><br><span class="line">    predict = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X_n)):</span><br><span class="line">        <span class="keyword">if</span> X_n[i] &lt; div:</span><br><span class="line">            predict[i] = -<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> predict[i] != Y_train[i]: e += D[i]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            predict[i] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> predict[i] != Y_train[i]: e += D[i]</span><br><span class="line">                </span><br><span class="line">    <span class="keyword">return</span> np.array(predict), e</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creatSingleTree</span>(<span class="params">X_trainArr, Y_trainArr, D</span>):</span></span><br><span class="line">    <span class="comment"># è¯¥å‡½æ•°å¯ä»¥ç”¨å…¶ä»–å¼±åˆ†ç±»å™¨ä»£æ›¿</span></span><br><span class="line">    <span class="comment"># è·å¾—æ ·æœ¬æ•°ç›®åŠç‰¹å¾æ•°é‡</span></span><br><span class="line">    m, n = np.shape(X_trainArr)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å•å±‚æ ‘å­—å…¸ï¼Œç”¨äºå­˜æ”¾å½“å‰æå‡æ ‘çš„å‚æ•°ï¼ŒåŒ…æ‹¬ï¼šåˆ†å‰²ç‚¹ï¼Œé¢„æµ‹ç»“æœï¼Œè¯¯å·®ç‡(ç”±é¢„æµ‹ç»“æœè®¡ç®—)ï¼Œ</span></span><br><span class="line">    <span class="comment"># è¯¥å•å±‚æ ‘æ‰€å¤„ç†çš„ç‰¹å¾ </span></span><br><span class="line">    singleBoostTree = &#123;&#125; </span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–è¯¯å·®ç‡ï¼Œæœ€å¤§ä¸º100%</span></span><br><span class="line">    singleBoostTree[<span class="string">&#x27;e&#x27;</span>] = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># éå†æ¯ä¸€ä¸ªç‰¹å¾ï¼Œå¯»æ‰¾ç”¨äºåˆ’åˆ†çš„æœ€åˆé€‚çš„ç‰¹å¾</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="comment"># ç”±äºç‰¹å¾è¿›è¡Œäº†äºŒå€¼åŒ–å¤„ç†ï¼Œåªèƒ½ä¸º0ã€1ï¼Œå› æ­¤åˆ‡åˆ†ç‚¹ä¸º -0.5ï¼Œ 0.5ï¼Œ1.5</span></span><br><span class="line">        <span class="keyword">for</span> div <span class="keyword">in</span> [-<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">1.5</span>]:</span><br><span class="line">            Gx, e = calc_e_Gx(X_trainArr, Y_trainArr, i, div, D)</span><br><span class="line">            <span class="keyword">if</span> e &lt; singleBoostTree[<span class="string">&#x27;e&#x27;</span>]:</span><br><span class="line">                singleBoostTree[<span class="string">&#x27;e&#x27;</span>] = e</span><br><span class="line">                singleBoostTree[<span class="string">&#x27;div&#x27;</span>] = div</span><br><span class="line">                singleBoostTree[<span class="string">&#x27;Gx&#x27;</span>] = Gx</span><br><span class="line">                singleBoostTree[<span class="string">&#x27;feature&#x27;</span>] = i</span><br><span class="line">    <span class="keyword">return</span> singleBoostTree</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">creatBoostingTree</span>(<span class="params">X_trainArr, Y_trainArr, treeNum = <span class="number">50</span></span>):</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    treeNum: å¼±åˆ†ç±»å™¨çš„æ•°ç›®ä½œä¸ºä¸€ä¸ªè¶…å‚æ•°ï¼Œå¯ä»¥é€šè¿‡äº¤å‰éªŒè¯æŒ‘é€‰ä¸€ä¸ªæœ€å¥½çš„</span></span><br><span class="line"><span class="string">    return: æå‡æ ‘</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    m, n = np.shape(X_trainArr)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–æƒå€¼åˆ†å¸ƒ</span></span><br><span class="line">    D = np.array([<span class="number">1</span> / m] * m)</span><br><span class="line">    <span class="comment"># åˆå§‹åŒ–æ ‘åˆ—è¡¨</span></span><br><span class="line">    iterationNum = <span class="number">0</span></span><br><span class="line">    tree = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(treeNum):</span><br><span class="line">        <span class="comment"># åˆ›å»ºå½“å±‚çš„æå‡æ ‘</span></span><br><span class="line">        iterationNum += <span class="number">1</span></span><br><span class="line">        curTree = singleBoostTree(X_trainArr, Y_trainArr, D)</span><br><span class="line">        <span class="comment"># è®¡ç®—alpha</span></span><br><span class="line">        alpha = <span class="number">1</span> / <span class="number">2</span> * np.log((<span class="number">1</span> - curTree[<span class="string">&#x27;e&#x27;</span>]) / curTree[<span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">        Gx = curTree[<span class="string">&#x27;Gx&#x27;</span>]</span><br><span class="line">        D = np.multiply(D, np.exp( -alpha * np.multiply(Y_trainArr, Gx))) / \</span><br><span class="line">            <span class="built_in">sum</span>(np.multiply(D, np.exp( -alpha * np.multiply(Y_trainArr, Gx))))</span><br><span class="line">        curTree[<span class="string">&#x27;alpha&#x27;</span>] = alpha</span><br><span class="line">        tree.append(curTree)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å½“å‰è®­ç»ƒé›†é¢„æµ‹ç»“æœ</span></span><br><span class="line">        finalpredict += alpha * Gx</span><br><span class="line">        <span class="comment"># å½“å‰é¢„æµ‹è¯¯å·®æ•°ç›®</span></span><br><span class="line">        error_count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Y_trainArr)):</span><br><span class="line">            <span class="keyword">if</span> np.sign(finalpredict)[i] != Y_trainArr[i]:</span><br><span class="line">                error_count +=  <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        error_rate = error_count / <span class="built_in">len</span>(Y_trainArr)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¦‚æœè¯¯å·®å·²ç»ä¸º0äº†ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœæ­¢äº†ä¸ç”¨å†è®¡ç®—äº†</span></span><br><span class="line">        <span class="keyword">if</span> error_rate == <span class="number">0</span>: <span class="keyword">return</span> tree</span><br><span class="line">    print(<span class="string">&#x27;Numbers of iteration: &#123;&#125;, \n error rate: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(iterationNum, error_rate))</span><br><span class="line">    <span class="keyword">return</span> tree</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Gx_predict</span>(<span class="params">x, div, feature</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x[feature] &lt; div:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model_predict</span>(<span class="params">X_testArr, tree</span>):</span></span><br><span class="line">    prediction = []</span><br><span class="line">    <span class="comment"># æ¯ä¸€å±‚çš„tree æœ‰divï¼Œalphaï¼Œfeature</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X_testArr)):</span><br><span class="line">        result = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> curTree <span class="keyword">in</span> tree:</span><br><span class="line">            div = curTree[<span class="string">&#x27;div&#x27;</span>]</span><br><span class="line">            alpha = curTree[<span class="string">&#x27;alpha&#x27;</span>]</span><br><span class="line">            feature = curTree[<span class="string">&#x27;feature&#x27;</span>]</span><br><span class="line">            result += alpha * Gx_predict(X_testArr[i], div, feature)</span><br><span class="line">        prediction.append(result)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> prediction</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model_score</span>(<span class="params">X_testArr, Y_testArr, tree</span>):</span></span><br><span class="line">    prediction = model_predict(X_testArr, tree)</span><br><span class="line">    error_count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Y_testArr)):</span><br><span class="line">        <span class="keyword">if</span> prediction[i] != Y_testArr[i]:</span><br><span class="line">            error_count += <span class="number">1</span></span><br><span class="line">    score = <span class="number">1</span> - (error_count / <span class="built_in">len</span>(Y_testArr))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> score</span><br></pre></td></tr></table></figure>
<h2 id="1-3-boosting-tree"><a href="#1-3-boosting-tree" class="headerlink" title="1.3 boosting tree"></a>1.3 boosting tree</h2><p>ä»¥<strong>å†³ç­–æ ‘</strong>ä¸ºåŸºå‡½æ•°çš„æå‡æ–¹æ³•ç§°ä¸º<strong>æå‡æ ‘</strong>ã€‚å¯ä»¥æ˜¯äºŒå‰åˆ†ç±»æ ‘ï¼Œæˆ–äºŒå‰å›å½’æ ‘ã€‚</p>
<ul>
<li><strong>æ¨¡å‹</strong></li>
</ul>
<p>$$<br>f_M(x) = \sum_{m = 1}^M T(x;\Theta_m)<br>$$</p>
<p>å…¶ä¸­ï¼Œ $T(x;\Theta_m)$ è¡¨ç¤ºå†³ç­–æ ‘ï¼Œ $\Theta_m$ ä¸ºå†³ç­–æ ‘çš„å‚æ•°ï¼Œ $M$ ä¸ºæ ‘çš„ä¸ªæ•°</p>
<ul>
<li><strong>å‚æ•°ç¡®å®š</strong>(ç»éªŒé£é™©æå°åŒ–)</li>
</ul>
<p>$$<br>\hat{\Theta_m}=\arg \min_{\Theta_m} \sum_{i=1}^{N} L\left(y_{i}, f_{m-1}\left(x_{i}\right)+T\left(x_{i}; \Theta_{m}\right)\right)<br>$$</p>
<ul>
<li><strong>æŸå¤±å‡½æ•°</strong><ul>
<li>å¹³æ–¹è¯¯å·®æŸå¤±å‡½æ•°çš„å›å½’é—®é¢˜</li>
<li>æŒ‡æ•°æŸå¤±å‡½æ•°çš„åˆ†ç±»é—®é¢˜</li>
<li>ä¸€èˆ¬æŸå¤±å‡½æ•°çš„å†³ç­–é—®é¢˜</li>
</ul>
</li>
</ul>
<p>å½“åˆ†ç±»é—®é¢˜æ˜¯äºŒåˆ†ç±»ï¼ŒAdaBoostç®—æ³•çš„å¼±åˆ†ç±»å™¨é™åˆ¶ä¸ºäºŒåˆ†ç±»å³å¯ï¼Œå°±æ˜¯boosting tree</p>
<ul>
<li><p>å›å½’é—®é¢˜çš„æå‡æ ‘<br>$$<br>T(x;\Theta)=\sum_{j=1}^{J}c_j I(x \in R_j)<br>$$<br>å…¶ä¸­ï¼Œå‚æ•° $\Theta = \lbrace (R_1, c_1), (R_2, c_2),â€¦,(R_J, c_J) \rbrace$ è¡¨ç¤ºæ ‘çš„åŒºåŸŸåˆ’åˆ†å’Œå„åŒºåŸŸä¸Šçš„å¸¸æ•°ï¼Œ $J$ æ˜¯å›å½’æ ‘çš„å¤æ‚åº¦å³å¶ç»“ç‚¹çš„ä¸ªæ•°ã€‚</p>
<ul>
<li>é‡‡ç”¨<strong>å¹³æ–¹è¯¯å·®æŸå¤±å‡½æ•°</strong><br>$$<br>\begin{align*}<br>L(y,f_{m-1}(x) + T(x; \Theta_m)) &amp;= [y - f_{m-1}(x) - T(x;\Theta_m)]^2\\<br>&amp;=[r-T(x;\Theta_m)]^2<br>\end{align*}<br>$$<br>æ‰€ä»¥ä»æŸå¤±å‡½æ•°å¯ä»¥çœ‹å‡ºï¼Œå½“å‰å±‚æ ‘çš„ç¡®å®šï¼Œæ˜¯é€šè¿‡æ‹Ÿåˆä¸Šä¸€å±‚æ¨¡å‹çš„æ®‹å·®ã€‚æ‰€ä»¥ç®—æ³•å¯ä»¥é€šè¿‡å°†è¯¥å±‚çš„è®­ç»ƒæ•°æ®ç»™æ”¹ä¸ºæ®‹å·®å³å¯é€’å½’å¾—åˆ°æ¯ä¸€å±‚çš„tree</li>
</ul>
</li>
<li><p><strong>å‚æ•°æ›´æ–°(æ¢¯åº¦ä¸‹é™)</strong></p>
</li>
</ul>
<p>$$<br>-[\frac{\partial L(y, f(x_i))}{\partial f(x_i)}]<em>{f(x)=f</em>{m-1}(x)}<br>$$</p>
<h1 id="2-Bagging-Beriman-1996a"><a href="#2-Bagging-Beriman-1996a" class="headerlink" title="2. Bagging[Beriman, 1996a]"></a>2. Bagging[Beriman, 1996a]</h1><p>é‡‡ç”¨è‡ªä¸»æŠ½æ ·æ³•(<strong>bootstrap sampling</strong>)</p>
<ul>
<li>ç¡®å®šæ ·æœ¬é›†ä¸ªæ•° $m$ </li>
<li>åˆæ”¾å›çš„æŠ½å– $m$ ä¸ªæ ·æœ¬</li>
<li>é‡‡æ ·å‡º $T$ ä¸ªå« $m$ æ ·æœ¬çš„é‡‡æ ·é›†</li>
<li>ç„¶ååŸºäºæ¯ä¸ªæ ·æœ¬é›†è®­ç»ƒä¸€ä¸ªåŸºå­¦ä¹ å™¨</li>
<li>é¢„æµ‹å¯ä»¥ä½¿ç”¨ç®€å•æŠ•ç¥¨æ³•</li>
</ul>
<p>å¯ä»¥è®°å½•ä¸€ä¸‹ä½¿ç”¨çš„æ•°æ®ï¼Œæœªè¢«ä½¿ç”¨çš„æ•°æ®å¯ä»¥ç”¨æ¥å¯¹æ³›åŒ–æ€§èƒ½è¿›è¡Œâ€œåŒ…å¤–ä¼°è®¡â€</p>
<p>ä»£ç éš¾åº¦ä¸å¤§</p>
<p>ä½¿ç”¨random.sample()æˆ–è€…np.random.choice()å°±å¯ä»¥å®ç°é‡æŠ½æ ·</p>
<p>random.sample()é»˜è®¤ä¸é‡å¤æŠ½æ ·ï¼Œå¯ä»¥æŠ½å–å¤šç»´æ•°æ®</p>
<p>np.random.choice() é»˜è®¤é‡å¤æŠ½æ · replace=True, ä¸å¯ä»¥æŠ½å–å¤šç»´æ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°äº§ç”Ÿä¸‹æ ‡ã€‚</p>
<h1 id="3-Random-Forest-RF"><a href="#3-Random-Forest-RF" class="headerlink" title="3. Random Forest(RF)"></a>3. Random Forest(RF)</h1><p>Bagging çš„å˜ä½“ï¼ŒRFåœ¨åŸºå­¦ä¹ å™¨æ„å»ºBaggingé›†æˆçš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥åœ¨å†³ç­–æ ‘çš„è®­ç»ƒè¿‡ç¨‹ä¸­å¼•å…¥äº†éšæœºå±æ€§é€‰æ‹©ã€‚å…·ä½“æ¥è¯´ï¼Œ ä¼ ç»Ÿå†³ç­–æ ‘åœ¨é€‰æ‹©åˆ’åˆ†å±æ€§æ—¶æ˜¯åœ¨å½“å‰ç»“ç‚¹çš„å±æ€§é›†åˆ(å‡å®šæœ‰dä¸ªå±æ€§)ä¸­é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜å±æ€§ï¼› è€Œåœ¨RFä¸­ï¼Œ å¯¹åŸºå†³ç­–æ ‘çš„æ¯ä¸ªç»“ç‚¹ï¼Œ å…ˆä»è¯¥ç»“ç‚¹çš„å±æ€§é›†åˆä¸­éšæœºé€‰æ‹©ä¸€ä¸ªåŒ…å«kä¸ªå±æ€§çš„å­é›†ï¼Œ ç„¶åå†ä»è¿™ä¸ªå­é›†ä¸­é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜å±æ€§ç”¨äºåˆ’åˆ†ã€‚è‹¥ä»¤$k=d$,åˆ™åŸºå†³ç­–æ ‘çš„æ„å»ºä¸ä¼ ç»Ÿå†³ç­–æ ‘ç›¸åŒï¼›è‹¥ä»¤$k = 1$,åˆ™æ˜¯éšæœºé€‰æ‹©ä¸€ä¸ªå±æ€§ç”¨äºåˆ’åˆ†ï¼› ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ æ¨èå€¼$k = log_2d$</p>
<p><strong>ç®—æ³•ï¼š</strong></p>
<p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ® $T$ ï¼ŒåŸºå†³ç­–æ ‘(CART)ï¼Œé‡æŠ½æ ·å‚æ•° $m$ï¼Œå±æ€§é›†åˆå‚æ•° $k$</p>
<p>è¾“å‡ºï¼šæœ€ç»ˆåˆ†ç±»å™¨</p>
<p>for 1,2,â€¦T</p>
<p>â€‹        é‡æŠ½æ ·æ•°æ®(mä¸ª)ï¼Œè®°å½•æœªè¢«æŠ½å–çš„æ•°æ®</p>
<p>â€‹        éšæœºæŠ½å–kä¸ªå±æ€§</p>
<p>â€‹        æ ¹æ®é‡æŠ½æ ·çš„æ•°æ®å’Œç¡®å®šçš„å±æ€§ï¼Œå­¦ä¹ åŸºåˆ†ç±»å™¨ (å¦‚ï¼šCART)</p>
<p>end for</p>
<p>è¾“å‡ºï¼šæœ€ç»ˆåˆ†ç±»å™¨</p>
<h1 id="4-Stacking"><a href="#4-Stacking" class="headerlink" title="4. Stacking"></a>4. Stacking</h1><ul>
<li><strong>ä»‹ç»</strong></li>
</ul>
<p><strong>å‡è®¾æ˜¯äº”æŠ˜çš„stackingï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªtrainæ•°æ®é›†å’Œä¸€ä¸ªtestæ•°æ®é›†ï¼Œé‚£ä¹ˆä¸€ä¸ªåŸºæœ¬çš„stackingæ¡†æ¶ä¼šè¿›è¡Œå¦‚ä¸‹å‡ ä¸ªæ“ä½œï¼š</strong></p>
<p>1ã€é€‰æ‹©åŸºæ¨¡å‹ã€‚æˆ‘ä»¬å¯ä»¥æœ‰xgboostï¼ŒlightGBMï¼ŒRandomForestï¼ŒSVMï¼ŒANNï¼ŒKNNï¼ŒLRç­‰ç­‰ä½ èƒ½æƒ³åˆ°çš„å„ç§åŸºæœ¬ç®—æ³•æ¨¡å‹ã€‚</p>
<p>2ã€æŠŠè®­ç»ƒé›†åˆ†ä¸ºä¸äº¤å‰çš„äº”ä»½ã€‚æˆ‘ä»¬æ ‡è®°ä¸ºtrain1åˆ°train5ã€‚</p>
<p>3ã€ä»train1å¼€å§‹ä½œä¸ºé¢„æµ‹é›†ï¼Œä½¿ç”¨train2åˆ°train5å»ºæ¨¡(model1)ï¼Œç„¶åé¢„æµ‹train1ï¼Œå¹¶ä¿ç•™ç»“æœï¼›ç„¶åï¼Œä»¥train2ä½œä¸ºé¢„æµ‹é›†ï¼Œä½¿ç”¨train1ï¼Œtrain3åˆ°train5å»ºæ¨¡ï¼Œé¢„æµ‹train2ï¼Œå¹¶ä¿ç•™ç»“æœ(model2)ï¼›å¦‚æ­¤è¿›è¡Œä¸‹å»â€¦â€¦.ç›´åˆ°æŠŠtrain1åˆ°train5å„é¢„æµ‹ä¸€éï¼›</p>
<p>4ã€æŠŠé¢„æµ‹çš„ç»“æœæŒ‰ç…§train1åˆ°trian5çš„ä½ç½®å¯¹åº”å¡«è¡¥ä¸Šï¼Œå¾—åˆ°å¯¹trainæ•´ä¸ªæ•°æ®é›†åœ¨ç¬¬ä¸€ä¸ªåŸºæ¨¡å‹çš„ä¸€ä¸ªstackingè½¬æ¢ã€‚</p>
<p>5ã€åœ¨ä¸Šè¿°å»ºç«‹çš„äº”ä¸ªæ¨¡å‹è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªæ¨¡å‹åˆ†åˆ«å¯¹testæ•°æ®é›†è¿›è¡Œé¢„æµ‹ï¼Œå¹¶æœ€ç»ˆä¿ç•™è¿™äº”åˆ—ç»“æœï¼Œç„¶åå¯¹è¿™äº”åˆ—å–å¹³å‡ï¼Œä½œä¸ºç¬¬ä¸€ä¸ªåŸºæ¨¡å‹å¯¹testæ•°æ®çš„ä¸€ä¸ªstackingè½¬æ¢ã€‚</p>
<p>6ã€ç„¶åè¿›å…¥ç¬¬äºŒå±‚ï¼Œå°†æ–°ç‰¹å¾ä½œä¸ºç¬¬äºŒå±‚çš„train dataï¼Œç¬¬ä¸€å±‚çš„é¢„æµ‹ç»“æœä½œä¸ºtest data</p>
<p><strong>7ã€ä¸€èˆ¬ä½¿ç”¨LR(é€»è¾‘å›å½’)ä½œä¸ºç¬¬äºŒå±‚çš„æ¨¡å‹è¿›è¡Œå»ºæ¨¡é¢„æµ‹ã€‚</strong></p>
<p>ä½†ä½¿ç”¨stackingä¼šæ¯”è¾ƒè€—æ—¶ï¼Œæ‰€ä»¥çœŸæ­£æ¯”èµ›çš„æ—¶å€™å¯ä»¥æ”¹ä¸º3æŠ˜æˆ–4æŠ˜</p>
<ul>
<li><strong>Stackingçš„è¾“å‡ºå±‚ä¸ºä»€ä¹ˆç”¨é€»è¾‘å›å½’ï¼Ÿ</strong></li>
</ul>
<p>stackingçš„æœ‰æ•ˆæ€§ä¸»è¦æ¥è‡ªäºç‰¹å¾æŠ½å–ã€‚<strong>è€Œè¡¨ç¤ºå­¦ä¹ ä¸­ï¼Œå¦‚å½±éšå½¢çš„é—®é¢˜å°±æ˜¯è¿‡æ‹Ÿåˆï¼Œè¯•å›æƒ³æ·±åº¦å­¦ä¹ ä¸­çš„è¿‡æ‹Ÿåˆé—®é¢˜ã€‚</strong></p>
<p>åœ¨[5]ä¸­ï¼Œå‘¨å¿—åæ•™æˆä¹Ÿé‡ç”³äº†stackingåœ¨ä½¿ç”¨ä¸­çš„è¿‡æ‹Ÿåˆé—®é¢˜ã€‚å› ä¸ºç¬¬äºŒå±‚çš„ç‰¹å¾æ¥è‡ªäºå¯¹äºç¬¬ä¸€å±‚æ•°æ®çš„å­¦ä¹ ï¼Œé‚£ä¹ˆç¬¬äºŒå±‚æ•°æ®ä¸­çš„ç‰¹å¾ä¸­ä¸è¯¥åŒ…æ‹¬åŸå§‹ç‰¹å¾ï¼Œ<strong>ä»¥é™ä½è¿‡æ‹Ÿåˆçš„é£é™©</strong>ã€‚ä¸¾ä¾‹ï¼š</p>
<ul>
<li>ç¬¬äºŒå±‚æ•°æ®ç‰¹å¾ï¼šä»…åŒ…å«å­¦ä¹ åˆ°çš„ç‰¹å¾</li>
<li>ç¬¬äºŒå±‚æ•°æ®ç‰¹å¾ï¼šåŒ…å«å­¦ä¹ åˆ°çš„ç‰¹å¾ + åŸå§‹ç‰¹å¾</li>
</ul>
<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œstackingä¸­ä¸€èˆ¬éƒ½ç”¨äº¤å‰éªŒè¯æ¥é¿å…è¿‡æ‹Ÿåˆï¼Œè¶³å¯è§è¿™ä¸ªé—®é¢˜çš„ä¸¥é‡æ€§ã€‚</p>
<p>ä¸ºäº†é™ä½è¿‡æ‹Ÿåˆçš„é—®é¢˜ï¼Œç¬¬äºŒå±‚åˆ†ç±»å™¨åº”è¯¥æ˜¯è¾ƒä¸ºç®€å•çš„åˆ†ç±»å™¨ï¼Œå¹¿ä¹‰çº¿æ€§å¦‚é€»è¾‘å›å½’æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚<strong>åœ¨ç‰¹å¾æå–çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨äº†å¤æ‚çš„éçº¿æ€§å˜æ¢ï¼Œå› æ­¤åœ¨è¾“å‡ºå±‚ä¸éœ€è¦å¤æ‚çš„åˆ†ç±»å™¨</strong>ã€‚è¿™ä¸€ç‚¹å¯ä»¥å¯¹æ¯”ç¥ç»ç½‘ç»œçš„æ¿€æ´»å‡½æ•°æˆ–è€…è¾“å‡ºå±‚ï¼Œéƒ½æ˜¯å¾ˆç®€å•çš„å‡½æ•°ï¼Œä¸€ç‚¹åŸå› å°±æ˜¯ä¸éœ€è¦å¤æ‚å‡½æ•°å¹¶èƒ½æ§åˆ¶å¤æ‚åº¦ã€‚</p>
<p>å› æ­¤ï¼Œstackingçš„è¾“å‡ºå±‚ä¸éœ€è¦è¿‡åˆ†å¤æ‚çš„å‡½æ•°ï¼Œç”¨é€»è¾‘å›å½’è¿˜æœ‰é¢å¤–çš„å¥½å¤„ï¼š</p>
<ul>
<li>é…åˆL1æ­£åˆ™åŒ–è¿˜å¯ä»¥è¿›ä¸€æ­¥é˜²æ­¢è¿‡æ‹Ÿåˆ</li>
<li>é…åˆL1æ­£åˆ™åŒ–è¿˜å¯ä»¥é€‰æ‹©æœ‰æ•ˆç‰¹å¾ï¼Œä»ç¬¬ä¸€å±‚çš„å­¦ä¹ å™¨ä¸­åˆ é™¤ä¸å¿…è¦çš„åˆ†ç±»å™¨ï¼ŒèŠ‚çœè¿ç®—å¼€é”€ã€‚</li>
<li>é€»è¾‘å›å½’çš„è¾“å‡ºç»“æœè¿˜å¯è¢«ç†è§£ä¸ºæ¦‚ç‡</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>[1]. <a target="_blank" rel="noopener" href="https://github.com/Dod-o/Statistical-Learning-Method_Code/blob/master/AdaBoost/AdaBoost.py">https://github.com/Dod-o/</a></p>
<p>[2]. ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ â€“ æèˆª</p>
<p>[3]. ã€Šæœºå™¨å­¦ä¹ ã€‹ â€“ å‘¨å¿—å</p>
<p>[4]. <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1005304">ã€SPAå¤§èµ›ã€‘è…¾è®¯å¹¿å‘Šç‚¹å‡»å¤§èµ›ï¼šå¯¹stackingçš„ä¸€äº›åŸºæœ¬ä»‹ç»</a></p>
<p>[5]. Zhou, Z.H., 2012. <em>Ensemble methods: foundations and algorithms</em>. CRC press.</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E3%80%8A%E7%BB%9F%E8%AE%A1%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95%E3%80%8B/" rel="tag"># ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹</a>
              <a href="/tags/%E3%80%8A%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E3%80%8B/" rel="tag"># ã€Šæœºå™¨å­¦ä¹ ã€‹</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/03/18/DecisionTree/" rel="prev" title="DecisionTree">
      <i class="fa fa-chevron-left"></i> DecisionTree
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/04/09/%E5%9F%BA%E4%BA%8Etensorflow%E7%9A%84%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA%E7%9A%84%E5%AE%9E%E7%8E%B0/" rel="next" title="åŸºäºtensorflowçš„å¤šå±‚æ„ŸçŸ¥æœºçš„ä»£ç å®ç°">
      åŸºäºtensorflowçš„å¤šå±‚æ„ŸçŸ¥æœºçš„ä»£ç å®ç° <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-boosting"><span class="nav-number">1.</span> <span class="nav-text">1. boosting</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-AdaBoost"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 AdaBoost</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Q%EF%BC%9AAdaboost%E7%BB%88%E6%AD%A2%E6%9D%A1%E4%BB%B6%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E5%AE%B9%E6%98%93%E8%BF%87%E6%8B%9F%E5%90%88%EF%BC%9F"><span class="nav-number">1.1.1.</span> <span class="nav-text">Qï¼šAdaboostç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼Ÿ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-AdaBoost%E7%AE%97%E6%B3%95%E8%A7%A3%E9%87%8A"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 AdaBoostç®—æ³•è§£é‡Š</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-Adaboost%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 Adaboostä»£ç å®ç°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-boosting-tree"><span class="nav-number">1.4.</span> <span class="nav-text">1.3 boosting tree</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-Bagging-Beriman-1996a"><span class="nav-number">2.</span> <span class="nav-text">2. Bagging[Beriman, 1996a]</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-Random-Forest-RF"><span class="nav-number">3.</span> <span class="nav-text">3. Random Forest(RF)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Stacking"><span class="nav-number">4.</span> <span class="nav-text">4. Stacking</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference"><span class="nav-number">5.</span> <span class="nav-text">Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Guangshan Shui</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Guangshan Shui</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

<span id="sitetime"></span>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- è¿”å›dateå¯¹è±¡è·ä¸–ç•Œæ ‡å‡†æ—¶é—´(UTC)1970å¹´1æœˆ1æ—¥åˆå¤œä¹‹é—´çš„æ¯«ç§’æ•°(æ—¶é—´æˆ³)
        year - ä½œä¸ºdateå¯¹è±¡çš„å¹´ä»½ï¼Œä¸º4ä½å¹´ä»½å€¼
        month - 0-11ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æœˆä»½
        day - 1-31ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å¤©æ•°
        hours - 0(åˆå¤œ24ç‚¹)-23ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å°æ—¶æ•°
        minutes - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„åˆ†é’Ÿæ•°
        seconds - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„ç§’æ•°
        microseconds - 0-999ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æ¯«ç§’æ•° */
        var t1 = Date.UTC(2020, 12, 25, 03, 16, 00); //åŒ—äº¬æ—¶é—´2018-2-13 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²è¿è¡Œ " +diffYears+" å¹´ "+diffDays + " å¤© " + diffHours + " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
    }/*å› ä¸ºå»ºç«™æ—¶é—´è¿˜æ²¡æœ‰ä¸€å¹´ï¼Œå°±å°†ä¹‹æ³¨é‡Šæ‰äº†ã€‚éœ€è¦çš„å¯ä»¥å–æ¶ˆ*/
    siteTime();
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
